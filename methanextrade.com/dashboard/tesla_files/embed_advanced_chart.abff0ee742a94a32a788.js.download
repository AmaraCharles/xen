(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[8107,87,27183,13399],{728566:e=>{e.exports={}},229534:(e,t,i)=>{"use strict";async function s(e){return(await Promise.all([i.e(66814),i.e(91797),i.e(42810),i.e(96645),i.e(10417),i.e(61135),i.e(59355),i.e(86021),i.e(44880),i.e(25977),i.e(64625),i.e(46086),i.e(90384),i.e(37757)]).then(i.bind(i,173403))).createDialog(e)}function n(e){s(e).then((e=>e.open()))}i.d(t,{createErrorDialog:()=>s,showErrorDialog:()=>n})},456335:(e,t,i)=>{"use strict";i.d(t,{featureCheck:()=>r});var s=i(778016);function n(e,t,i){return t.value||(0,s.enabled)(e,i)}function r(e,t,i){switch(e){case"SCREENER_INTERVALS":return function(e,t){const i=(0,s.getConfig)("SCREENER_INTERVALS",t);return!(!i||!i.interval)&&i.interval.includes(e.interval)}(t,i);case"SCREENER_AUTO_REFRESH":return n("SCREENER_AUTO_REFRESH",t,i);case"ALERTS_NO_EXPIRATION":return n("ALERTS_NO_EXPIRATION",t,i);default:return(0,s.enabled)(e,i)}}},251954:(e,t,i)=>{"use strict";i.d(t,{emit:()=>u,emitOnce:()=>h,on:()=>l,subscribe:()=>d,unsubscribe:()=>a});var s=i(942634);const n={},r=[],o={};function a(e,t,i){n[e].unsubscribe(i,t)}function l(e,t,i){d(e,t,i)}function d(e,t,i,r){n.hasOwnProperty(e)||(n[e]=new s.Delegate),o[e]?t.call(i):n[e].subscribe(i,t,r)}function u(e,...t){const i=[e].concat(t);r.forEach((e=>{e.apply(null,i)})),n.hasOwnProperty(e)&&n[e].fire.apply(n[e],t)}function h(e){o[e]&&console.warn(`Something went wrong: emitOnce called multiple times with same event (${e})`),o[e]=!0,u.apply(null,arguments)}},588948:(e,t,i)=>{"use strict";i.d(t,{getFreshInitData:()=>l,getInitData:()=>a,updateInitData:()=>o});var s=i(650151);const n=(0,i(338619).getLogger)("Common.InitData"),r=window.initData||{};function o(){window.initData&&window.initData!==r&&(Object.assign(r,window.initData),window.initData=r);const e=document.querySelectorAll('script[type="application/prs.init-data+json"]');for(let t=0;t<e.length;t++){const i=e[t];try{const e=JSON.parse((0,s.ensureNotNull)(i.textContent));Object.assign(r,e)}catch(e){n.logWarn(`Failed to parse initData element. ${e}`)}finally{(0,s.ensureNotNull)(i.parentNode).removeChild(i)}}}function a(){return r}function l(){return o(),r}},971417:(e,t,i)=>{"use strict";function s(e){return e===n(e)}function n(e){const t=e.indexOf("$"),i=e.indexOf("@");return t<0&&i>=0?null:e.substring(Math.max(t+1,0),i>=0?i:e.length)}function r(e){return e.startsWith("PUB;")}function o(e){return e.startsWith("USER;")}function a(e){return e.startsWith("STD;")}function l(e){return e.includes("Candlestick%1Pattern%1")}function d(e){return e.startsWith("EDGR_")}i.d(t,{extractPineId:()=>n,isCandleStickId:()=>l,isCustomPineId:()=>o,isEdgrPineId:()=>d,isPineIdString:()=>s,isPublishedPineId:()=>r,isStandardPineId:()=>a})},870408:(e,t,i)=>{"use strict";i.d(t,{deletePine:()=>x,getPineFacadeUrl:()=>o.getPineFacadeUrl,getPineSourceCode:()=>w,getVersions:()=>P,isAuthToGetPineSourceCode:()=>y,isPubPineInfo:()=>h,isSavedPineInfo:()=>u,isScriptLibrary:()=>p,isScriptStrategy:()=>c,requestBuiltinScripts:()=>S,
requestUserScripts:()=>b,translateScriptAsync2:()=>v});var s=i(345848),n=i(692558),r=i(427233),o=i(881992),a=i(971417),l=(i(791488),i(197677)),d=i(603774);function u(e){return"scriptTitle"in e&&"modified"in e}function h(e){return"userId"in e&&"scriptAccess"in e}function c(e){return"strategy"===e.kind}function p(e){return"library"===e.kind}i(129586);const m=(0,n.getLogger)("Chart.Study.Versioning"),_=new r.RequestCache,g=new r.RequestCache,f=new r.SingleRequestCache;async function v(e,t){(0,s.trackEvent)("Pine","ScriptLib.translateScript");const i={};(0,a.isCustomPineId)(e)||(i.user_name=(0,o.getUserName)());try{const s=await(0,l.pineFacadeFetch)({urlPath:`translate/${e}/${t}`,urlParams:i}),n=(0,o.handleTranslateResult)(s);(0,d.logPineMetaInfoIssues)("Pine.translateScriptAsync2",n.metaInfo);return+t<0&&(_.delete(e),g.delete(e),f.clear(),(0,o.onLegacyScriptProceed)(n.metaInfo)),n}catch(e){throw e}}function y(e,t){const i=_.get(e);if(i)return i;(0,s.trackEvent)("Pine","ScriptLib.isAuthToGetPineSourceCode");const n=(0,l.pineFacadeFetch)({urlPath:`is_auth_to_get/${e}/${t}`});return _.set(e,n),n}function w(e,t,i){return(0,s.trackEvent)("Pine","ScriptLib.getPineSourceCode"),(0,l.pineFacadeFetch)({urlPath:`get/${e}/${t}`,urlParams:{no_4xx:i}})}function b(){if((0,s.trackEvent)("Pine","ScriptLib.requestUserScripts"),!window.is_authenticated)return Promise.resolve([]);const e=f.get();if(e)return e;const t=(0,l.pineFacadeFetch)({urlPath:"list",urlParams:{filter:"saved"}});return f.reset(t),t}async function S(){(0,s.trackEvent)("Pine","ScriptLib.requestBuiltinScripts");try{m.logNormal("Request built-in scripts");const e=await(0,l.pineFacadeFetch)({urlPath:"list",urlParams:{filter:"standard"},withoutCredentials:!0});return m.logNormal("Request built-in scripts finished"),e}catch(e){throw m.logWarn("Request built-in scripts finished with fail"),e}}function x(e){return(0,s.trackEvent)("Pine","ScriptLib.deletePine"),(0,l.pineFacadeFetch)({method:"POST",urlPath:`delete/${e}`,urlParams:{user_name:(0,o.getUserName)()}}).then((t=>(_.delete(e),g.delete(e),f.clear(),(0,o.onDeleteScript)(e),t)))}async function P(e,t){(0,s.trackEvent)("Pine","ScriptLib.getVersions");try{m.logNormal("Request script versions");return await(0,l.pineFacadeFetch)({method:"GET",urlPath:`versions/${e}`,urlParams:{limit:t?String(t):void 0}})}catch(e){return m.logWarn("Request script versions finished with fail"),[]}}(0,o.applyGlobalScriptListeners)(_,g,f)},881992:(e,t,i)=>{"use strict";i.d(t,{applyGlobalScriptListeners:()=>m,getPineFacadeUrl:()=>d,getUserName:()=>l,handleTranslateResult:()=>h,onDeleteScript:()=>c,onLegacyScriptProceed:()=>p});var s=i(251954),n=i(226722),r=i(791488),o=i(401843),a=i(129586);function l(){return window.user&&window.user.username}function d(){const e=new URL(window.PINE_URL,location.origin);return e.pathname.endsWith("/")||(e.pathname+="/"),e.href}function u(e){if("object"==typeof e.reason)return e.reason;if(e.reason2)return e.reason2;const t={errors:[],warnings:[]};if((0,a.hasMetaInfo)(e.result)){const i=e.result&&e.result.metaInfo
;i&&void 0!==i.warnings&&i.warnings.forEach((e=>t.warnings.push({message:e})))}if(e.reason){(Array.isArray(e.reason)?e.reason:e.reason.split("\n")).forEach((e=>{const i=e.match(r.RE_MESSAGE_LINE_WITH_DIGITS),s=i&&i.length&&Number(i[1]),n={message:e};if("number"==typeof s){n.start={line:s,column:0};const e=n.message.split(": ");e.shift(),n.message=e.join(": ")}t.errors.push(n)}))}return t}function h(e){if(e.success)return{success:e.success,metaInfo:e.result.metaInfo,compileErrors:u(e)};throw new o.PineCompileFailErrorImpl(u(e),e.result.metaInfo)}function c(e){const t={scriptIdPart:e};n.TVXWindowEvents.emit(r.TV_SCRIPT_DELETED,JSON.stringify(t)),s.emit(r.TV_SCRIPT_DELETED,t),setTimeout((async()=>{var e;const i=await(null===(e=window.scriptUpdater)||void 0===e?void 0:e.call(window));await(null==i?void 0:i.onTVScriptDeleted({...t,isSelfCall:!0}))}))}function p(e){const t={scriptMetaInfo:e};n.TVXWindowEvents.emit(r.TV_SCRIPT_LEGACY_PINE_PROCESSED,JSON.stringify(t)),s.emit(r.TV_SCRIPT_LEGACY_PINE_PROCESSED,t),setTimeout((async()=>{var e;const i=await(null===(e=window.scriptUpdater)||void 0===e?void 0:e.call(window));null==i||i.onTVScriptLegacyPineProcessed(t)}))}function m(e,t,i){n.TVXWindowEvents.on(r.TV_SCRIPT_MODIFICATION_ACTIVE,(async e=>{var t;const i=await(null===(t=window.scriptUpdater)||void 0===t?void 0:t.call(window));null==i||i.onModifyScriptActiveChanged(JSON.parse(e))})),n.TVXWindowEvents.on(r.TV_SCRIPT_MODIFIED,(async e=>{var t;i.clear();const s=await(null===(t=window.scriptUpdater)||void 0===t?void 0:t.call(window));null==s||s.onTVScriptModified(JSON.parse(e))})),n.TVXWindowEvents.on(r.TV_SCRIPT_DELETED,(async s=>{var n;e.clear(),t.clear(),i.clear();const r=await(null===(n=window.scriptUpdater)||void 0===n?void 0:n.call(window));await(null==r?void 0:r.onTVScriptDeleted(JSON.parse(s)))})),n.TVXWindowEvents.on(r.TV_SCRIPT_RENAMED,(async e=>{var t;i.clear();const s=await(null===(t=window.scriptUpdater)||void 0===t?void 0:t.call(window));null==s||s.onTVScriptRenamed(JSON.parse(e))})),n.TVXWindowEvents.on(r.TV_SCRIPT_LEGACY_PINE_PROCESSED,(async e=>{var t;i.clear();const s=await(null===(t=window.scriptUpdater)||void 0===t?void 0:t.call(window));null==s||s.onTVScriptLegacyPineProcessed(JSON.parse(e))}))}},501867:(e,t,i)=>{"use strict";i.r(t),i.d(t,{pushStreamMultiplexer:()=>b});var s=i(226722),n=i(345848),r=i(49437),o=i(454576),a=i(175203),l=i(338619),d=i(358956),u=(i(659863),i(220732)),h=i(125226),c=i(79342),p=i(314802),m=i(700469),_=i(955273),g=i(995773);const f=(0,l.getLogger)(d.loggerSubsystemId),v={url:window.PUSHSTREAM_URL,urlPath:"message-pipe-ws",transportType:d.TransportType.WebSocket},y={url:window.PUSHSTREAM_URL.replace("wss://","https://"),urlPath:"message-pipe-es",transportType:d.TransportType.EventSource};class w{constructor(){var e;this.guid=(0,c.guid)(),this._pushStreamPublic=null,this._pushStreamPrivate=null,this._statusHandlers=[],this._reconnectHandlers=[],this._userPrivateChannel=null,this._channelMultiplexer=new u.ChannelMultiplexer,this._xEventPrefix="multiplexer-bc-",
this._storagePrefix="pushStreamMultiplexerState.",this._userChannelPrefix="private_",this._statusPublic=o.ConnectionStatus.Closed,this._statusPrivate=o.ConnectionStatus.Closed,this._xEventSend=this._xEventPrefix+"send",this._xEventConnectionStatus=this._xEventPrefix+"connectionStatus",this._xEventReconnectCommand=this._xEventPrefix+"reconnectCommand",this._xEventReconnectSuccess=this._xEventPrefix+"reconnectSuccess",this._xEventRequestLogs=this._xEventPrefix+"requestLogs",this._xEventShareLogs=this._xEventPrefix+"shareLogs",this._state=new m.MultiplexerState,this._shareLogsKey=this._storagePrefix+"shareLogs",this._lockName="pushstream",this._lockPromise=(0,_.createDeferredPromise)(),this._dispatchReconnectSuccessCommandFromOther=e=>{if(this.ownPushStream())return;const[t]=this._decodeParams(e);this._callReconnectHandlers(t)},this._dispatchMessage=(e,t,i)=>{this._dispatchMessageToOthers(e,t,i),this._dispatchMessageToSelf(e,t,i,!1)},this._dispatchMessageFromOther=e=>{if(this.ownPushStream())return;const[t,i,s]=this._decodeParams(e);this._dispatchMessageToSelf(t,i,s,!0)},this._dispatchStatusChangeFromOther=e=>{const t=this._decodeConnectionStatus(e),i=t[0],s=t[1];this.ownPushStream()||this._dispatchStatusChangeToSelf(i,s)},this._dispatchReconnectCommandFromOther=()=>{this.ownPushStream()&&this.forceConnect()},this._onRequestLogs=()=>{if(this.ownPushStream()){const e=this._getOwnLogs();let t="";try{t=JSON.stringify(e)}catch(e){f.logError("Failed to stringify own pushstream logs")}r.TVLocalStorage.setItem(this._shareLogsKey,t),s.TVXWindowEvents.emit(this._xEventShareLogs,t)}},this._onStateChange=(e,t,i)=>{const s="private"===t?this._pushStreamPrivate:this._pushStreamPublic;"add"===e?null==s||s.addChannel(i):null==s||s.removeChannel(i)},this._onNewTabCreate=()=>{this._dispatchStatusChangeToOthers(this._statusPublic,this._statusPrivate)},(0,g.webLockEnabled)()?navigator.locks.request(this._lockName,(async()=>(this._state.onStateChange(this._onStateChange),this._state.onTabCreate(this._onNewTabCreate),this._instantiatePushStream(),window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockPromise.promise))):(this._state.onStateChange(this._onStateChange),this._instantiatePushStream()),s.TVXWindowEvents.on(this._xEventSend,this._dispatchMessageFromOther),s.TVXWindowEvents.on(this._xEventConnectionStatus,this._dispatchStatusChangeFromOther),s.TVXWindowEvents.on(this._xEventReconnectCommand,this._dispatchReconnectCommandFromOther),s.TVXWindowEvents.on(this._xEventReconnectSuccess,this._dispatchReconnectSuccessCommandFromOther),s.TVXWindowEvents.on(this._xEventRequestLogs,this._onRequestLogs),e=()=>{window.loginStateChange&&window.loginStateChange.subscribe(this,this._changeLoginState)},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}on(e,t){this._channelMultiplexer.on(e,t)}off(e,t){this._channelMultiplexer.off(e,t)}onStatus(e){this._statusHandlers.push({handler:e,isPrivate:!1}),setTimeout((()=>e(this._statusPublic)),0)}onPrivateStatus(e){this._statusHandlers.push({
handler:e,isPrivate:!0}),setTimeout((()=>e(this._statusPrivate)),0)}onReconnect(e,t=!1){this._reconnectHandlers.push({handler:e,isPrivate:t})}offReconnect(e){this._reconnectHandlers=this._reconnectHandlers.filter((t=>t.handler!==e))}offStatus(e){this._statusHandlers=this._statusHandlers.filter((t=>t.handler!==e))}forceConnect(){var e,t;f.logNormal(`Creating pushstream connection after force connect. Main tab: ${this.ownPushStream()}`),this.ownPushStream()?(null===(e=this._pushStreamPublic)||void 0===e||e.disconnect(),null===(t=this._pushStreamPrivate)||void 0===t||t.disconnect(),this._instantiatePushStream()):s.TVXWindowEvents.emit(this._xEventReconnectCommand)}disconnect(){this.ownPushStream()&&this._destructPushStream()}getLogs(e){return new Promise((t=>{const i=setTimeout((()=>{const e=r.TVLocalStorage.getItem(this._shareLogsKey);t(null!==e?JSON.parse(e):[])}),1e3),n=e=>{let r;s.TVXWindowEvents.off(this._xEventShareLogs,n),s.TVXWindowEvents.emit(this._xEventShareLogs,""),clearTimeout(i);try{r=JSON.parse(e)}catch(e){r=[],f.logError("Failed to parse logs received from master tab")}t(r)};this.ownPushStream()?t(this._getOwnLogs(e)):(s.TVXWindowEvents.on(this._xEventShareLogs,n),s.TVXWindowEvents.emit(this._xEventRequestLogs))}))}ownPushStream(){return!!this._pushStreamPublic||!!this._pushStreamPrivate}pushStream(){if(!this.ownPushStream())throw new Error("Not own PushStream");return this._pushStreamPublic}isConnected(){return this._statusPublic>0}status(){var e;return null!==(e=this._statusPublic)&&void 0!==e?e:o.ConnectionStatus.Closed}statusPrivate(){var e;return null!==(e=this._statusPrivate)&&void 0!==e?e:o.ConnectionStatus.Closed}userChannel(){if(!this._userPrivateChannel)throw new Error("No user channel");return this._userChannel(this._userPrivateChannel)}addChannel(e){this._state.addChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}removeChannel(e){this._state.removeChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}static getInstance(){return null===this._instance&&(this._instance=new w),this._instance}_userChannel(e){return this._userChannelPrefix+e}_codeParams(e){const t=[...e];return t.push((new Date).getTime()),JSON.stringify(t)}_decodeParams(e){const t=JSON.parse(e);return t.pop(),t}_instantiatePushStream(){this._pushStreamPublic&&((0,n.trackEvent)("PushstreamDoublePublic",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPublic.disconnect());const e=this._getPushStreamSettings();this._pushStreamPublic=new d.PushStream(this._dispatchMessage,e),this._pushStreamPublic.connectionStatus().subscribe((e=>{this._dispatchStatusChange(e,this._statusPrivate)})),this._pushStreamPublic.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand()})),this._pushStreamPrivate&&((0,n.trackEvent)("PushstreamDoublePrivate",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPrivate.disconnect()),this._pushStreamPrivate=new d.PushStream(this._dispatchMessage,{...e,maxSize:1}),
this._pushStreamPrivate.connectionStatus().subscribe((e=>{this._dispatchStatusChange(this._statusPublic,e)})),this._pushStreamPrivate.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand(!0)})),this.on("pushstream_set_user_channel",(e=>{this._setUserChannel(e)})),this._connectChannels()}_destructPushStream(){const e=this._pushStreamPublic;this._pushStreamPublic=null,null==e||e.disconnect();const t=this._pushStreamPrivate;this._pushStreamPrivate=null,null==t||t.disconnect(),this._dispatchStatusChangeFromOther(this._codeParams([o.ConnectionStatus.Closed,o.ConnectionStatus.Closed]))}_connectChannels(){var e,t;null===(e=this._pushStreamPublic)||void 0===e||e.addChannel("public");const i=this._state.collectPushStreamChannels("public");void 0!==i&&i.length>0&&i.map((e=>{var t;return null===(t=this._pushStreamPublic)||void 0===t?void 0:t.addChannel(e)})),"is_authenticated"in window?this._connectUserChannelInitial(!0):window.loginStateChange&&window.loginStateChange.subscribe(this,this._connectUserChannelInitial),this._isPublicPushstreamEnabled()&&(null===(t=this._pushStreamPublic)||void 0===t||t.connect())}_getPushStreamSettings(){return(0,p.isOnMobileAppPage)("any")?(0,h.isFeatureEnabled)("enable_eventsource_pushstream_mobile")?y:v:(0,h.isFeatureEnabled)("enable_eventsource_pushstream_transport")?y:v}_isPublicPushstreamEnabled(){return(0,p.isOnMobileAppPage)("any")||!(0,h.isFeatureEnabled)("disable_pushstream_connections_for_anonymous_users")||window.is_authenticated||window.TradingView.onChartPage}_connectUserChannelInitial(e){var t,i,s;e&&(window.is_authenticated?(this._userPrivateChannel=null!==(t=window.user.private_channel)&&void 0!==t?t:null,null===(i=this._pushStreamPrivate)||void 0===i||i.addChannel(this.userChannel()),null===(s=this._pushStreamPrivate)||void 0===s||s.connect()):this._userPrivateChannel=null)}_changeLoginState(e){var t,i,s,n,r,o;e||(this._isPublicPushstreamEnabled()&&(null===(t=this._pushStreamPublic)||void 0===t||t.connect()),window.is_authenticated?(this._userPrivateChannel=null!==(i=window.user.private_channel)&&void 0!==i?i:null,this.ownPushStream()&&(null===(s=this._pushStreamPrivate)||void 0===s||s.addChannel(this.userChannel()),null===(n=this._pushStreamPrivate)||void 0===n||n.connect())):(this.ownPushStream()&&(null===(r=this._pushStreamPrivate)||void 0===r||r.removeChannel(this.userChannel()),null===(o=this._pushStreamPrivate)||void 0===o||o.disconnect()),this._userPrivateChannel=null))}_setUserChannel(e){var t,i;f.logNormal("Set user channel "+e),e!==this._userPrivateChannel&&(this.ownPushStream()&&this._userPrivateChannel&&(null===(t=this._pushStreamPrivate)||void 0===t||t.removeChannel(this.userChannel())),this._userPrivateChannel=e,this.ownPushStream()&&this._userPrivateChannel&&(null===(i=this._pushStreamPrivate)||void 0===i||i.addChannel(this.userChannel())))}_dispatchStatusChange(e,t){this._dispatchStatusChangeToOthers(e,t),this._dispatchStatusChangeToSelf(e,t)}_dispatchStatusChangeToSelf(e,t){e!==this._statusPublic&&(this._statusPublic=e,
this._callStatusHandlers(e,!1)),t!==this._statusPrivate&&(this._statusPrivate=t,this._callStatusHandlers(t,!0))}_callStatusHandlers(e,t){f.logNormal("Connection status change: "+e+", private "+t+", is main tab "+this.ownPushStream()),a.telemetry.sendReport("site","pushstream_status_change"),this._statusHandlers.forEach((i=>{i.isPrivate===t&&i.handler(e)}))}_callReconnectHandlers(e){f.logNormal("Reconnection has been made"),this._reconnectHandlers.forEach((t=>{t.isPrivate===e&&t.handler()}))}_dispatchReconnectSuccessCommand(e=!1){if(this.ownPushStream()){this._callReconnectHandlers(e);const t=this._codeParams([e]);s.TVXWindowEvents.emit(this._xEventReconnectSuccess,t)}}_decodeConnectionStatus(e){const t=parseInt(e,10);return isNaN(t)?this._decodeParams(e):[t,t]}_dispatchStatusChangeToOthers(e,t){if(this.ownPushStream()){const i=this._codeParams([e,t]);s.TVXWindowEvents.emit(this._xEventConnectionStatus,i)}}_dispatchMessageToSelf(e,t,i,s){const n=e.channel,r=e.content;this._emit(r,t,n,s)}_dispatchMessageToOthers(e,t,i){const n=[e,t,i];s.TVXWindowEvents.emit(this._xEventSend,this._codeParams(n))}_emit(e,t,i,s){this._channelMultiplexer.emit(e,t,i,s)}_getOwnLogs(e){var t;if(this.ownPushStream()){const i=(0,l.getRawLogHistory)(e,d.loggerSubsystemId),s=null===(t=this.pushStream())||void 0===t?void 0:t.getLogs();return[].concat(i,null!=s?s:[])}return[]}}w._instance=null;const b=w.getInstance()},439563:(e,t,i)=>{"use strict";async function s(){const e=(await Promise.all([i.e(22321),i.e(71289),i.e(36683)]).then(i.bind(i,469449))).getTrackerInstance();return e||null}i.d(t,{getEmbedWidgetTracker:()=>s})},768261:(e,t,i)=>{"use strict";var s;i.d(t,{CompareOption:()=>s}),function(e){e[e.SamePctScale=0]="SamePctScale",e[e.NewPriceScale=1]="NewPriceScale",e[e.NewPane=2]="NewPane",e[e.SameScale=3]="SameScale"}(s||(s={}))},261309:(e,t,i)=>{"use strict";i.d(t,{SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE:()=>s});const s={id:"SymbolListRepositoryBackend"}},563349:e=>{e.exports={}},264552:(e,t,i)=>{"use strict";i.d(t,{getServerInterval:()=>n});var s=i(378975);function n(e){return s.Interval.isRange(e)?"1":e}},764829:(e,t,i)=>{"use strict";var s;i.r(t),i.d(t,{disable:()=>h,enable:()=>u,enabled:()=>l,getAllFeatures:()=>c,setEnabled:()=>d});var n=i(111119);const r=new Map,o=new Map,a=new Set;function l(e){const t=r.get(e);if(void 0!==t)return t;const i=o.get(e);return!!i&&i.some(l)}function d(e,t){r.set(String(e),Boolean(t))}function u(e){d(e,!0)}function h(e){d(e,!1)}function c(){const e=Object.create(null);for(const t of a)e[t]=l(t);return e}!function(){for(const[e,t]of Object.entries(s||(s=i.t(n,2))))if(a.add(e),"subsets"in t)for(const i of t.subsets){a.add(i);let t=o.get(i);void 0===t&&(t=[],o.set(i,t)),t.push(e)}"object"==typeof __initialDisabledFeaturesets&&Array.isArray(__initialDisabledFeaturesets)&&__initialDisabledFeaturesets.forEach(h),"object"==typeof __initialEnabledFeaturesets&&Array.isArray(__initialEnabledFeaturesets)&&__initialEnabledFeaturesets.forEach(u)}()},750139:(e,t,i)=>{"use strict";function s(e,t){return e<=t}
function n(e,t){return e>=t}function r(e,t,i){return Math.min(Math.max(e,t),i)}function o(e){return e<0?-1:e>0?1:0}function a(e){if(e<0)return!1;if(e>1e18)return!0;for(let t=e;t>1;t/=10)if(t%10!=0)return!1;return!0}function l(e,t,i){return t-e<=i}function d(e,t,i){return Math.abs(e-t)<i}function u(e){return e<=0?NaN:Math.log(e)/Math.log(10)}function h(e,t){return e<t?-1:e>t?1:0}function c(e,t=h){if(e.length<1)throw Error("array is empty");let i=e[0];for(let s=0;s<e.length;++s)t(e[s],i)<0&&(i=e[s]);return i}function p(e,t=h){if(e.length<1)throw Error("array is empty");let i=e[0];for(let s=0;s<e.length;++s)t(e[s],i)>0&&(i=e[s]);return i}function m(e){const t=Math.ceil(e);return t%2!=0?t-1:t}function _(e){return e>0?Math.floor(e):Math.ceil(e)}i.r(t),i.d(t,{ceiledEven:()=>m,clamp:()=>r,defComparator:()=>h,equal:()=>d,greaterOrEqual:()=>l,greaterThan:()=>n,isBaseDecimal:()=>a,lessThan:()=>s,log10:()=>u,max:()=>p,min:()=>c,sign:()=>o,toInt:()=>_})},872220:(e,t,i)=>{"use strict";i.d(t,{isDrawingToolbarVisible:()=>l});var s=i(62802),n=i(764829),r=i(375397);const o=!n.enabled("hide_left_toolbar_by_default"),a=s.getBool("ChartDrawingToolbarWidget.visible",o),l=new r.WatchedValue(a)},219849:(e,t,i)=>{"use strict";i.d(t,{InvalidationLevel:()=>s,InvalidationMask:()=>a,defaultInvalidationLevel:()=>o});var s,n=i(650151),r=i(259336);!function(e){e[e.None=0]="None",e[e.Cursor=1]="Cursor",e[e.Light=2]="Light",e[e.Full=3]="Full"}(s||(s={}));const o=s.None;class a{constructor(e=o){this._panesOrderChanged=!1,this._keepVisibleTimeRangeOnResize=!1,this._timeAxisInvalidationLevel=o,this._invalidatedPanes=new Map,this._additionalActions=[],this._timeScaleInvalidations=[],this._invalidationLevel=e}invalidateAll(e){this._invalidationLevel!==e&&(this._invalidationLevel=Math.max(this._invalidationLevel,e),this._invalidatedPanes.forEach((e=>{e.invalidateAll(this._invalidationLevel)})))}invalidateAllPane(e,t){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new r.PaneInvalidationMask(this._invalidationLevel)),(0,n.ensureDefined)(this._invalidatedPanes.get(e)).invalidateAll(t)}invalidatePriceScale(e,t,i,s){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new r.PaneInvalidationMask(this._invalidationLevel)),(0,n.ensureDefined)(this._invalidatedPanes.get(e)).invalidatePriceScale(t,i,s)}invalidateTimeScale(e){this._timeAxisInvalidationLevel=Math.max(this._timeAxisInvalidationLevel,e)}invalidatePanesOrder(){this._panesOrderChanged=!0}lockVisibleTimeRangeOnResize(){this._keepVisibleTimeRangeOnResize=!0}fullInvalidation(){return this._invalidationLevel}maxPaneInvalidation(){const e=[];return this._invalidatedPanes.forEach((t=>{e.push(t.fullInvalidation())})),Math.max(...e,this._invalidationLevel)}invalidateForPane(e){return this._invalidatedPanes.get(e)||new r.PaneInvalidationMask(this._invalidationLevel)}invalidateForTimeScale(){return Math.max(this._timeAxisInvalidationLevel,this._invalidationLevel)}validationActions(){return this._additionalActions}addValidationAction(e){this._additionalActions.push(e)}merge(e){
this._invalidationLevel=Math.max(this._invalidationLevel,e._invalidationLevel),this._panesOrderChanged=this._panesOrderChanged||e._panesOrderChanged,this._keepVisibleTimeRangeOnResize=this._keepVisibleTimeRangeOnResize||e._keepVisibleTimeRangeOnResize,this._invalidatedPanes.forEach((e=>{e.invalidateAll(this._invalidationLevel)})),e._invalidatedPanes.forEach(((e,t)=>{this._invalidatedPanes.has(t)||this._invalidatedPanes.set(t,new r.PaneInvalidationMask(this._invalidationLevel)),(0,n.ensureDefined)(this._invalidatedPanes.get(t)).merge(e)})),this._timeAxisInvalidationLevel=Math.max(this._timeAxisInvalidationLevel,e._timeAxisInvalidationLevel);for(let t=0;t<e._additionalActions.length;t++)this._additionalActions.push(e._additionalActions[t]);for(const t of e._timeScaleInvalidations)this._applyTimeScaleInvalidation(t)}panesOrderInvalidated(){return this._panesOrderChanged}isVisibleTimeRangeLockedOnResize(){return this._keepVisibleTimeRangeOnResize}setTimeScaleAnimation(e,t){this._removeTimeScaleAnimation(),this._timeScaleInvalidations.push({type:0,value:e,rightOffsetPx:t})}stopTimeScaleAnimation(){this._removeTimeScaleAnimation(),this._timeScaleInvalidations.push({type:1})}timeScaleInvalidations(){return this._timeScaleInvalidations}static cursor(){return new a(s.Cursor)}static light(){return new a(s.Light)}static full(){return new a(s.Full)}static panesOrder(){const e=a.full();return e.invalidatePanesOrder(),e}static invalidateLegendWidgetLayout(e){var t;const i=new a;return i._invalidatedPanes.set(e,new r.PaneInvalidationMask),null===(t=i._invalidatedPanes.get(e))||void 0===t||t.invalidateLegendWidgetLayout(),i}static validateAction(e){const t=new a;return t._additionalActions.push(e),t}_applyTimeScaleInvalidation(e){switch(e.type){case 0:this.setTimeScaleAnimation(e.value,e.rightOffsetPx);break;case 1:this._removeTimeScaleAnimation()}}_removeTimeScaleAnimation(){var e,t;const i=this._timeScaleInvalidations.findIndex((e=>0===e.type));if(-1!==i){const[s]=this._timeScaleInvalidations.splice(i,1);null===(t=(e=s.value).onFinish)||void 0===t||t.call(e,!1)}}}},616465:(e,t,i)=>{"use strict";i.d(t,{makeSnapshotRequest:()=>l,takeChartSnapshot:()=>a,takeChartSnapshotPromise:()=>o});i(466281);var s=i(444372),n=i(229534),r=i(702598);function o(e,t={}){return new Promise(((i,s)=>{a(e,i,s,t)}))}async function a(e,t,i,s={}){var n;const r=new FormData;if(void 0!==s.previews)for(const e of s.previews)r.append("previews[]",e);void 0!==s.cme&&r.append("cme",String(s.cme)),void 0!==s.wl&&r.append("wl",String(s.wl)),void 0!==s.onWidget&&r.append("onWidget",String(s.onWidget)),s.isReport&&r.append("isReport",String(s.isReport)),s.asyncSave&&r.append("asyncSave",String(s.asyncSave));const o=window.urlParams;o&&o.locale&&r.append("language",o.locale);const a=e.activeChartWidget.value(),d=a.widgetCustomer();void 0!==d&&r.append("customer",d);const u=null!==(n=a.model().model().timezoneExceptExchange().value())&&void 0!==n?n:"exchange";r.append("timezone",u),r.append("symbol",a.model().mainSeries().symbol());const h=await e.clientSnapshot({
showHeaderMainSymbol:s.showHeaderMainSymbol}),c=await new Promise((e=>h.toBlob(e)));null!==c&&r.append("preparedImage",c),l(r,t,i,s)}async function l(e,t,o,a={}){try{const l=await(0,r.fetch)("/snapshot/",{body:e,method:"POST",credentials:"same-origin"}),d=await l.text();if(l.ok)t(d);else{if("suspicious_chart_snapshots_error"===d){const e=s.t(null,void 0,i(124760)).format({start_link:'<a class="tv-dialog__link js-send-report-link" href="#" data-issue-type="other">',end_link:"</a>"});a.onInvalidSnapshotImage&&a.onInvalidSnapshotImage();return(0,n.createErrorDialog)({title:s.t(null,void 0,i(161498)),content:e,btnType:"danger"}).then((e=>{e.on("afterOpen",(()=>{i.e(1484).then(i.bind(i,122791)).then((({bugDialogCreationHandler:t})=>{t(),e.$el.find(".js-send-report-link").click((()=>{e.close()}))}))})),e.open()}))}o()}}catch(e){o()}}},354957:(e,t,i)=>{"use strict";i.d(t,{alertsAvailable:()=>s});const s=i(764829).enabled("alerts")},269665:(e,t,i)=>{"use strict";i.d(t,{createDwmAligner:()=>d,createTimeToBarTimeAligner:()=>h});var s=i(870045),n=i(764829),r=i(378975),o=i(477472),a=i(866554);const l=new o.SessionInfo("Etc/UTC","0000-0000:1234567");function d(e,t){if(!u()||!r.Interval.isDWM(e))return null;const i=new o.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),n=(0,a.newBarBuilder)(e,i,l);return{timeToSessionStart:e=>n.tradingDayToSessionStart(e),timeToExchangeTradingDay:e=>{const t=s.utc_to_cal(i.timezone,e),n=i.spec.correctTradingDay(t);return s.set_hms(n,0,0,0,0,s.get_timezone("Etc/UTC")),n.getTime()}}}function u(){return!n.enabled("disable_resolution_rebuild")}function h(e,t){if(!u())return e=>e;const i=new o.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),s=(0,a.newBarBuilder)(e,i,i,!1);return e=>s.alignTimeIfPossible(e)}},866554:(e,t,i)=>{"use strict";i.d(t,{SessionInfo:()=>a.SessionInfo,getPeriodsBetweenDates:()=>d,newBarBuilder:()=>l});var s=i(870045),n=i(378975),r=i(119159),o=i(409994),a=i(477472);function l(e,t,i,s=!1){const a=n.Interval.parse(e),l=a.multiplier();return a.isMinutes()?new r.IntradayBarBuilder(60*l,t):a.isSeconds()?new r.IntradayBarBuilder(l,t):a.isTicks()?new r.IntradayBarBuilder(1,t):a.isRange()?new r.IntradayBarBuilder(60*l,t):new o.MultidayBarBuilder(t,i,l,function(e,t){switch(e){case n.ResolutionKind.Days:return new o.DailyBuilder(t);case n.ResolutionKind.Weeks:return new o.WeeklyBuilder(t);case n.ResolutionKind.Months:return new o.MonthlyBuilder(t)}throw new Error(`Unknown dwm resolution: ${e}`)}(a.kind(),t),s)}function d(e,t,i,r,o,l,d){const u=n.Interval.parse(o+r);if(u.isMonths()){const e=new Date(l),t=new Date(d);let i=12*(t.getUTCFullYear()-e.getUTCFullYear());return i+=t.getUTCMonth()-e.getUTCMonth(),Math.ceil(i/u.multiplier())}const h=new a.SessionInfo("Etc/UTC",e,t,i),c=u.inMilliseconds();let p;if(u.isDWM())p=864e5;else{const e=h.spec.getWeekIndex(s.get_cal_from_unix_timestamp_ms(h.timezone,d));p=60*h.spec.getEntriesForWeek(e).maxTradingDayLength()*1e3}let m=0;if(u.isWeeks())m=7;else{
const e=h.spec.getWeekIndex(s.get_cal_from_unix_timestamp_ms(h.timezone,d));m=7-h.spec.getEntriesForWeek(e).weekEndsCount()}const _=d-l,g=p/c,f=m*g;let v=_/864e5*g;v>=f&&(v=_/6048e5*f);return v%1<=Number.EPSILON*Math.ceil(v)?Math.round(v):Math.ceil(v)}},262624:(e,t,i)=>{"use strict";i.d(t,{DefaultProperty:()=>H,allowSavingDefaults:()=>M,createDefaultsState:()=>L,extractAllPropertiesKeys:()=>V,extractState:()=>R,extractThemedColors:()=>N});var s=i(154834),n=i(998034),r=i(936714),o=i(954029),a=i(219780),l=i(352315),d=i(650279),u=i(715943),h=i(182433),c=i(283873),p=i(650151),m=i(724377);function _(e){return e<0&&(e+=2*Math.PI),e}const g=[127,127,127];function f(e){const t=e[3],i=e.slice(0,3);for(let e=0;e<3;e++)i[e]=Math.round(i[e]*t+g[e]*(1-t));return i}function v(e,t){const i=function(e,t){const[i,s,n]=e,[r,o,a]=t,l=(Math.sqrt(s**2+n**2)+Math.sqrt(o**2+a**2))/2,d=.5*(1-Math.sqrt(Math.pow(l,7)/(Math.pow(l,7)+6103515625))),u=(1+d)*s,h=(1+d)*o,c=Math.sqrt(u*u+n*n),p=Math.sqrt(h*h+a*a),m=0===n&&0===u?0:_(Math.atan2(n,u)),g=0===a&&0===h?0:_(Math.atan2(a,h)),f=r-i,v=p-c;let y;const w=c*p;0===w?y=0:(y=g-m,y<-Math.PI?y+=2*Math.PI:y>Math.PI&&(y-=2*Math.PI));const b=2*Math.sqrt(w)*Math.sin(y/2),S=(i+r)/2,x=(c+p)/2;let P;const I=m+g;P=c*p==0?I:Math.abs(m-g)<=Math.PI?I/2:I<2*Math.PI?(I+2*Math.PI)/2:(I-2*Math.PI)/2;const T=1-.17*Math.cos(P-Math.PI/6)+.24*Math.cos(2*P)+.32*Math.cos(3*P+Math.PI/30)-.2*Math.cos(4*P-Math.PI/180*63),C=Math.PI/6*Math.exp(-Math.pow((P-Math.PI/180*275)/(Math.PI/180*25),2)),E=2*Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+6103515625)),A=1+.015*Math.pow(S-50,2)/Math.sqrt(20+Math.pow(S-50,2)),L=1+.045*x,D=1+.015*x*T,M=-Math.sin(2*C)*E;return Math.sqrt(Math.pow(f/(1*A),2)+Math.pow(v/(1*L),2)+Math.pow(b/(1*D),2)+M*(v/(1*L))*(b/(1*D)))}(w(y(f((0,m.parseRgba)(e)))),w(y(f((0,m.parseRgba)(t)))));return i<3}function y(e){const[t,i,s]=e,n=t/255,r=i/255,o=s/255,a=100*(n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92),l=100*(r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92),d=100*(o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92);return[.4124*a+.3576*l+.1805*d,.2126*a+.7152*l+.0722*d,.0193*a+.1192*l+.9505*d]}function w(e){const[t,i,s]=e,n=t/95.047,r=i/100,o=s/108.883,a=n>.008856?Math.pow(n,1/3):7.787*n+16/116,l=r>.008856?Math.pow(r,1/3):7.787*r+16/116;return[116*l-16,500*(a-l),200*(l-(o>.008856?Math.pow(o,1/3):7.787*o+16/116))]}var b=i(61499),S=i(331633),x=i(211183),P=i(942634),I=i(692558),T=i(658843);const C=(0,I.getLogger)("ThemedDefaults");function E(){return S.watchedTheme.value()===b.StdTheme.Dark?b.StdTheme.Dark:b.StdTheme.Light}function A(e,t,i){for(const s of t)if((0,r.default)(e,s),i){const t=s.split(".");for(t.pop();t.length;){const i=(0,o.default)(e,t);if(!(0,h.default)(i)||0!==Object.keys(i).length)break;(0,r.default)(e,t),t.pop()}}}function L(e,t,i,r){const o=e?x.defaults:x.factoryDefaults,a=t.startsWith("study_")?(0,s.default)(o("study")):{};let l=(0,s.default)(o(t,r));return t.startsWith("study_")&&l.inputs&&delete l.inputs.symbol,"linetoolicon"===t&&e&&(l.icon=(0,x.defaults)(t).icon),
"linetooemoji"===t&&e&&(l.emoji=(0,x.defaults)(t).emoji),"linetoolsticker"===t&&e&&(l.sticker=(0,x.defaults)(t).sticker),l=(0,s.default)(l),A(l,i),(0,n.default)(a,l),a}let D=!1;function M(e){D=e}function V(e){const t=Object.keys(e),i=[];return t.forEach((t=>{const s=e[t];if((0,h.default)(s)){V(s).forEach((e=>i.push(`${t}.${e}`)))}else i.push(t)})),i}function k(e,t,i=""){if(1===t.length&&"*"===t[0])return e;const s={};for(const n of t){const r=n.split("."),o=r[0],a=e[o],l=""===i?o:`${i}.${o}`;if(e.hasOwnProperty(o))if(r.length>1){if(!(0,h.default)(a)){C.logError(`path ${l} must be an object, but it is a primitive`);continue}{const e=t.filter((e=>e.startsWith(`${o}.`))).map((e=>e.split(".").slice(1).join(".")));s[o]=k(a,e,l)}}else{if((0,h.default)(a)){C.logError(`path ${l} must be a primitive, but it is an object`);continue}s[o]=a}}return s}function R(e,t,i){if(!e)return{};let s=e;return t&&(s=k(e,t)),i&&A(s,i,!0),s}function N(e,t){const i=V(e),s=[];for(const n of i){const i=(0,o.default)(e,n),r=(0,o.default)(t,n);(0,p.assert)(void 0!==i,`Light theme value for ${n} is undefined`),(0,p.assert)(void 0!==r,`Dark theme value for ${n} is undefined`),s.push({path:n,colors:[i,r]})}return s}function B(e,t){e.includes(t)||e.push(t)}function O(e,t){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}function F(e,t){const i=(0,l.default)(e,((e,i,s)=>{if(void 0===t[s])return e;if(!(0,d.default)(i,t[s]))if((0,h.default)(i)&&(0,h.default)(t[s])){const n=F(i,t[s]);void 0!==n&&(e[s]=n)}else e[s]=i;return e}),{});return(0,u.default)(i)?void 0:i}function z(e){return e===b.StdTheme.Dark?1:0}function W(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(!(0,c.default)(e)||!(0,c.default)(t))return!1;const i=(0,m.tryParseRgba)(e),s=(0,m.tryParseRgba)(t);return!(!i||!s)&&!!v(e,t)}class H extends T.Property{constructor(e){const{defaultName:t,nonThemedDefaultsKeys:i,themedDefaultsKeys:s,excludedDefaultsKeys:r=[],themedColors:o,replaceThemedColorsOnThemeChange:a=!1,allStateKeys:l,excludedStateKeys:d=[],excludedTemplateKeys:u=[],state:h,useUserPreferences:c=!0,saveNonDefaultUserPreferencesOnly:m=!1,ignoreAllowSavingDefaults:_=!1,alwaysSaveDefaultKeys:g=["version"],saveDefaultsConsumer:f=x.saveDefaults,factoryDefaultsSupplier:v=(()=>L(!1,t,[],null))}=e;super(),this._themedColors=[],this._restoreFactoryDefaultsEvent=new P.Delegate,this._replaceThemedColorsOnThemeChange=!1,this._defaultName=t,this._useUserPreferences=c,this._saveNonDefaultUserPreferencesOnly=m,this._ignoreAllowSavingDefaults=_,this._saveDefaultsConsumer=f,this._factoryDefaultsSupplier=v,this._allStateKeys=l,this._excludedStateKeys=d,this._nonThemedDefaultsKeys=i,this._themedDefaultsKeys=s,this._allDefaultsKeys=i||s?[...null!=i?i:[],...null!=s?s:[]]:void 0,this._excludedDefaultsKeys=r,this._excludedTemplateKeys=u,this._themedColors=o,this._alwaysSaveDefaultKeys=g,(0,p.assert)(void 0===this._allDefaultsKeys||0===this._excludedDefaultsKeys.length,"Defaults keys and excluded defaults keys cannot be used at the same time"),(0,
p.assert)(void 0===this._allStateKeys||0===this._excludedStateKeys.length,"State keys and excluded state keys cannot be used at the same time"),this.merge((0,n.default)(this._factoryDefaultsForTheme(b.StdTheme.Light),this._userSettings(),R(h,l,d))),o&&a&&this.setThemedColors(o),this._restoreFactoryDefaultsEvent=new P.Delegate}destroy(){var e;null===(e=this._unsubscribeWatchedTheme)||void 0===e||e.call(this),super.destroy()}applyTemplate(e,t){this.mergeAndFire(R((0,n.default)((0,s.default)(t),e),this._allStateKeys,this._excludedTemplateKeys))}preferences(){return R(this.state(this._excludedDefaultsKeys),this._allDefaultsKeys)}template(){return R(this.state(),void 0,this._excludedTemplateKeys)}mergePreferences(e){this.mergeAndFire(R(e,this._allDefaultsKeys,this._excludedDefaultsKeys))}addExcludedKey(e,t){1&t&&B(this._excludedDefaultsKeys,e),2&t&&B(this._excludedStateKeys,e)}removeExcludedKey(e,t){1&t&&O(this._excludedDefaultsKeys,e),2&t&&O(this._excludedStateKeys,e)}restoreFactoryDefaults(){const e=this.factoryDefaults();A(e,this._excludedDefaultsKeys),this.mergeAndFire(e),this._defaultName.startsWith("study_")&&!this._defaultName.startsWith("study_VbPFixed")||this.saveDefaults(),this._restoreFactoryDefaultsEvent.fire()}onRestoreFactoryDefaults(){return this._restoreFactoryDefaultsEvent}childChanged(e,t){var i;super.childChanged(e,t),!this._ignoreAllowSavingDefaults&&!D||this._defaultName.startsWith("replayStudyStrategy")||this._defaultName.startsWith("study_")&&!this._defaultName.startsWith("study_VbPFixed")||!(this._allDefaultsKeys&&this._allDefaultsKeys.includes(t)||!this._allDefaultsKeys&&!(null===(i=this._excludedDefaultsKeys)||void 0===i?void 0:i.includes(t)))||this.saveDefaults()}saveDefaults(){if(!this._useUserPreferences)return;let e;if(this._saveNonDefaultUserPreferencesOnly){const t=this.state(this._excludedDefaultsKeys),i=this.factoryDefaults();if(e=F(R(t,this._nonThemedDefaultsKeys),R(i,this._nonThemedDefaultsKeys,this._excludedDefaultsKeys)),this._alwaysSaveDefaultKeys.length){const i=R(t,this._alwaysSaveDefaultKeys);e=null!=e?e:{},(0,n.default)(e,i)}const s=this.themeDefaults(E()),r=this.themeState(),o=F(r,s);(0,u.default)(o)||(e=null!=e?e:{},(0,n.default)(e,r))}else e=this.preferences();this._saveDefaultsConsumer(this._defaultName,e)}themeDefaults(e){if(this._themedColors)return function(e,t){const i={};for(const{path:s,colors:n}of e)(0,a.default)(i,s,n[z(t)]);return i}(this._themedColors,e===b.StdTheme.Dark?b.StdTheme.Dark:b.StdTheme.Light);return R(this._factoryDefaultsSupplier(),this._themedDefaultsKeys,this._excludedDefaultsKeys)}factoryDefaults(){return this._factoryDefaultsForTheme(E())}themeState(){const e=super.state(this._excludedDefaultsKeys),t=this._themedColors;return R(e,t?t.map((e=>e.path)):this._themedDefaultsKeys)}allThemePropertiesAreDefault(e){(0,p.assert)(!!this._themedColors,"This method should not be called if themed colors are not set");return function(e,t,i=[]){for(const s of i){const i=s.path;if(!W((0,o.default)(e,i),(0,o.default)(t,i)))return!1}return!0
}(this.themeState(),this.themeDefaults(e),this._themedColors)}clone(e){return new H(this._options())}setThemedColors(e){if(this._themedColors=e,void 0===this._unsubscribeWatchedTheme){const e=()=>{this._updateThemedColors(!1)};S.watchedTheme.subscribe(e),this._unsubscribeWatchedTheme=()=>S.watchedTheme.unsubscribe(e)}this._updateThemedColors(!0)}applyDefaultThemedProperties(e){this._themedColors&&this.mergeAndFire(this.themeDefaults(e))}state(e){return R(super.state([...this._excludedStateKeys,...null!=e?e:[]]),this._allStateKeys)}_updateThemedColors(e){if(!this._themedColors)return;const t=E(),i=t===b.StdTheme.Light?b.StdTheme.Dark:b.StdTheme.Light;for(const s of this._themedColors){const n=(0,p.ensureDefined)(this.childByPath(s.path)),r=s.colors[z(i)];(""===n.value()||!e&&W(n.value(),r))&&n.setValue(s.colors[z(t)])}}_userSettings(){if(!this._useUserPreferences)return;const e=L(!0,this._defaultName,[],null);return e?R((0,s.default)(e),this._allDefaultsKeys,this._excludedDefaultsKeys):void 0}_options(){return{defaultName:this._defaultName,factoryDefaultsSupplier:this._factoryDefaultsSupplier,state:this.state(),nonThemedDefaultsKeys:this._nonThemedDefaultsKeys,themedDefaultsKeys:this._themedDefaultsKeys,excludedDefaultsKeys:this._excludedDefaultsKeys,themedColors:this._themedColors,replaceThemedColorsOnThemeChange:this._replaceThemedColorsOnThemeChange,allStateKeys:this._allStateKeys,excludedStateKeys:this._excludedDefaultsKeys,excludedTemplateKeys:this._excludedTemplateKeys,useUserPreferences:this._useUserPreferences,saveNonDefaultUserPreferencesOnly:this._saveNonDefaultUserPreferencesOnly,ignoreAllowSavingDefaults:this._ignoreAllowSavingDefaults,saveDefaultsConsumer:this._saveDefaultsConsumer,alwaysSaveDefaultKeys:this._alwaysSaveDefaultKeys}}_factoryDefaultsForTheme(e){return(0,n.default)(this._factoryDefaultsSupplier(),this.themeDefaults(e))}}},985429:(e,t,i)=>{"use strict";i.d(t,{intervalsVisibilitiesDefaults:()=>s});const s={ticks:!0,seconds:!0,secondsFrom:1,secondsTo:59,minutes:!0,minutesFrom:1,minutesTo:59,hours:!0,hoursFrom:1,hoursTo:24,days:!0,daysFrom:1,daysTo:366,weeks:!0,weeksFrom:1,weeksTo:52,months:!0,monthsFrom:1,monthsTo:12,ranges:!0}},389276:(e,t,i)=>{"use strict";i.d(t,{IntervalsVisibilitiesProperty:()=>r});var s=i(658843),n=i(412788);class r extends s.Property{state(e){var t;return null!==(t=(0,n.nonDefaultIntervalsVisibilities)(super.state(e)))&&void 0!==t?t:void 0}storeStateIfUndefined(){return!1}}},412788:(e,t,i)=>{"use strict";i.d(t,{getIntervalsVisibilitiesForMode:()=>p,isActualInterval:()=>u,makeIntervalsVisibilitiesVisibleAtInterval:()=>l,mergeIntervalVisibilitiesDefaults:()=>c,nonDefaultIntervalsVisibilities:()=>h});var s=i(998034),n=i(154834),r=i(650151),o=i(378975),a=i(985429);function l(e,t){let i=t.multiplier();if(t.isTicks()&&(e.ticks=!0),t.isSeconds()&&(i<60?(e.seconds=!0,e.secondsFrom=Math.min(e.secondsFrom,i),e.secondsTo=Math.max(e.secondsTo,i)):(i=Math.floor(i/60),t=new o.Interval(o.ResolutionKind.Minutes,i))),t.isMinutes())if(i<60)e.minutes=!0,
e.minutesFrom=Math.min(e.minutesFrom,i),e.minutesTo=Math.max(e.minutesTo,i);else{const t=Math.floor(i/60);e.hours=!0,e.hoursFrom=Math.min(e.hoursFrom,t),e.hoursTo=Math.max(e.hoursTo,t)}t.isDays()&&(e.days=!0,e.daysFrom=Math.min(e.daysFrom,i),e.daysTo=Math.max(e.daysTo,i)),t.isWeeks()&&(e.weeks=!0,e.weeksFrom=Math.min(e.weeksFrom,i),e.weeksTo=Math.max(e.weeksTo,i)),t.isMonths()&&(e.months=!0,e.monthsFrom=Math.min(e.monthsFrom,i),e.monthsTo=Math.max(e.monthsTo,i)),t.isRange()&&(e.ranges=!0)}function d(e,t,i,s){return e&&s>=t&&s<=i}function u(e,t){const i=t.childs();switch(e.kind()){case o.ResolutionKind.Ticks:return i.ticks.value();case o.ResolutionKind.Seconds:if(e.multiplier()<60)return d(i.seconds.value(),i.secondsFrom.value(),i.secondsTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return d(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),t)}case o.ResolutionKind.Minutes:if(e.multiplier()<60)return d(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return d(i.hours.value(),i.hoursFrom.value(),i.hoursTo.value(),t)}case o.ResolutionKind.Days:return d(i.days.value(),i.daysFrom.value(),i.daysTo.value(),e.multiplier());case o.ResolutionKind.Weeks:return d(i.weeks.value(),i.weeksFrom.value(),i.weeksTo.value(),e.multiplier());case o.ResolutionKind.Months:return d(i.months.value(),i.monthsFrom.value(),i.monthsTo.value(),e.multiplier());case o.ResolutionKind.Range:return i.ranges.value()}return(0,r.assert)(!1,`Unsupported resolution: ${e.value()}`),!1}function h(e){const t=Object.keys(e).filter((t=>a.intervalsVisibilitiesDefaults[t]!==e[t]));return 0===t.length?null:t.reduce(((t,i)=>(t[i]=e[i],t)),{})}function c(e){return(0,s.default)((0,n.default)(a.intervalsVisibilitiesDefaults),null!=e?e:{})}function p(e,t){if(0===t||e.isTicks()&&3===t||e.isRange()&&2===t)return c();let i=!1;const s={ticks:!1,seconds:!1,minutes:!1,hours:!1,days:!1,weeks:!1,months:!1,ranges:!1},n=e=>e.multiplier();return[{checker:e=>e.isTicks(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.ticks=!0}},{checker:e=>e.isSeconds()&&e.multiplier()<60,getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.seconds=!0,s.secondsFrom=e,s.secondsTo=t}},{checker:e=>e.isSeconds()&&e.multiplier()>=60,getIntervalMultiplier:e=>Math.floor(e.multiplier()/60),markIntervalAsVisible:(e,t)=>{s.minutes=!0,s.minutesFrom=e,s.minutesTo=t}},{checker:e=>e.isMinutes()&&e.multiplier()<60,getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.minutes=!0,s.minutesFrom=e,s.minutesTo=t}},{checker:e=>e.isMinutes()&&e.multiplier()>=60,getIntervalMultiplier:e=>Math.floor(e.multiplier()/60),markIntervalAsVisible:(e,t)=>{s.hours=!0,s.hoursFrom=e,s.hoursTo=t}},{checker:e=>e.isDays(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.days=!0,s.daysFrom=e,s.daysTo=t}},{checker:e=>e.isWeeks(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.weeks=!0,s.weeksFrom=e,s.weeksTo=t}},{checker:e=>e.isMonths(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.months=!0,s.monthsFrom=e,
s.monthsTo=t}},{checker:e=>e.isRange(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{s.ranges=!0}}].forEach((s=>{if(s.checker(e)){i=!0;const n=s.getIntervalMultiplier(e);1===t?s.markIntervalAsVisible(n,n):3===t?s.markIntervalAsVisible(n,void 0):s.markIntervalAsVisible(void 0,n)}else(!i&&2===t||i&&3===t)&&s.markIntervalAsVisible(void 0,void 0)})),c(s)}},219774:(e,t,i)=>{"use strict";i.d(t,{LineToolBrushBase:()=>r});var s=i(650151),n=i(929927);class r extends n.LineDataSource{constructor(){super(...arguments),this._finished=!1}pointsCount(){return-1}finished(){return this._finished}finish(){this._finished=!0,this._lastPoint=null,this._normalizePoints(),this.createServerPoints()}hasEditableCoordinates(){return!1}hasOnlyOnePoint(){return 1===this._points.length}addPoint(e,t,i){if(this._finished)return!0;if(this._lastPoint=null,this._points.length>0){const t=this._points[this._points.length-1],i=(0,s.ensureNotNull)(this.pointToScreenPoint(t));if((0,s.ensureNotNull)(this.pointToScreenPoint(e)).subtract(i).length()<2)return this._finished}return super.addPoint(e),this._finished}restorePoints(e,t,i){super.restorePoints(e,t,i),this._finished=!0}}},896123:(e,t,i)=>{"use strict";i.d(t,{LineDataSourcePointIndexProperty:()=>n});var s=i(658843);class n extends s.Property{constructor(e,t){super(),this._waitingPointsetUpdate=!1,this._lineSource=e,this._pointIndex=t,this._cachedIndex=this.value()}value(){const e=this._lineSource.points();return 0===e.length?this._cachedIndex:e[this._pointIndex].index}setValue(e){this._cachedIndex=e;const t=this._lineSource.points(),i=e=>{const t=this._lineSource.points()[this._pointIndex];if(t.index===e)return;t.index=e,this._lineSource.startChanging(this._pointIndex,t),this._setPointImpl(t),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this,"");const i=this._lineSource.endChanging(!0,!1);this._lineSource.syncMultichartState(i)};if(0===t.length){const e=()=>{i(this._cachedIndex),this._waitingPointsetUpdate=!1};if(this._waitingPointsetUpdate)return;this._lineSource.pointsetUpdated().subscribe(this,e,!0),this._waitingPointsetUpdate=!0}else i(e)}_setPointImpl(e){this._lineSource.setPoint(this._pointIndex,e)}}},129824:(e,t,i)=>{"use strict";i.d(t,{LineToolPriceAxisView:()=>o});var s=i(650151),n=i(347808),r=i(432059);class o extends n.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t,this._properties=e.model().properties().childs().scalesProperties}_updateRendererData(e,t,i){e.visible=!1;const s=this._source.model();if(!s.timeScale()||s.timeScale().isEmpty())return;const n=this._source.priceScale();if(null===n||n.isEmpty())return;if(!s.selection().isSelected(this._source)&&!this._source.isForcedDrawPriceAxisLabel())return;if(null===s.timeScale().visibleBarsStrictRange())return;const o=this._source.priceAxisPoints(),a=this._data.pointIndex;if(o.length<=a)return;const l=o[a];if(!isFinite(l.price))return;const d=this._source.ownerSource(),u=null!==d?d.firstValue():null;if(null===u)return
;let h=this._data.backgroundPropertyGetter?this._data.backgroundPropertyGetter():null;null===h&&(h=this._getBgColor()),i.background=(0,r.resetTransparency)(h),i.borderColor="#2E84A6",i.textColor=this.generateTextColor(i.background),i.coordinate=n.priceToCoordinate(l.price,u),e.text=this._formatPrice(l.price,u),e.visible=!0}_getBgColor(){return this._active?this._properties.childs().axisLineToolLabelBackgroundColorActive.value():this._properties.childs().axisLineToolLabelBackgroundColorCommon.value()}_formatPrice(e,t){return(0,s.ensureNotNull)(this._source.priceScale()).formatPrice(e,t)}}},735815:(e,t,i)=>{"use strict";i.d(t,{LineDataSourceTimeAxisView:()=>n});var s=i(83810);class n extends s.TimeAxisView{constructor(e,t){super(e.model()),this._active=!1,this._source=e,this._pointIndex=t,this._properties=e.model().properties().childs().scalesProperties}setActive(e){this._active=e}_getBgColor(){return this._active?this._properties.childs().axisLineToolLabelBackgroundColorActive.value():this._properties.childs().axisLineToolLabelBackgroundColorCommon.value()}_getIndex(){if(!this._model.selection().isSelected(this._source))return null;const e=this._source.timeAxisPoints();return e.length<=this._pointIndex?null:e[this._pointIndex].index}_isVisible(){return!0}}},929927:(e,t,i)=>{"use strict";i.d(t,{LineDataSource:()=>K});var s=i(86441),n=i(650151),r=i(251954),o=i(338619),a=i(764829),l=i(269665),d=i(870045),u=i(942634),h=i(387964),c=i(124829),p=i(447935),m=i(771702),_=i(39510),g=i(354957),f=i(843698),v=i(375397),y=i(219849),w=i(264552),b=i(412788),S=i(985429),x=i(975179),P=i(157504),I=i(378975),T=i(658843),C=i(419283),E=i(903424),A=i(389276),L=i(169532),D=i(487945),M=i(896123);class V extends T.Property{constructor(e,t){super(),this._lineSource=e,this._pointIndex=t,e.pointAdded().subscribe(this,(e=>{this._pointIndex===e&&this._listeners.fire(this,`${e}`)})),e.pointChanged().subscribe(this,(e=>{this._pointIndex===e&&this._listeners.fire(this,`${e}`)}))}value(){const e=this._lineSource.points()[this._pointIndex].price,t=(0,n.ensureNotNull)(this._lineSource.ownerSource()).formatter();if(t.parse){const i=t.format(e),s=t.parse(i);return s.res?s.value:e}return e}setValue(e){const t=this._lineSource.points()[this._pointIndex];t.price=parseFloat(""+e),this._lineSource.startChanging(this._pointIndex,t),this._lineSource.setPoint(this._pointIndex,t),this._lineSource.model().updateSource(this._lineSource),this._listeners.fire(this,"");const i=this._lineSource.endChanging(!0,!1);this._lineSource.syncMultichartState(i)}}var k=i(735815),R=i(129824),N=i(23666),B=i(889301),O=i(211183),F=i(941654);const z=(0,o.getLogger)("Chart.LineDataSource"),W=a.enabled("datasource_copypaste");class H{constructor(){this._states=[]}start(e){this._states.push(e)}finish(e){const t=(0,n.ensureDefined)(this._states.pop());return s=t,(i=e).length!==s.length?{indexesChanged:!0,pricesChanged:!0}:i.reduce(((e,t,i)=>{const n=s[i];return e.indexesChanged=e.indexesChanged||t.index!==n.index,e.pricesChanged=e.pricesChanged||t.price!==n.price,e}),{indexesChanged:!1,
pricesChanged:!1});var i,s}isEmpty(){return 0===this._states.length}}let U=0;class K extends E.DataSource{constructor(e,t,i,s){if(super(s),this.version=1,this.toolname="",this.customization={forcePriceAxisLabel:!1,disableErasing:!1,disableSave:!1,showInObjectsTree:!0},this._currentPointsetAndSymbolId=null,this._pointChanged=new u.Delegate,this._pointAdded=new u.Delegate,this._priceAxisViews=[],this._timeAxisViews=[],this._timePoint=[],this._points=[],this._lastPoint=null,this._paneViews=new Map,this._normalizedPointsChanged=new u.Delegate,this._fixedPointsChanged=new u.Delegate,this._changeStatesStack=new H,this._startMovingPoint=null,this._currentMovingPoint=null,this._isActualSymbol=!1,this._isActualInterval=!1,this._isActualCurrency=!1,this._isActualUnit=!1,this._sharingMode=new v.WatchedValue(0),this._onTemplateApplying=new u.Delegate,this._onTemplateApplied=new u.Delegate,this._syncStateExclusions=[],this._definitionsViewModel=null,this._syncLineStyleMuted=!1,this._onIsActualIntervalChange=new u.Delegate,this._onPointsetUpdatedDelegate=new u.Delegate,this._linkKey=new v.WatchedValue(null),this._serverUpdateTime=null,this._boundCalcIsActualSymbol=this.calcIsActualSymbol.bind(this),this._alignerCache=null,this._alertUndoMode=!1,this._onAlertStatusChanged=()=>{this.updateAllViewsAndRedraw((0,L.sourceChangeEvent)(this.id()))},this._model=e,this._properties=t,this._localAndServerAlertsMismatch=!1,this._properties.hasChild("interval")||this._properties.addChild("interval",new T.Property(e.mainSeries().interval())),this.calcIsActualSymbol(),this._properties.childs().intervalsVisibilities.listeners().subscribe(this,this.calcIsActualSymbol),this._properties.subscribe(this,(()=>this.propertiesChanged())),this._createPointsProperties(),this.pointsCount()>0)for(let e=0;e<this.pointsCount();e++)this._priceAxisViews.push(this.createPriceAxisView(e)),this._timeAxisViews.push(new k.LineDataSourceTimeAxisView(this,e));this._properties.childs().visible.subscribe(this,(e=>{const t=!1===(0,C.hideAllDrawings)().value();e.value()?e.value()&&t&&r.emit("drawing_event",this._id,"show"):(this._model.selection().isSelected(this)&&this._model.selectionMacro((e=>{e.removeSourceFromSelection(this)})),t&&r.emit("drawing_event",this._id,"hide")),this._onSourceHiddenMayChange()})),(0,C.hideAllDrawings)().subscribe(this,this._onSourceHiddenMayChange),this._sessionConnected=this._model.chartApi().isConnected().spawn(),this._sessionConnected.subscribe((e=>{e||(this._currentPointsetAndSymbolId=null)})),this._alertStatus.subscribe(this._onAlertStatusChanged),this._definitionsViewModel=null,this._properties.setNameInOwner((0,F.propertyPathForSource)(this))}destroy(){this._paneViews.forEach(((e,t)=>this._destroyPanePaneViews(t))),this.stop(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this),(0,
D.isSymbolSource)(this._ownerSource)&&(this._ownerSource.symbolResolved().subscribe(this,this._boundCalcIsActualSymbol),this._ownerSource.isActingAsSymbolSource().unsubscribe(this._boundCalcIsActualSymbol))),this.ownerSourceChanged().unsubscribeAll(this),(0,C.hideAllDrawings)().unsubscribeAll(this),this.deleteAlert(),this._sessionConnected.destroy(),this._alertStatus.unsubscribe(this._onAlertStatusChanged),super.destroy()}setId(e){super.setId(e),this._properties.setNameInOwner((0,F.propertyPathForSource)(this))}priceScale(){return this._ownerSource?this._ownerSource.priceScale():null}createPriceAxisView(e){return new R.LineToolPriceAxisView(this,{pointIndex:e})}model(){return this._model}symbol(){return this._properties.childs().symbol.value()}linkKey(){return this._linkKey}serverUpdateTime(){return this._serverUpdateTime}setServerUpdateTime(e){this._serverUpdateTime=e}boundToSymbol(){return!0}isAvailableInFloatingWidget(){return!0}points(){const e=[];for(let t=0;t<this._points.length;t++){const i=this._points[t];e.push({index:i.index,price:i.price,time:i.time})}return this._lastPoint&&e.push(this._correctLastPoint(this._lastPoint)),!this.isFixed()&&this._currentMovingPoint&&this._startMovingPoint&&this._correctPoints(e),e}timeAxisPoints(){return this.points()}priceAxisPoints(){return this.points()}fixedPoint(){var e;let t;const i=this.priceScale();if(this._positionPercents&&null!==i&&!i.isEmpty()){const e=this._positionPercents,n=this._model.timeScale().width()*e.x,r=i.height()*e.y;t=new s.Point(n,r)}else void 0!==this._fixedPoint&&(t=null===(e=this._fixedPoint)||void 0===e?void 0:e.clone());if(this._currentMovingPoint&&this._startMovingPoint&&void 0!==t){const e=this._correctFixedPoint(t);e.didCorrect&&(t=e.point)}return t}positionPercents(){return this._positionPercents}normalizedPoints(){return this._timePoint}normalizedPointsForCreating(){return this.normalizedPoints()}normalizedPointsChanged(){return this._normalizedPointsChanged}fixedPointChanged(){return this._fixedPointsChanged}geometry(){const e=(0,n.ensureNotNull)(this.priceScale());return this.points().map((t=>{const i=(0,n.ensureNotNull)(this.pointToScreenPoint(t)),r=i.x/this._model.timeScale().width(),o=i.y/e.height();return new s.Point(r,o)}))}widthsProperty(){var e;return null!==(e=this._properties.childs().linesWidths)&&void 0!==e?e:null}lineColorsProperty(){var e;return null!==(e=this._properties.childs().linesColors)&&void 0!==e?e:null}backgroundColorsProperty(){var e;return null!==(e=this._properties.childs().backgroundsColors)&&void 0!==e?e:null}textColorsProperty(){var e;return null!==(e=this._properties.childs().textsColors)&&void 0!==e?e:null}pointsProperty(){return this._pointsProperty}hasEditableCoordinates(){return!0}startMoving(e,t,i,s){this.isFixed()&&this.restoreFixedPoint(),this._startMovingPoint=e}move(e,t,i,s){if(i&&(i.shiftOnly()||i.modShift()))if(this.isFixed()){const t=this._alignScreenPointHorizontallyOrVertically((0,n.ensureDefined)(e.screen));this._currentMovingPoint={screen:t}}else{
const t=this._alignPointHorizontallyOrVertically((0,n.ensureDefined)(e.logical)),i=(0,n.ensureNotNull)(this.pointToScreenPoint(t));this._currentMovingPoint={logical:t,screen:i}}else this._currentMovingPoint=e;this.updateAllViews((0,L.sourceChangeEvent)(this.id()))}endMoving(e,t,i){let s=!1,o=!1;if(this._currentMovingPoint&&this._startMovingPoint){if(this.isFixed()){const e=this._correctFixedPoint((0,n.ensureDefined)(this._fixedPoint));e.didCorrect&&(this._fixedPoint=e.point,this._fixedPointsChanged.fire())}else{const e=(0,n.ensureDefined)(this._currentMovingPoint.logical),t=(0,n.ensureDefined)(this._startMovingPoint.logical);s=e.index!==t.index,o=e.price!==t.price;if(this._correctPoints(this._points,i)){r.emit("drawing_event",this._id,"move"),r.emit("drawing_event",this._id,"points_changed");for(let e=0;e<this._points.length;e++)this._pointChanged.fire(e)}}this._startMovingPoint=null,this._currentMovingPoint=null}const a={indexesChanged:s,pricesChanged:o};return this.isFixed()?(this.calcPositionPercents(),this.updateAllViews((0,L.sourceChangeEvent)(this.id())),a):(s&&this._points.forEach((e=>e.interval=this._model.mainSeries().interval())),this.updateAllViews((0,L.sourceChangeEvent)(this.id())),s&&!e?(this._properties.childs().interval.setValue(this._model.mainSeries().interval()),this._normalizePoints(),this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),t||!o&&!s||this.synchronizeAlert(!this._alertUndoMode),a)}startMovingPoint(){return this._startMovingPoint?{...this._startMovingPoint}:null}currentMovingPoint(){return this._currentMovingPoint?{...this._currentMovingPoint}:null}startChanging(e,t){void 0!==e&&void 0!==t&&(e<this._priceAxisViews.length&&this._priceAxisViews[e].setActive(!0),e<this._timeAxisViews.length&&this._timeAxisViews[e].setActive(!0)),this._changeStatesStack.start(this.points())}endChanging(e,t,i){const s=this._changeStatesStack.finish(this.points());s.indexesChanged&&this._changeStatesStack.isEmpty()?(this._normalizePoints(),t||this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),r.emit("drawing_event",this._id,"points_changed");for(let e=0;e<this._priceAxisViews.length;e++)this._priceAxisViews[e].setActive(!1);for(let e=0;e<this._timeAxisViews.length;e++)this._timeAxisViews[e].setActive(!1);return i||this.synchronizeAlert(!e),s}setPoint(e,t,i,s){if(this._snapTo45DegreesApplicable(i)){const i=0===e?1:e-1;this.snapPoint45Degree(t,this.points()[i])}this._setPoint(e,{...t,interval:this._model.mainSeries().interval()})}getPoint(e){return this.points()[e]||null}alignCrossHairToAnchor(e){return!0}alignCrossHairToMovePoint(){return!1}setLastPoint(e,t,i=!0){return this._lastPoint=i?this._preparePoint(e,t):e,this.updateAllViews((0,L.sourceChangeEvent)(this.id())),this._lastPoint}lastPoint(){return this._lastPoint}getChangePointForSync(e){return this.getPoint(e)}setPoints(e){const t=this._model.mainSeries().interval();this._points=e.map((e=>{var i;return{...e,
interval:null!==(i=e.interval)&&void 0!==i?i:t}}))}isForcedDrawPriceAxisLabel(){return this.customization.forcePriceAxisLabel}clearData(){this._points=[]}denormalizeTimePoints(){var e;let t=[];const i=this._model.mainSeries().interval();for(let s=0;s<this._timePoint.length;s++){const n=this._model.timeScale().denormalizeTimePoint(this._timePoint[s]);if(void 0===n){t=[];break}t.push({index:n,price:this._timePoint[s].price,interval:null!==(e=this._timePoint[s].interval)&&void 0!==e?e:i})}t.length>0&&(this._points=t)}restorePoints(e,t,i){const s=this._timePoint.length>0&&!(0,c.deepEquals)(this._timePoint,e)[0],n=this._properties.childs().interval.value();this._timePoint=e.map((e=>{var t;return{...e,interval:null!==(t=e.interval)&&void 0!==t?t:n}}));const r=this._model.mainSeries().interval();this._points=t.map((e=>({...e,interval:r}))),i||this.denormalizeTimePoints(),s&&this._normalizedPointsChanged.fire()}restorePositionPercents(e){this._positionPercents=e}calcIsActualSymbol(){const e=this.ownerSource();if(null===e)this._isActualSymbol=!1;else{const t=(0,n.ensureNotNull)(e.symbolSource()),i=t.symbolInfo();if(i){this._migrateSymbolProperty(i);const e=this._properties.childs().symbol,s=e.value();if(this._isActualSymbol=t.symbolSameAsCurrent(s),this._isActualSymbol){const n=(0,x.extractLineToolSymbolFromSymbolInfo)(i,t.symbol());(0,P.areEqualSymbols)(s,n)||(z.logWarn('Possible drawing "migrating" detected from "'+s+'" to "'+n+'"'),z.logWarn("Series symbolInfo: "+JSON.stringify(t.symbolInfo())),z.logWarn(`${(new Error).stack}`)),e.setValue(n)}}}this.calcIsActualInterval(),this.calcIsActualCurrency(),this.calcIsActualUnit(),this._onSourceHiddenMayChange()}calcIsActualCurrency(){const e=this.ownerSource();if(null===e)return void(this._isActualCurrency=!1);let t=this._properties.childs().currencyId.value();if(null!==t){const i=e.symbolSource();"pct"===t&&(this._properties.childs().currencyId.setValue(null),t=null),this._isActualCurrency=t===(0,x.symbolCurrency)(i.symbolInfo(),void 0,!0)}else{const t=(0,n.ensureNotNull)(e.symbolSource());this._isActualCurrency=null!==t.symbolInfo()&&!t.isConvertedToOtherCurrency()}this._onSourceHiddenMayChange()}calcIsActualUnit(){const e=this.ownerSource();if(null===e)return void(this._isActualUnit=!1);const t=this._properties.childs().unitId.value();if(null!==t)this._isActualUnit=t===(0,n.ensureNotNull)(e.symbolSource()).unit();else{const t=(0,n.ensureNotNull)(e.symbolSource());this._isActualUnit=null!==t.symbolInfo()&&!t.isConvertedToOtherUnit()}this._onSourceHiddenMayChange()}calcIsActualInterval(){const e=this._isActualInterval,t=this._properties,i=this._model.mainSeries();this._isActualInterval=(0,b.isActualInterval)(I.Interval.parse(i.interval()),t.childs().intervalsVisibilities),!this._isActualInterval&&this._model.selection().isSelected(this)&&this._model.selectionMacro((e=>e.removeSourceFromSelection(this))),this._isActualInterval!==e&&this._onIsActualIntervalChange.fire(),this._onSourceHiddenMayChange()}paneViews(e){if(this.isSourceHidden())return null
;const t=this._getPaneViews(this.isMultiPaneAvailable()?e:void 0);if(null===t)return null;if(1===t.length)return[t[0]];const i=[];for(let e=t.length-1;e>=0;--e)i.push(t[e]);return i}priceAxisViews(e,t){if(t!==this.priceScale()||this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){const e=this._model.linePointBeingEdited();if(null!==e&&e<this._priceAxisViews.length){const t=this._priceAxisViews.slice(),i=t[e];return t.splice(e,1),t.push(i),t}return this._priceAxisViews}return this._priceAxisViews}timeAxisViews(){if(this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){const e=this._model.linePointBeingEdited();if(null!==e&&e<this._timeAxisViews.length){const t=this._timeAxisViews.slice(),i=t[e];return t.splice(e,1),t.push(i),t}return this._timeAxisViews}return this._timeAxisViews}isSavedInChart(){return!this.customization.disableSave}isSavedInStudyTemplates(){return!1}setSavingInChartEnabled(e){this.customization.disableSave=!e}shouldBeRemovedOnDeselect(){return!1}getOrderTemplate(){return null}getSourceIcon(){return{type:"loadSvg",svgId:"linetool."+this.toolname}}alertId(){return this._alertId}async waitSettingAlertId(){this._pendingAlertIdPromise&&(this._alertId=await this._pendingAlertIdPromise)}async setAlert(e,t={}){if(!this.canHasAlert())throw new Error("Line data source can not has alert");if(this._pendingAlertIdPromise)return void z.logWarn("Setting alert of line data source will be ignored because alert is already being set");if((0,c.isPromise)(e)){this._pendingAlertIdPromise=e;try{await this.waitSettingAlertId()}finally{delete this._pendingAlertIdPromise}}else this._alertId=e;const i=(0,n.ensureDefined)(this._alertId);this._hasAlert.setValue(!0),this._alertStatus.setValue(1),this._removeAlertSubscriptions(),await this._syncAlertWithAlertFacade(t);const s=this.linkKey().value();null===s||t.sync||(0,C.changeLineStyle)({linkKey:s,model:this._model,state:{},alertId:i})}async restoreAlert(e,t){if(!this.canHasAlert())throw new Error("Line data source can not has alert");this._alertId=e,this._hasAlert.setValue(!0);try{const e=await this.getAlert();if(!e)return;this._addAlertSubscriptions(e,t)}catch(e){this._removeAlertSubscriptions()}}editAlert(e){this.hasAlert().value()&&(0,p.getChartAlertsFacade)().then((t=>{t.openEditDialog((0,n.ensureDefined)(this._alertId),{dataSourceHub:this._model,actionSource:e,onAborted:e=>{e===f.AlertEditorAbortReason.AlertIsInvalid&&this.removeAlert()}})}))}async getAlert(){try{const e=await this._getChartAlert();if(!e)throw z.logError("Failed to get alert, alert will not be saved with drawing in chart"),new Error("got_no_alert");return e}catch(e){if("not_exists"===e)throw new Error(e);return z.logError(`Getting alert failed: ${e instanceof Error?e.message:e}`),null}}getAlertSync(){var e;if(!this._alertId)return null;const t=(0,p.getChartAlertsFacadeIfCreatedBefore)();return null===t?null:null!==(e=t.getAlertSync(this._alertId))&&void 0!==e?e:null}async synchronizeAlert(e=!1){
if(this.hasAlert().value()||this._pendingAlertIdPromise)return new Promise(((t,i)=>{setTimeout((async()=>{if(!this._isDestroyed)try{await this.waitSettingAlertId(),0===this._alertStatus.value()&&await this._syncAlertWithAlertFacade(),this.hasAlert().value()&&this._synchronizeAlert(e),t()}catch(e){i(e)}}),0)}))}syncAlert(e){this.hasAlert().value()||this.setAlert(e,{sync:!0})}stateForAlert(){if(!this.canHasAlert())return null;const e={...this.state(),id:this.idForAlert(),uniqueId:this.idForAlert(),title:this.translatedType(),interval:this._model.mainSeries().interval()},t=this._getAlertPlots();return t&&t.length>0&&(e.plots=t),e}getAlertIsActive(){if(!this._alertId)return!1;const e=this.getAlertSync();return Boolean(e&&e.active().value())}detachAlert(){this._removeAlertSubscriptions(),this._hasAlert.setValue(!1),this._alertId=void 0,this._alertStatus.setValue(0)}removeAlert(){this._alertId=void 0,this._hasAlert.setValue(!1),this._alertStatus.setValue(0),this._removeAlertSubscriptions()}deleteAlert(){if(!this.hasAlert().value()||void 0===this._alertId)return;const e=(0,p.getChartAlertsFacadeIfCreatedBefore)();e&&e.deleteAlert(this._alertId),this.removeAlert()}areLocalAndServerAlertsMismatch(){return this._localAndServerAlertsMismatch}showInObjectTree(){return this.customization.showInObjectsTree}setShowInObjectsTreeEnabled(e){this.customization.showInObjectsTree=e}start(){this.createServerPoints()}processHibernate(){this.canBeHibernated()?this.isStarted()&&this.stop():this.isStarted()||this.start()}canBeHibernated(){return this.isSourceHidden()}onData(e){"pointset_error"!==e.method?e.params.customId===this._currentPointsetIdWithPrefix()&&this._onPointsetUpdated(e.params.plots):z.logError(`Error getting pointset: ${e.params[0]} ${e.params[1]}`)}isBeingEdited(){return this===this._model.lineBeingEdited()}isActualSymbol(){return this._isActualSymbol}isActualCurrency(){return this._isActualCurrency}isActualInterval(){return this._isActualInterval}isActualUnit(){return this._isActualUnit}onIsActualIntervalChange(){return this._onIsActualIntervalChange}setOwnerSource(e){null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this)),null!==this._ownerSource&&(0,D.isSymbolSource)(this._ownerSource)&&(this._ownerSource.symbolResolved().unsubscribe(this,this._boundCalcIsActualSymbol),this._ownerSource.isActingAsSymbolSource().unsubscribe(this._boundCalcIsActualSymbol)),super.setOwnerSource(e),e&&(this.setPriceScale(e.priceScale()),e.currencyChanged().subscribe(this,this.calcIsActualCurrency),e.unitChanged().subscribe(this,this.calcIsActualUnit),this.calcIsActualSymbol(),this._migrateZOrder(),this._updateAlertCreationAvailable()),(0,D.isSymbolSource)(e)&&(e.symbolResolved().subscribe(this,this._boundCalcIsActualSymbol),e.isActingAsSymbolSource().subscribe(this._boundCalcIsActualSymbol))}dataAndViewsReady(){return this._paneViews.size>0}pointAdded(){return this._pointAdded}pointChanged(){return this._pointChanged}pointsetUpdated(){
return this._onPointsetUpdatedDelegate}pointToScreenPoint(e){var t;const i=this._model.timeScale(),n=this.priceScale(),r=null===(t=this.ownerSource())||void 0===t?void 0:t.firstValue();if(!n||n.isEmpty()||i.isEmpty()||null==r)return null;const o=i.indexToCoordinate(e.index),a=n.priceToCoordinate(e.price,r);return new s.Point(o,a)}screenPointToPoint(e){var t;const i=this.priceScale(),s=null===(t=this.ownerSource())||void 0===t?void 0:t.firstValue();if(null==s||!isFinite(s)||null===i)return null;const n=this._model.timeScale().coordinateToIndex(e.x);return{price:i.coordinateToPrice(e.y,s),index:n}}calcMiddlePoint(e,t){return new s.Point((e.x+t.x)/2,(e.y+t.y)/2)}addPoint(e,t,i){const s=this._preparePoint(e,t);return this._addPointIntenal(s,t,i)}addFixedPoint(e){return this._fixedPoint=e,this.calcPositionPercents(),!0}calcPositionPercents(){const e=this.priceScale();if(!e||e.isEmpty()||void 0===this._fixedPoint)return;const t=this._fixedPoint.x/this._model.timeScale().width(),i=this._fixedPoint.y/e.height();return this._positionPercents={x:t,y:i},this._positionPercents}restoreFixedPoint(){this._fixedPoint=this.fixedPoint()}propertiesChanged(e){this.calcIsActualInterval(),this.updateAllViewsAndRedraw((0,L.sourceChangeEvent)(this.id())),e||this._syncLineStyleIfNeeded(),void 0===this._pendingPropertyChangedEvent&&(this._pendingPropertyChangedEvent=setTimeout((()=>{this._pendingPropertyChangedEvent=void 0,r.emit("drawing_event",this._id,"properties_changed")}),0))}state(e){var t;const i={type:this.toolname,id:this.id(),state:this.properties().state(this._propertiesStateExclusions()),points:(0,h.deepCopy)(this._timePoint),zorder:this.zorder(),ownerSource:null===(t=this.ownerSource())||void 0===t?void 0:t.id()};return this.linkKey().value()&&(i.linkKey=this.linkKey().value()),0!==this._sharingMode.value()&&(i.sharingMode=this._sharingMode.value()),delete i.state.points,e&&(i.indexes=this._points),this.isFixed()&&(i.positionPercents=this._positionPercents||this.calcPositionPercents()),"version"in this&&1!==this.version&&(i.version=this.version),this._saveAlertIdInState()&&this.hasAlert().value()&&void 0!==this._alertId&&(i.alertId=this._alertId),i}updateAllViews(e){this.isSourceHidden()||(this._updateAllPaneViews(e),this._priceAxisViews.forEach((t=>t.update(e))),this._timeAxisViews.forEach((t=>t.update(e))))}updateAllViewsAndRedraw(e){this.updateAllViews(e),this._model.updateSource(this)}tags(){return[this.toolname]}properties(){return this._properties}restoreExternalPoints(e,t){if(this._timePoint=(0,h.deepCopy)(e.points),t.indexesChanged){if(this.properties().childs().interval.setValue(e.interval),!this.isActualSymbol())return this._clearServerPoints(),void this._normalizedPointsChanged.fire();this.createServerPoints()}else{const t=Math.min(this._points.length,e.points.length);for(let i=0;i<t;i++)this._points[i].price=e.points[i].price}this._normalizedPointsChanged.fire()}restoreExternalState(e){this.properties().mergeAndFire(e)}applyTemplate(e){this._onTemplateApplying.fire(e),this._applyTemplateImpl(e),
this.calcIsActualSymbol(),this.updateAllViews((0,L.sourceChangeEvent)(this.id())),this.model().lightUpdate(),this._onTemplateApplied.fire()}template(){return this.properties().preferences()}isFixed(){return!1}isLocked(){const e=this.properties().child("frozen");return void 0!==e&&e.value()}isSourceHidden(){return!this._properties.childs().visible.value()||(0,C.hideAllDrawings)().value()&&this.canBeHidden()||!this._isActualInterval||!this._isActualSymbol||!this._isActualCurrency||!this._isActualUnit}isSynchronizable(){return this.priceScale()===this._model.mainSeries().priceScale()}copiable(){return W}cloneable(){return null!==this._ownerSource&&null!==this._ownerSource.firstValue()}movable(){return!0}async getPropertyDefinitionsViewModel(){if(null===this._definitionsViewModel){const e=await this._getPropertyDefinitionsViewModelClass();return null===e||this._isDestroyed?null:(this._definitionsViewModel=new e(this._model.undoModel(),this),this._definitionsViewModel)}return this._definitionsViewModel}title(){return this.translatedType()}translatedType(){var e;return null!==(e=B.lineToolsLocalizedNames[this.toolname])&&void 0!==e?e:"Line Tool"}name(){return"Line Tool"}createServerPoints(){if(!this._isActualSymbol)return;if(!this._model.chartApi().isConnected().value())return;if(this._clearServerPoints(),this._model.timeScale().isEmpty())return;if(0===this._timePoint.length&&this._points.length>0&&this._normalizePoints(),!this._readyToCreatePointset())return;const e=this._pointsForPointset();if(0===e.length)return;++U,this._currentPointsetAndSymbolId={pointsetId:U,symbolId:(0,n.ensureNotNull)(this._model.mainSeries().seriesSource().symbolInstanceId())};const t=(0,w.getServerInterval)(this.properties().childs().interval.value());this._model.chartApi().createPointset(this._currentPointsetIdWithPrefix(),"turnaround",this._currentPointsetAndSymbolId.symbolId,t,e,this.onData.bind(this))}finish(){}realign(){var e;this.calcIsActualSymbol(),this.isFixed()||this.isSourceHidden()||this._model.lineBeingCreated()===this||this._model.lineBeingEdited()===this||(null===(e=this._currentPointsetAndSymbolId)||void 0===e?void 0:e.symbolId)===this._model.mainSeries().seriesSource().symbolInstanceId()||this._clearServerPoints(),null===this._model.mainSeries().symbolInfo()&&(this._alignerCache=null),this.updateAllViews((0,L.sourceChangeEvent)(this.id()))}stop(){this._clearServerPoints()}restart(){this.isFixed()||(this._currentPointsetAndSymbolId=null,this.createServerPoints())}isStarted(){return null!==this._currentPointsetAndSymbolId}convertYCoordinateToPriceForMoving(e,t){var i;const s=(0,n.ensureNotNull)(this.priceScale());if(s.isEmpty())return null;const r=this.ownerSource(),o=(0,n.ensure)(null===(i=r||t)||void 0===i?void 0:i.firstValue());return s.coordinateToPrice(e,o)}syncMultichartState(e){const t={points:this._timePoint,interval:this._model.mainSeries().interval()},i=this.linkKey().value();if(null!==i&&this.isSynchronizable()){const s={model:this._model,linkKey:i,symbol:this._model.mainSeries().symbol(),finalState:t,changes:e};(0,
C.finishChangingLineTool)(s)}}enableCurrentIntervalVisibility(){let e=this.properties().childs().intervalsVisibilities.state();void 0!==e&&(e=(0,b.mergeIntervalVisibilitiesDefaults)(e),(0,b.makeIntervalsVisibilitiesVisibleAtInterval)(e,this._model.mainSeries().intervalObj()),this.properties().childs().intervalsVisibilities.mergeAndFire(e))}clonePositionOffset(){return this.isFixed()?{barOffset:0,xCoordOffset:20,yCoordOffset:20}:{barOffset:0,xCoordOffset:0,yCoordOffset:-40}}sharingMode(){return this._sharingMode}share(e){this.isSynchronizable()&&this._sharingMode.setValue(e)}syncLineStyleState(){const e=this.properties().state(this._syncStateExclusions);return delete e.interval,e.intervalsVisibilities=(0,b.mergeIntervalVisibilitiesDefaults)(e.intervalsVisibilities),e}moveLineTool(e){const t=this._model.mainSeries().interval();e.forEach(((e,i)=>this._setPoint(i,{...e,interval:t}))),this._normalizePoints()}snapTo45DegreesAvailable(){return!1}alignTo45DegreesPoints(){if(this.snapTo45DegreesAvailable()){const[e,t]=this.points();if(e&&t)return[{...e,pointIndex:0},{...t,pointIndex:1}]}return null}snapPoint45Degree(e,t,i){const s=this._model.timeScale(),r=s.indexToCoordinate(t.index),o=s.indexToCoordinate(e.index)-r,a=(0,n.ensureNotNull)(this.priceScale()),l=t.price,d=e.price,u=(0,n.ensureNotNull)((0,n.ensureNotNull)(this.ownerSource()).firstValue()),h=a.priceToCoordinate(l,u),c=a.priceToCoordinate(d,u)-h,p=Math.round(Math.atan2(o,c)/Math.PI*4);if(2===Math.abs(p))i||(e.price=l);else if(0===Math.abs(p)||4===Math.abs(p))i||(e.index=t.index);else{const t=Math.sqrt(o*o+c*c),i=o<0?-1:1,n=c<0?-1:1;let l=Math.max(Math.abs(c),Math.abs(o));l/=l*Math.sqrt(2)/t;const d=Math.round(s.coordinateToIndex(r+l*i)),p=Math.abs(s.indexToCoordinate(d)-r),m=a.coordinateToPrice(h+p*n,u);e.index=d,e.price=m}}_pointsForPointset(){return this._timePoint.map((e=>e.interval?[e.time_t,e.offset,(0,w.getServerInterval)(e.interval)]:[e.time_t,e.offset]))}_setPoint(e,t){this._points[e]&&(this._points[e].index===t.index?this._points[e].price=t.price:this._points[e]=t,this._pointChanged.fire(e))}_correctLastPoint(e){return(0,c.clone)(e)}_snapTo45DegreesApplicable(e){return this.snapTo45DegreesAvailable()&&((null==e?void 0:e.shift())||(0,C.alignTo45Degrees)().value())}_normalizePoint(e,t){return{...this._model.timeScale().normalizeBarIndex(e.index),price:e.price,interval:e.interval}}_normalizePointWithoutOffset(e){var t;const i=null!==(t=this._model.timeScale().indexToTimePoint(e.index))&&void 0!==t?t:this._utcTimeInCurrentResolution(e);return null===i?null:{price:e.price,time_t:i,offset:0,interval:e.interval}}_normalizePoints(){let e=[];const t=this._model.mainSeries().interval();for(let i=0;i<this._points.length;i++)if(I.Interval.isEqual(this._points[i].interval,t)){if(void 0!==this._points[i].index){const t=this._normalizePoint(this._points[i],i);if(!t.time_t){e=[];break}e.push(t)}}else e.push({...this._timePoint[i],price:this._points[i].price});this._timePoint=e,this._normalizedPointsChanged.fire()}_getStartBarAligner(){
const e=this._model.mainSeries().interval();if(null===this._alignerCache||this._alignerCache.resolution!==this._model.mainSeries().interval()){const t=this._model.mainSeries().symbolInfo();if(!t)return null;this._alignerCache={resolution:e,aligner:(0,l.createTimeToBarTimeAligner)(e,t)}}return this._alignerCache.aligner}_utcTimeInCurrentResolution(e){if(void 0!==e.time){const t=this._model.timezoneExceptExchange().value();if(null!==t){const i=(0,d.cal_to_utc)((0,d.get_timezone)(t),new Date(1e3*e.time)),s=this._getStartBarAligner();return s?s(i)/1e3:null}}return null}_setPaneViews(e,t,i){if(this._isDestroyed)for(const t of e)t.destroy&&t.destroy();else this._paneViews.set(t,e),void 0!==t&&i&&t.onDestroyed().subscribe(this,(()=>this._destroyPanePaneViews(t))),this._model.lightUpdate()}_getPaneViews(e){return this._paneViews.get(e)||null}_updateAllPaneViews(e){this._paneViews.forEach((t=>{for(const i of t)i.update(e)}))}_alignPointHorizontallyOrVertically(e){const t=(0,n.ensureNotNull)(this.pointToScreenPoint(e)),i=(0,n.ensureDefined)((0,n.ensureNotNull)(this._startMovingPoint).logical),s=(0,n.ensureDefined)((0,n.ensureNotNull)(this._startMovingPoint).screen),r=Math.abs(s.x-t.x),o=Math.abs(s.y-t.y);if(r<10&&o<10)return e;return{index:r<o?i.index:e.index,price:r<o?e.price:i.price}}_alignScreenPointHorizontallyOrVertically(e){const t=(0,n.ensureDefined)((0,n.ensureNotNull)(this._startMovingPoint).screen),i=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return i<10&&r<10?e:i<r?new s.Point(t.x,e.y):new s.Point(e.x,t.y)}_correctPoints(e,t){var i,s,r,o;const a=(0,n.ensure)(null===(i=this._currentMovingPoint)||void 0===i?void 0:i.screen),l=(0,n.ensure)(null===(s=this._startMovingPoint)||void 0===s?void 0:s.screen),d=a.subtract(l);if(d.length()<1&&!t)return!1;const u=Math.round((0,n.ensure)(null===(r=this._currentMovingPoint)||void 0===r?void 0:r.logical).index-(0,n.ensure)(null===(o=this._startMovingPoint)||void 0===o?void 0:o.logical).index);for(const t of e){const e=(0,n.ensureNotNull)(this.pointToScreenPoint(t)).add(d);t.index=t.index+u,t.price=(0,n.ensureNotNull)(this.screenPointToPoint(e)).price}return!0}_correctFixedPoint(e){if(void 0===this._fixedPoint)return{didCorrect:!1,point:e};const t=(0,n.ensureDefined)((0,n.ensureNotNull)(this._currentMovingPoint).screen),i=(0,n.ensureDefined)((0,n.ensureNotNull)(this._startMovingPoint).screen),s=t.subtract(i);return s.length()>=1?{didCorrect:!0,point:e.add(s)}:{didCorrect:!1,point:e}}_currentPointsetIdWithPrefix(){return"pointset_"+(0,n.ensureNotNull)(this._currentPointsetAndSymbolId).pointsetId}_clearServerPoints(){null!==this._currentPointsetAndSymbolId&&this._model.chartApi().isConnected().value()&&this._model.chartApi().removePointset(this._currentPointsetIdWithPrefix()),this._currentPointsetAndSymbolId=null}_createPointProperty(e){const t=this._pointsProperty.childs().points;t.addProperty(""+e,{});const i=t[e];i.addChild("price",new V(this,e)),i.addChild("bar",new M.LineDataSourcePointIndexProperty(this,e))}_createPointsProperties(){this._pointsProperty=new T.Property,
this._pointsProperty.addChild("points",new T.Property);for(let e=0;e<this.pointsCount();e++)this._createPointProperty(e)}_alignPointToRangeOfActualData(e){const t=(0,n.ensureNotNull)(this._model.mainSeries().bars().firstIndex()),i=(0,n.ensureNotNull)(this._model.mainSeries().bars().lastIndex());let s=Math.max(e.index,t);return s=Math.min(s,i),{...e,index:s}}_migrateSymbolProperty(e){const t=this._properties.childs();if(t.symbolStateVersion.value()<2){const i=(0,n.ensureNotNull)(this.ownerSource()),s=(0,n.ensureNotNull)(i.symbolSource()),r=this._model.mainSeries();if(s===r)return void t.symbolStateVersion.setValueSilently(2);if(null===r.symbolInfo())return;if(null===s.symbolInfo())return;r.symbolSameAsCurrent(t.symbol.value())&&t.symbol.setValueSilently((0,x.extractLineToolSymbolFromSymbolInfo)(e,s.symbol())),t.symbolStateVersion.setValueSilently(2)}}_migrateZOrder(){const e=this._properties.childs();e.zOrderVersion.value()<2&&(this.ownerSource()===this.model().mainSeries()&&this.setZorder(this.zorder()-this.model().mainSeries().obsoleteZOrder()),e.zOrderVersion.setValueSilently(2))}_preparePoint(e,t){const i=e;return this._snapTo45DegreesApplicable(t)&&this.points().length>=2&&this.snapPoint45Degree(i,this.points()[this.points().length-2]),i}_addPointIntenal(e,t,i){this._points.push({...e,interval:this._model.mainSeries().interval()});const s=this._points.length===this.pointsCount();return s?(this._lastPoint=null,i||(this._normalizePoints(),this.createServerPoints())):this._lastPoint=e,this._pointAdded.fire(this._points.length-1),s}_onSourceHiddenMayChange(){this.isSourceHidden()&&this._model.selectionMacro((e=>{e.removeSourceFromSelection(this)})),this._model.invalidate(y.InvalidationMask.validateAction((()=>{this!==this._model.lineBeingCreated()&&(this._isDestroyed||this.processHibernate())})))}_saveAlertIdInState(){return!0}_onPointsetUpdated(e){var t;if(0===e.length)return;const i=this.properties().childs().interval.value();for(let s=0;s<e.length;s++){const n=e[s],r=this._timePoint[n.index],o={index:n.value[0],time:n.value[1],price:r.price,interval:null!==(t=r.interval)&&void 0!==t?t:i};this._points.length<=n.index?(this._points.push(o),this._pointAdded.fire(this._points.length-1)):(this._points[n.index]=o,this._pointChanged.fire(n.index))}{const e=this;e.recalculateStateByData&&e.recalculateStateByData()}this._onPointsetUpdatedDelegate.fire(),this.updateAllViewsAndRedraw((0,L.sourceChangeEvent)(this.id()))}_onMainSeriesSymbolResolved(){const e=this.ownerSource();null===e||this._model.mainSeries()===e.symbolSource()||this.isSourceHidden()||this.createServerPoints()}_readyToCreatePointset(){return this._timePoint.length>0}_propertiesStateExclusions(){return[]}_syncLineStyleIfNeeded(){const e=this.linkKey().value();!this._syncLineStyleMuted&&e&&(0,C.changeLineStyle)({linkKey:e,state:this.syncLineStyleState(),model:this._model})}_muteSyncLineStyle(){this._syncLineStyleMuted=!0}_unmuteSyncLineStyleWithoutApplyingChanges(){this.propertiesChanged(),this._syncLineStyleMuted=!1}_applyTemplateImpl(e){
e.intervalsVisibilities=(0,b.mergeIntervalVisibilitiesDefaults)(e.intervalsVisibilities);const t=this.properties();t.applyTemplate(e,(0,O.factoryDefaults)(this.toolname.toLowerCase())),t.saveDefaults(),this.propertiesChanged()}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_getAlertPlots(){return[]}_getUndoHistory(){return this._model.undoModel().undoHistory()}_synchronizeAlert(e){const t=this._getUndoHistory();if(!this._undoCheckpointAlert&&!this._alertUndoMode){const e=t.undoStack().pop();this._undoCheckpointAlert=t.createUndoCheckpoint(),e&&t.undoStack().push(e)}const i=e=>{const t=e.description()!==e.defaultDescription(),i=this._model.mainSeries().stateForAlert();e.startEditing(),e.isOHLC()&&i.actualSymbol===e.actualSymbol()&&e.setSeriesState(i),e.setMainSeriesState(i),e.setSymbol(i.symbolString);const s=(0,n.ensureNotNull)(this.stateForAlert());e.setResolution(s.interval),e.setLineState(s),t||e.resetToDefaultDescription(),e.finishEditing(),this._localAndServerAlertsMismatch=!0},s=()=>{this._alertUndoMode=!0,t.undoToCheckpoint((0,n.ensureDefined)(this._undoCheckpointAlert)),setTimeout((()=>{this._alertUndoMode=!1,this._localAndServerAlertsMismatch=!1}),0)},r=e=>{"not_exists"!==e&&(z.logError("Getting alert failed: "+e),s())},o=async e=>{(await(0,p.getChartAlertsFacade)()).restartAlert(e,{success:()=>this._localAndServerAlertsMismatch=!1,error:r,complete:()=>delete this._undoCheckpointAlert,actionSource:"drawing_sync"})};(0,m.canPlaceAlertOnResolution)(this.stateForAlert().interval)?this.getAlert().then((t=>{t?(i(t),e&&o(t)):z.logError("Failed to get alert, drawing and alert are not synchronized")})).catch(r):this._alertUndoMode||((0,_.showGoProAlertsOnSecondsDialog)(),s(),delete this._undoCheckpointAlert)}_linePointsToAlertPlot(e,t,i,s){if(2!==e.length)return z.logError("[Drawing Alert] Wrong points"),null;const r=this._model.timeScale();return!r||r.isEmpty()?null:{type:"LinePlot",title:t||this.translatedType(),timestamp:(0,n.ensureNotNull)(r.indexToTimePoint(0)),offset1:e[0].index,offset2:e[1].index,price1:e[0].price,price2:e[1].price,extendBackward:i||!1,extendForward:s||!1}}_getAlertCreationAvailable(){return g.alertsAvailable&&super._getAlertCreationAvailable()&&!this._areAlertsOnLineToolProhibited()&&!this._hasAlert.value()}static _configureProperties(e){if(this._addCollectedProperties(e),e.hasChild("symbolStateVersion")||e.addChild("symbolStateVersion",new T.Property(1)),e.hasChild("zOrderVersion")||e.addChild("zOrderVersion",new T.Property(1)),e.hasChild("visible")||e.addChild("visible",new T.Property(!0)),e.hasChild("frozen")||e.addChild("frozen",new T.Property(!1)),e.hasChild("symbol")||e.addChild("symbol",new T.Property("")),e.hasChild("currencyId")||e.addChild("currencyId",new T.Property(null)),e.hasChild("unitId")||e.addChild("unitId",new T.Property(null)),e.addExcludedKey("symbolStateVersion",1),e.addExcludedKey("zOrderVersion",1),e.addExcludedKey("visible",1),e.addExcludedKey("frozen",1),e.addExcludedKey("symbol",1),e.addExcludedKey("currencyId",1),e.addExcludedKey("unitId",1),
e.hasChild("intervalsVisibilities")){const t=(0,c.merge)((0,c.clone)(S.intervalsVisibilitiesDefaults),e.childs().intervalsVisibilities.state());e.removeProperty("intervalsVisibilities"),e.addChild("intervalsVisibilities",new A.IntervalsVisibilitiesProperty(t))}else e.addChild("intervalsVisibilities",new A.IntervalsVisibilitiesProperty(S.intervalsVisibilitiesDefaults));e.hasChild("title")||e.addChild("title",new T.Property("")),e.addExcludedKey("symbolInfo",1),e.addExcludedKey("points",1),e.addExcludedKey("interval",1),e.addExcludedKey("title",1),e.hasChild("singleChartOnly")&&e.removeProperty("singleChartOnly"),e.hasChild("font")&&e.removeProperty("font")}static _addCollectedProperties(e){e.hasChild("linewidth")&&e.addChild("linesWidths",new N.LineToolWidthsProperty([(0,n.ensureDefined)(e.child("linewidth"))])),e.hasChild("linecolor")&&e.addChild("linesColors",new N.LineToolColorsProperty([(0,n.ensureDefined)(e.child("linecolor"))])),e.hasChild("backgroundColor")&&e.addChild("backgroundsColors",new N.LineToolColorsProperty([(0,n.ensureDefined)(e.child("backgroundColor"))])),e.hasChild("textColor")&&e.addChild("textsColors",new N.LineToolColorsProperty([(0,n.ensureDefined)(e.child("textColor"))])),e.hasChild("linestyle")&&e.addChild("linesStyles",new N.LineToolCollectedProperty([(0,n.ensureDefined)(e.child("linestyle"))])),e.addExcludedKey("linesWidths",3),e.addExcludedKey("linesColors",3),e.addExcludedKey("backgroundsColors",3),e.addExcludedKey("textsColors",3),e.addExcludedKey("linesStyles",3)}_areAlertsOnLineToolProhibited(){return null!==this._ownerSource&&!this._ownerSource.canHasAlertOnLineTools()}_removeAlertSubscriptions(){var e;null===(e=this._unsubscribeAlertCallbacks)||void 0===e||e.call(this),this._unsubscribeAlertCallbacks=void 0}_addAlertSubscriptions(e,t={}){if(void 0!==this._unsubscribeAlertCallbacks)return;const i=this.properties().child("extendLeft"),s=this.properties().child("extendRight"),n=e.destroyed().spawn(),r=e.selected().spawn(),o=e.hovered().spawn(),a=e.active().spawn();a.subscribe((e=>this._alertStatus.setValue(e?2:3)),{callWithLast:!0}),n.subscribe(this.removeAlert.bind(this)),r.subscribe((e=>{this._model.selectionMacro((t=>{e?t.addSourceToSelection(this):t.removeSourceFromSelection(this)}))}),{callWithLast:t.syncFocusFromAlert}),o.subscribe((e=>{const t=this._model.hoveredSource();e&&t!==this?this._model.setHoveredSource(this,null):e||t!==this||this._model.setHoveredSource(null,null)})),void 0!==i&&i.subscribe(this,(()=>this.synchronizeAlert(!1))),void 0!==s&&s.subscribe(this,(()=>this.synchronizeAlert(!1))),this._unsubscribeAlertCallbacks=()=>{n.destroy(),o.destroy(),r.destroy(),a.destroy(),void 0!==i&&i.unsubscribeAll(this),void 0!==s&&s.unsubscribeAll(this)}}_destroyPanePaneViews(e){const t=this._paneViews.get(e);if(void 0!==t)for(const e of t)e.destroy&&e.destroy();void 0!==e&&e.onDestroyed().unsubscribeAll(this),this._paneViews.delete(e)}_copyPricesWithoutNormalization(){const e=Math.min(this._points.length,this._timePoint.length)
;for(let t=0;t<e;t++)this._timePoint[t].price=this._points[t].price}async _getChartAlert(){const e=await(0,p.getChartAlertsFacade)();return new Promise(((t,i)=>{e.getAlert((0,n.ensureDefined)(this._alertId),{success:t,error:i})}))}async _syncAlertWithAlertFacade(e={}){try{const t=await this.getAlert();if(!t)return;if(this._addAlertSubscriptions(t,e),e.syncAlertFocus){const e=this._model.selection().isSelected(this);t.setSelected(e)}}catch(e){if(e instanceof Error&&"not_exists"===e.message&&this.hasAlert().value()){this._alertStatus.setValue(0);return void(await(0,p.getChartAlertsFacade)()).removeAlertFromAllChartsSilently(this.id(),(0,n.ensureDefined)(this._alertId))}z.logError("Failed to set alert, alert will not be saved with drawing in chart")}}}},23666:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LineToolCollectedProperty:()=>u,LineToolColorsProperty:()=>c,LineToolMultiplePropertyBaseImpl:()=>d,LineToolWidthsProperty:()=>h,MultipleLineColorsProperty:()=>_,MultipleLineWidthsProperty:()=>m});var s=i(338619),n=i(942634),r=i(805578),o=i(485020);const a=(0,s.getLogger)("Chart.LineToolCollectedProperty");class l{applyValue(e,t){e.setValue(t)}}class d extends o.PropertyBase{constructor(e,t){super(),this._onChange=new n.Delegate,this._properties=e,e.forEach(((e,t)=>e.subscribe(this,((e,i)=>{this._onChange.fire(this,`${t}.${i}`)})))),this._showIfProperty=t}visible(){var e;return!this._showIfProperty||(null===(e=this._showIfProperty)||void 0===e?void 0:e.value())}value(){if(0===this._properties.length)return a.logError("Incorrect call, should not request value of 0 properties"),"mixed";const e=this._properties[0].value();return 1===this._properties.length||this._properties.every((t=>t.value()===e))?e:"mixed"}state(){}merge(){}destroy(){this._properties.forEach((e=>e.unsubscribeAll(this))),this._onChange.destroy()}subscribe(e,t){this._onChange.subscribe(e,t)}unsubscribe(e,t){this._onChange.unsubscribe(e,t)}unsubscribeAll(e){this._onChange.unsubscribeAll(e)}storeStateIfUndefined(){return!0}weakReference(){return(0,r.weakReference)(this)}ownership(){return(0,r.ownership)(this)}}class u extends d{setValue(e,t,i){if("mixed"===e)return;const s=null!=i?i:new l;this._properties.forEach((t=>s.applyValue(t,e)))}}class h extends u{}class c extends u{firstColor(){return this._properties[0].value()}}class p extends d{setValue(e,t,i){if("mixed"===e)return;const s=null!=i?i:new l;this._properties.forEach((t=>t.setValue(e,void 0,s)))}}class m extends p{}class _ extends p{}},850986:(e,t,i)=>{"use strict";i.d(t,{lineToolsStudyIds:()=>s});const s={LineToolAnchoredVWAP:"AnchoredVWAP@tv-basicstudies",LineToolRegressionTrend:"RegressionTrend@tv-basicstudies",LineToolFixedRangeVolumeProfile:"VbPFixed@tv-basicstudies",LineToolVbPFixed:"VbPFixed@tv-volumebyprice"};{const e={LineToolAnchoredVolumeProfile:"VbPAnchored@tv-basicstudies"};for(const[t,i]of Object.entries(e))s[t]=i}},609466:(e,t,i)=>{"use strict";i.d(t,{StudyLineDataSource:()=>y})
;var s=i(55243),n=i(929927),r=i(262624),o=i(637761),a=i(656723),l=i(218049),d=i(560047),u=i(281233),h=i(984217),c=i(971899),p=i(169532),m=i(757402),_=i(901110);class g extends _.StatusProviderBase{constructor(e){super(),this._source=e}errorStatus(){const e=this._source.status();return e.type===m.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:(0,m.studyStatusSolutionId)(e),title:(0,m.studyStatusTitle)(e),studyFeature:(0,m.studyStatusFeature)(e)}:null}getSplitTitle(){return this._source.titleInParts()}text(){return this._source.translatedType()}sourceStatusText(){return(0,m.convertStudyStatusToString)(this._source.status(),!0)}}var f=i(219849),v=i(629714);class y extends n.LineDataSource{constructor(e,t,s,n,r,o){super(e,n,r,o),this._indexes=null,this._inputs=null,this._definitionsViewModel=null,this._pointsetPoints=null,this._loadedPlots=null,this._loadedGraphics=null,this._beingCreatedPaneView=null,this._anchorsPaneView=null,this._isLegendDisplayed=!1,Promise.all([Promise.all([i.e(16969),i.e(22164),i.e(87393),i.e(52017),i.e(77916),i.e(90108),i.e(92384),i.e(19063),i.e(51583)]).then(i.bind(i,716005)),Promise.all([i.e(16969),i.e(22164),i.e(87393),i.e(52017),i.e(77916),i.e(90108),i.e(92384),i.e(19063),i.e(51583)]).then(i.bind(i,667359))]).then((t=>{const{LineToolBeingCreatedPaneView:i}=t[0],{StudyLineDataSourceAnchorsPaneView:s}=t[1];this._beingCreatedPaneView=new i(this,e),this._anchorsPaneView=new s(this,this.model()),this._model.lightUpdate()})),this._metaInfo=t,this._dataSource=new d.ExtendedStudyDataSource(e.chartApi(),e.mainSeries(),s,t),this._dataSource.dataCleared().subscribe(this,this._onDataCleared),this._dataSource.dataUpdated().subscribe(this,this._onDataUpdated),this._dataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._statusProvider=new g(this),this._statusView=new v.LineToolStudyStatusView(this),this._showStudyArgumentsProperty=e.properties().childs().paneProperties.childs().legendProperties.childs().showStudyArguments}isDisplayedInLegend(){return this._isLegendDisplayed}titleInParts(){const e=[];if(this._showStudyArgumentsProperty.value()&&this._inputs)for(const t of this._metaInfo.inputs){if(!0===t.isHidden||"bool"===t.type)continue;const i=this._inputs[t.id];e.push(i.toString())}return[this.name(),e]}destroy(){this._dataSource.dataUpdated().unsubscribeAll(this),this._dataSource.dataCleared().unsubscribeAll(this),this._dataSource.studyStatusChanged().unsubscribeAll(this),this._dataSource.destroy(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),this._unsubscribeApplyInputsOnSeriesCompleted(),this._isDestroyed=!0,super.destroy()}stop(){super.stop(),this._isDestroyed||(this._dataSource.stop(),this.clearData())}start(){super.start(),this._isDestroyed||null===this._inputs||this._dataSource.start()}metaInfo(){return this._metaInfo}graphicsInfo(){return this._metaInfo.graphics}series(){return this._model.mainSeries()}translatedType(){return this._metaInfo.description}name(){return this._metaInfo.description}
studyId(){return this._metaInfo.id}setPoint(e,t,i){super.setPoint(e,this._preparePoint(t,i))}move(e){}clearData(){this._clearAllDataExceptPointsetPoints(),this._pointsetPoints=null,this.updateAllViews((0,p.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),super.clearData()}data(){return this.plots()}plots(){return this._loadedPlots||this._dataSource.plots()}graphics(){return this._loadedGraphics||this._dataSource.graphics()}valueAt(e,t){var i,s;return null!==(s=null===(i=this.ownerSource())||void 0===i?void 0:i.symbolSource().valueAt(e,t))&&void 0!==s?s:null}firstValue(){return this._model.mainSeries().firstValue()}state(e){const t={...super.state(e),metaInfo:this.metaInfo().state()};return e&&(t.data=this.plots().state(),t.nonseriesindexes=this._indexes,t.graphics=(0,a.saveStudyGraphics)(this.graphics(),null)),t}restoreData(e){var t;void 0!==e.data&&(this._loadedPlots=new s.PlotList((0,h.studyPlotFunctionMap)(this._metaInfo),h.studyEmptyPlotValuePredicate),this._loadedPlots.restoreState(e.data)),this._indexes=null!==(t=e.nonseriesindexes)&&void 0!==t?t:this._indexes,this._loadedGraphics=e.graphics?(0,a.loadStudyGraphics)(e.graphics):this._loadedGraphics}getPropertyDefinitionsViewModel(){return null===this._definitionsViewModel?this._getPropertyDefinitionsViewModelClass().then((e=>null===e||this._isDestroyed?null:(null===this._definitionsViewModel&&(this._definitionsViewModel=new e(this._model.undoModel(),this)),this._definitionsViewModel))):Promise.resolve(this._definitionsViewModel)}paneViews(e){let t=[];if(this.isSourceHidden())return t;if(this._isReady()&&this._changeStatesStack.isEmpty()){const i=super.paneViews(e);null!==i&&(t=t.concat(i))}else null!==this._beingCreatedPaneView&&t.push(this._beingCreatedPaneView);return null!==this._anchorsPaneView&&t.push(this._anchorsPaneView),t}propertiesChanged(e){super.propertiesChanged(e),this._onStudyInputsMayChange()}dataAndViewsReady(){return super.dataAndViewsReady()&&this._isReady()}endChanging(e,t){const i=super.endChanging(e,t);return i.indexesChanged?this.clearData():this._updateAnchorsPrice(!0),i}moveData(e){this._dataSource.moveData(e)}restorePoints(e,t,i){super.restorePoints(e,t,i),this._updateAnchorsPrice(!0)}statusProvider(e){return this._statusProvider}statusView(){return this._statusView}legendView(){return null}dataProblemModel(){return null}dataUpdatedModeModel(){return null}marketStatusModel(){return null}onStatusChanged(){return this._dataSource.studyStatusChanged()}status(){return this._dataSource.studyStatus()}recalcStudyIfNeeded(){}static createPropertiesFromStudyMetaInfoAndState(e,t,i,s){const n=(0,c.prepareStudyPropertiesForLoadChart)(e,t,i,s);return this._configureProperties(n),n}_onStudyStatusChanged(e,t){let i;switch(t.type){case u.StudyStatusType.Error:i=!0;break;case u.StudyStatusType.Completed:i=!1;break;default:return}if(i===this._isLegendDisplayed)return;this._isLegendDisplayed=i;const s=this._model.paneForSource(this);if(s){const e=this._model.panes().indexOf(s),t=f.InvalidationMask.invalidateLegendWidgetLayout(e)
;this.model().invalidate(t)}}_studyId(){return this._dataSource.studyId()}_isReady(){return!0}_updateAllPaneViews(e){var t,i;super._updateAllPaneViews(e),null===(t=this._beingCreatedPaneView)||void 0===t||t.update(),null===(i=this._anchorsPaneView)||void 0===i||i.update(e)}_getPointTime(e,t){const i=e.index,s=this._model.timeScale().indexToTimePoint(i);return null!==s?s:t||void 0===e.time?null:this._utcTimeInCurrentResolution(e)}_updateAnchorsPrice(e){}_onPointsetUpdated(e){super._onPointsetUpdated(e),this._pointsetPoints=this._points.map((e=>({price:e.price,index:e.index,time:e.time}))),this._onStudyInputsMayChange()}_onDataCleared(){this.updateAllViews((0,p.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),this._model.updateSource(this)}_onDataUpdated(e,t,i){var s;this._updateAnchorsPrice(),this.updateAllViews((0,p.sourceChangeEvent)({sourceId:this.id(),firstUpdatedTimePointIndex:null===(s=e[0])||void 0===s?void 0:s.index})),this._model.updateSource(this)}_onStudyInputsMayChange(){let e=null;if(null!==this._pointsetPoints&&this._pointsetPoints.length===this.pointsCount()&&(e=this._studyInputs(this._pointsetPoints),null===e&&(this._clearAllDataExceptPointsetPoints(),this.updateAllViews((0,p.sourceChangeEvent)(this.id())))),null!==e){const t=this.metaInfo().inputs.map((e=>e.id)),i=Object.keys(e);for(const s of i)t.includes(s)||delete e[s]}this._areInputsEqual(this._inputs,e)||this._applyStudyInputs(e)}_preparePoint(e,t){return super._preparePoint(this._alignPointToRangeOfActualData(e),t)}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_subscribeApplyInputsOnSeriesCompleted(){this._unsubscribeApplyInputsOnSeriesCompleted(),this._model.mainSeries().dataEvents().completed().subscribe(this,(()=>this._onStudyInputsMayChange()),!0)}_unsubscribeApplyInputsOnSeriesCompleted(){this._model.mainSeries().dataEvents().completed().unsubscribeAll(this)}_onInputsChanged(){this.hasAlert().value()&&(this._localAndServerAlertsMismatch=!0)}_clearAllDataExceptPointsetPoints(){this._inputs=null,this._dataSource.clearData(),this._loadedPlots=null,this._indexes=null,this._loadedGraphics=null}static _createPropertiesFromStudyIdAndState(e,t){const i=o.StudyMetaInfo.getStudyPropertyRootNameById(e),s=new r.DefaultProperty({defaultName:i,state:t});return this._configureProperties(s),s}static _configureProperties(e){super._configureProperties(e),e.removeExcludedKey("intervalsVisibilities",1)}_areInputsEqual(e,t){return null===t?null===e:null!==e&&(0,l.areStudyInputsEqual)(this._metaInfo.inputs,e,t)}_applyStudyInputs(e){const t=this._inputs;this._inputs=e,null!==e&&(this._unsubscribeApplyInputsOnSeriesCompleted(),this._dataSource.setInputs(e),null===t&&this.isStarted()&&!this._dataSource.isStarted()&&this._dataSource.start()),this._onInputsChanged()}}},926799:(e,t,i)=>{"use strict";const s=i(929927).LineDataSource,n=i(631843).alignToStep,r=(i(339709).customFormatters,i(975179).createSeriesFormatter);class o extends s{constructor(e,t){super(e,t),this.customization.forcePriceAxisLabel=!0,
this.customization.disableErasing=!0,this.customization.showInObjectsTree=!1,this._createFormatter(e.mainSeries().symbolInfo()),this.setSelectionEnabled(!1)}isSynchronizable(){return!1}pointsCount(){return o.POINTS_COUNT}hasContextMenu(){return!1}state(){return null}startMoving(){super.startMoving.apply(this,arguments),this._cursorMoved=!1}endMoving(){super.endMoving.apply(this,arguments),this._cursorMoved=!1}userEditEnabled(){return!0}movable(){return!1}canBeHidden(){return!1}isUserDeletable(){return!1}showInObjectTree(){return!1}doesMovingAffectsUndo(){return!1}isAvailableInFloatingWidget(){return!1}timeAxisViews(){return null}cloneable(){return!1}copiable(){return!1}_correctPoints(e,t){this._currentMovingPoint&&this._startMovingPoint?this._currentMovingPoint.logical.price-this._startMovingPoint.logical.price&&(this._cursorMoved=!0):this._cursorMoved=!1;for(var i=1/this.priceScale().mainSource().base(),s=0;s<e.length;s++){var r=e[s];this._cursorMoved&&(r.price=this._currentMovingPoint.logical.price),r.price=n(r.price,i),e[s]=r}}_createFormatter(e){this._formatter=r(e,"default",!1,!0)}}o.POINTS_COUNT=1,e.exports.LineToolTrading=o},169532:(e,t,i)=>{"use strict";i.d(t,{globalChangeEvent:()=>o,selectionChangeEvent:()=>u,sourceChangeEvent:()=>n,viewportChangeEvent:()=>l});var s=i(283873);function n(e){return(0,s.default)(e)?{type:"data-source-change",sourceId:e}:{type:"data-source-change",...e}}const r={type:"global-change"};function o(){return r}const a={type:"viewport-change"};function l(e){return e?{type:"viewport-change",pane:e}:a}const d={type:"selection-change"};function u(){return d}},86e3:(e,t,i)=>{"use strict";var s;i.d(t,{PaneCursorType:()=>s}),function(e){e[e.Default=0]="Default",e[e.Pointer=1]="Pointer",e[e.Eraser=2]="Eraser",e[e.Dot=3]="Dot",e[e.Grabbing=4]="Grabbing",e[e.ZoomIn=5]="ZoomIn",e[e.VerticalResize=6]="VerticalResize",e[e.HorizontalResize=7]="HorizontalResize",e[e.DiagonalNeSwResize=8]="DiagonalNeSwResize",e[e.DiagonalNwSeResize=9]="DiagonalNwSeResize",e[e.Text=10]="Text"}(s||(s={}))},55243:(e,t,i)=>{"use strict";i.d(t,{PlotList:()=>c,mergeMinMax:()=>p});var s=i(650151),n=i(828473),r=i(501571),o=i(338619),a=i(518439);const l=(0,o.getLogger)("Chart.PlotList"),d=30;function u(e){return e.index}function h(e){return e.value[0]}class c{constructor(e=null,t=null){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache=new Map,this._rowSearchCacheByIndex=new Map,this._rowSearchCacheByIndexWithoutEmptyValues=new Map,this._rowSearchCacheByTime=new Map,this._rowSearchCacheByTimeWithoutEmptyValues=new Map,this._plotFunctions=e||new Map,this._emptyValuePredicate=t}clear(){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache.clear(),this._invalidateSearchCaches()}first(){return this.size()>0?this._items[this._start]:null}last(){return this.size()>0?this._items[this._end-1]:null}firstIndex(){return this.size()>0?this._indexAt(this._start):null}lastIndex(){return this.size()>0?this._indexAt(this._end-1):null}clone(){const e=this.firstIndex(),t=this.lastIndex()
;return null===e||null===t?new c:this.range(e,t)}size(){return this._end-this._start}isEmpty(){return 0===this.size()}contains(e){return null!==this.search(e,a.PlotRowSearchMode.Exact)}valueAt(e){const t=this.search(e);return null!==t?t.value:null}add(e,t){if(this._shareRead)return l.logDebug("add: readonly collection modification attempt"),!1;const i={index:e,value:t},s=this._nonCachedSearch(e,a.PlotRowSearchMode.Exact,u);return this._invalidateSearchCaches(),null===s?(this._items.splice(this._lowerbound(e,u),0,i),this._start=0,this._end=this._items.length,!0):(this._items[s]=i,!1)}search(e,t=a.PlotRowSearchMode.Exact,i){return this._searchImpl(e,t,this._rowSearchCacheByIndex,this._rowSearchCacheByIndexWithoutEmptyValues,u,i)}searchByTime(e,t=a.PlotRowSearchMode.Exact,i){return this._searchImpl(e,t,this._rowSearchCacheByTime,this._rowSearchCacheByTimeWithoutEmptyValues,h,i)}fold(e,t){let i=t;for(let t=this._start;t<this._end;++t){i=e(this._indexAt(t),this._valueAt(t),i)}return i}findFirst(e,t){const i=void 0!==t&&Math.min(this._start+t,this._end)||this._end;for(let t=this._start;t<i;++t){const i=this._indexAt(t),s=this._valueAt(t);if(e(i,s))return{index:i,value:s}}return null}findLast(e,t){const i=void 0!==t&&Math.max(this._end-t,this._start)||this._start;for(let t=this._end-1;t>=i;--t){const i=this._indexAt(t),s=this._valueAt(t);if(e(i,s))return{index:i,value:s}}return null}each(e){for(let t=this._start;t<this._end;++t){if(e(this._indexAt(t),this._valueAt(t)))break}}reduce(e,t){let i=t;for(let t=this._start;t<this._end;++t){i=e(i,this._indexAt(t),this._valueAt(t))}return i}range(e,t){const i=new c(this._plotFunctions,this._emptyValuePredicate);return i._items=this._items,i._start=this._lowerbound(e,u),i._end=this._upperbound(t),i._shareRead=!0,i}plottableRange(e){const t=new c(this._plotFunctions,this._emptyValuePredicate);return t._items=this._items,t._start=this._upperbound(r.UNPLOTTABLE_TIME_POINT_INDEX),t._end=this._end,t._shareRead=!0,!0===e&&t._start>this._start&&(t._start-=1),t}rangeCountback(e,t){if(null===this.firstIndex())return new c;const i=new c(this._plotFunctions,this._emptyValuePredicate);return i._items=this._items,i._end=this._upperbound(e),i._start=Math.max(this._start,i._end-t),i._shareRead=!0,i}rangeIterator(e,t){const i=this._lowerbound(e,u),s=this._upperbound(t);return this._rangeIteratorImpl(i,s)}fullRangeIterator(){return this._rangeIteratorImpl(this._start,this._end)}minMaxOnRangeCached(e,t,i){if(this.isEmpty())return null;let s=null;for(const n of i){s=p(s,this._minMaxOnRangeCachedImpl(e-n.offset,t-n.offset,n.name))}return s}minMaxOnRange(e,t,i){if(this.isEmpty())return null;let s=null;for(const n of i){s=p(s,this._minMaxOnRange(e-n.offset,t-n.offset,n.name))}return s}merge(e){return this._shareRead?(l.logDebug("merge: readonly collection modification attempt"),
null):0===e.length?null:this.isEmpty()||e[e.length-1].index<this._items[0].index?this._prepend(e):e[0].index>this._items[this._items.length-1].index?this._append(e):1===e.length&&e[0].index===this._items[this._items.length-1].index?(this._updateLast(e[0]),e[0]):this._merge(e)}addTail(e,t=!1){if(0===e.length)return;let i=0;t&&this._end-this._start>0&&(i=1,this._items[this._end-this._start-1].value=e[0].value);for(let t=i;t<e.length;++t){const i=e[t],s=this.lastIndex();if(null===s){l.logError("Can't add tail to the empty plotlist");break}this.add(s+1,i.value)}this._invalidateSearchCaches()}move(e){if(this._shareRead)return void l.logDebug("move: readonly collection modification attempt");if(0===e.length)return;const t=this._items.slice();for(const i of e){const e=this._bsearch(i.old,u);if(null!==e&&void 0!==t[e])if(i.new===r.INVALID_TIME_POINT_INDEX)t[e]=void 0;else{t[e]={index:i.new,value:t[e].value};const s=this._bsearch(i.new,u);if(null!==s){const e=t[s];void 0!==e&&e.index===i.new&&(t[s]=void 0)}}}this._items=t.filter((e=>void 0!==e)).sort(((e,t)=>e.index-t.index)),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._start=0,this._end=this._items.length}remove(e){if(this._shareRead)return l.logDebug("remove: readonly collection modification attempt"),null;const t=this._nonCachedSearch(e,a.PlotRowSearchMode.NearestRight,u);if(null===t)return null;const i=this._items.splice(t);return this._end=this._items.length,this._minMaxCache.clear(),this._invalidateSearchCaches(),i.length>0?i[0]:null}state(){const e=this._items.slice(this._start,this._end);return{start:0,end:e.length,data:e}}restoreState(e){e?(this._start=e.start,this._end=e.end,this._shareRead=!1,this._items=e.data,this._minMaxCache.clear(),this._invalidateSearchCaches()):this.clear()}_indexAt(e){return this._items[e].index}_valueAt(e){return this._items[e].value}_length(){return this._items.length}_searchImpl(e,t,i,s,n,r){const o=void 0!==r?i:s,a=void 0!==r?1e4*(t+1)+r:t;let l=o.get(e);if(void 0!==l){const e=l.get(a);if(void 0!==e)return e}const d=this._nonCachedSearch(e,t,n,r);if(null===d)return null;const u={index:this._indexAt(d),value:this._valueAt(d)};return void 0===l&&(l=new Map,o.set(e,l)),l.set(a,u),u}_nonCachedSearch(e,t,i,s){const n=this._lowerbound(e,i),r=n===this._end||e!==i(this._items[n]);if(r&&t!==a.PlotRowSearchMode.Exact)switch(t){case a.PlotRowSearchMode.NearestLeft:return this._searchNearestLeft(n,s);case a.PlotRowSearchMode.NearestRight:return this._searchNearestRight(n,s);default:throw new TypeError("Unknown search mode")}if(void 0===s||r||t===a.PlotRowSearchMode.Exact)return r?null:n;switch(t){case a.PlotRowSearchMode.NearestLeft:return this._nonEmptyNearestLeft(n,s);case a.PlotRowSearchMode.NearestRight:return this._nonEmptyNearestRight(n,s);default:throw new TypeError("Unknown search mode")}}_nonEmptyNearestRight(e,t){const i=(0,s.ensure)(this._emptyValuePredicate),n=(0,s.ensure)(t);for(;e<this._end&&i(this._valueAt(e),n);)e+=1;return e===this._end?null:e}_nonEmptyNearestLeft(e,t){const i=(0,
s.ensureNotNull)(this._emptyValuePredicate),n=(0,s.ensure)(t);for(;e>=this._start&&i(this._valueAt(e),n);)e-=1;return e<this._start?null:e}_searchNearestLeft(e,t){if(e===this._start)return null;const i=e-1,s=i!==this._end?i:null;return void 0!==t&&null!==s?this._nonEmptyNearestLeft(s,t):s}_searchNearestRight(e,t){const i=e,s=i!==this._end?i:null;return void 0!==t&&null!==s?this._nonEmptyNearestRight(s,t):s}_bsearch(e,t){const i=this._lowerbound(e,t);return i!==this._end&&e===t(this._items[i])?i:null}_lowerbound(e,t){return(0,n.lowerbound)(this._items,e,((e,i)=>t(e)<i),this._start,this._end)}_upperbound(e){return(0,n.upperbound)(this._items,e,((e,t)=>t.index>e),this._start,this._end)}_plotMinMax(e,t,i){let s=null;const n=this._plotFunctions.get(i);if(void 0===n)throw new Error(`Plot "${i}" is not registered`);for(let i=e;i<t;i++){const e=n(this._items[i].value);null==e||Number.isNaN(e)||(null===s?s={min:e,max:e}:(e<s.min&&(s.min=e),e>s.max&&(s.max=e)))}return s}_invalidateCacheForRow(e){const t=Math.floor(e.index/d);this._minMaxCache.forEach((e=>e.delete(t)))}_prepend(e){return(0,s.assert)(!this._shareRead,"collection should not be readonly"),(0,s.assert)(0!==e.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=e.concat(this._items),this._start=0,this._end=this._items.length,e[0]}_append(e){return(0,s.assert)(!this._shareRead,"collection should not be readonly"),(0,s.assert)(0!==e.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=this._items.concat(e),this._start=0,this._end=this._items.length,e[0]}_updateLast(e){(0,s.assert)(!this.isEmpty(),"plot list should not be empty");const t=this._items[this._end-1];(0,s.assert)(t.index===e.index,"last row index should match new row index"),this._invalidateCacheForRow(e),this._invalidateSearchCaches(),this._items[this._end-1]=e}_merge(e){return(0,s.assert)(0!==e.length,"plot rows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=function(e,t){const i=function(e,t){const i=e.length,s=t.length;let n=i+s,r=0,o=0;for(;r<i&&o<s;)e[r].index<t[o].index?r++:e[r].index>t[o].index?o++:(r++,o++,n--);return n}(e,t),s=new Array(i);let n=0,r=0;const o=e.length,a=t.length;let l=0;for(;n<o&&r<a;)e[n].index<t[r].index?(s[l]=e[n],n++):e[n].index>t[r].index?(s[l]=t[r],r++):(s[l]=t[r],n++,r++),l++;for(;n<o;)s[l]=e[n],n++,l++;for(;r<a;)s[l]=t[r],r++,l++;return s}(this._items,e),this._start=0,this._end=this._items.length,e[0]}_minMaxOnRangeCachedImpl(e,t,i){if(this.isEmpty())return null;let n=null;const r=(0,s.ensureNotNull)(this.firstIndex()),o=(0,s.ensureNotNull)(this.lastIndex()),a=Math.max(e,r),l=Math.min(t,o),u=Math.ceil(a/d)*d,h=Math.max(u,Math.floor(l/d)*d);n=p(n,this._minMaxOnRange(a,Math.min(u,t,l),i));let c=this._minMaxCache.get(i);void 0===c&&(c=new Map,this._minMaxCache.set(i,c));for(let e=Math.max(u+1,a);e<h;e+=d){const t=Math.floor(e/d);let s=c.get(t);if(void 0===s){const e=t*d,n=(t+1)*d-1;s=this._minMaxOnRange(e,n,i),c.set(t,s)}
n=p(n,s)}n=p(n,this._minMaxOnRange(h,l,i));return n}_minMaxOnRange(e,t,i){return this._plotMinMax(this._lowerbound(e,u),this._upperbound(t),i)}_rangeIteratorImpl(e,t){let i=e-1;return{[Symbol.iterator](){return this},next:()=>(i+=1,i>=t?{done:!0,value:void 0}:{done:!1,value:this._items[i]})}}_invalidateSearchCaches(){this._rowSearchCacheByIndex.clear(),this._rowSearchCacheByIndexWithoutEmptyValues.clear(),this._rowSearchCacheByTime.clear(),this._rowSearchCacheByTimeWithoutEmptyValues.clear()}}function p(e,t){if(null===e)return t;if(null===t)return e;return{min:Math.min(e.min,t.min),max:Math.max(e.max,t.max)}}},347808:(e,t,i)=>{"use strict";i.d(t,{PriceAxisView:()=>r});var s=i(968720),n=i(432059);class r{constructor(e){this._commonRendererData={coordinate:0,textColor:"#FFF",background:"#000",additionalPaddingBottom:0,additionalPaddingTop:0},this._axisRendererData={text:"",visible:!1,separatorVisible:!0,borderVisible:!1,ignoreAdditionalPaddingInner:!1},this._paneRendererData={text:"",visible:!1,separatorVisible:!1,borderVisible:!1,ignoreAdditionalPaddingInner:!0},this._invalidated=!0,this._active=!1,this._axisRenderer=new(e||s.PriceAxisViewRenderer)(this._axisRendererData,this._commonRendererData),this._paneRenderer=new(e||s.PriceAxisViewRenderer)(this._paneRendererData,this._commonRendererData)}setActive(e){this._active=e}text(){return this._updateRendererDataIfNeeded(),this._axisRendererData.text}secondLineText(){return this._updateRendererDataIfNeeded(),this._axisRendererData.secondLine}thirdLineText(){return this._updateRendererDataIfNeeded(),this._axisRendererData.thirdLine}background(){return this._updateRendererDataIfNeeded(),this._commonRendererData.background}color(){return this._updateRendererDataIfNeeded(),this.generateTextColor(this.background())}generateTextColor(e){return(0,n.colorFromBackground)(e)}coordinate(){return this._updateRendererDataIfNeeded(),this._commonRendererData.coordinate}floatCoordinate(){var e;return this._updateRendererDataIfNeeded(),null!==(e=this._commonRendererData.floatCoordinate)&&void 0!==e?e:this._commonRendererData.coordinate}update(e){this._invalidated=!0}topBottomTotalHeight(e){this._updateRendererDataIfNeeded();const{top:t,bottom:i,total:s}=this._axisRenderer.topBottomTotalHeight(e),{top:n,bottom:r,total:o}=this._paneRenderer.topBottomTotalHeight(e);return{top:Math.max(t,n),bottom:Math.max(i,r),total:Math.max(s,o)}}getFixedCoordinate(){return this._commonRendererData.fixedCoordinate||0}setFixedCoordinate(e){this._commonRendererData.fixedCoordinate=e}isVisible(){return this._updateRendererDataIfNeeded(),this._axisRendererData.visible||this._paneRendererData.visible}isAxisLabelVisible(){return this._updateRendererDataIfNeeded(),this._axisRendererData.visible}isPaneLabelVisible(){return this._updateRendererDataIfNeeded(),this._paneRendererData.visible}renderer(){return this._updateRendererDataIfNeeded(),this._axisRenderer}paneRenderer(){return this._updateRendererDataIfNeeded(),this._paneRenderer}setPaneRendererLabelIcon(e){this._paneRendererData.labelIcon=e}
setPaneLabelVisible(e){this._paneRendererData.visible=e,this._invalidated=!0}ignoreAlignment(){return!1}_updateRendererDataIfNeeded(){this._invalidated&&(this._commonRendererData.fixedCoordinate=void 0,this._updateRendererData(this._axisRendererData,this._paneRendererData,this._commonRendererData),this._invalidated=!1)}}},941654:(e,t,i)=>{"use strict";i.d(t,{isRootPath:()=>a,propertyByPath:()=>o,propertyPathForSource:()=>n});var s=i(650151);function n(e,t="properties"){return`charts.${e.model().id()}.sources.${e.id()}.${t}`}function r(e,t){if(t.length<4)throw new Error("Invalid chart path");const i=function(e,t){return(0,s.ensureDefined)(e.getAll().find((e=>e.hasModel()&&e.model().model().id()===t))).model().model()}(e,t[0]),n=t[1];if("sources"===n){return(0,s.ensureNotNull)(i.dataSourceForId(t[2])).propertyByPath(t.slice(3).join("."))}throw new Error(`Invalid chart path, unknown root: ${n}`)}function o(e,t){const i=t.split(".");if(i.length<1)throw new Error("Invalid path");const s=i[0];if("charts"===s)return r(e,i.slice(1));throw new Error(`Invalid path, unknown root: ${s}`)}function a(e){return e.startsWith("charts.")}},203918:(e,t,i)=>{"use strict";i.d(t,{createWVFromGetterAndSubscriptions:()=>n});var s=i(375397);function n(e,t){const i=new s.WatchedValue(e()),n={};t.forEach((t=>t.subscribe(n,(()=>{i.setValue(e())}))));return i.readonly().spawn((()=>t.forEach((e=>e.unsubscribeAll(n)))))}},658843:(e,t,i)=>{"use strict";i.d(t,{Property:()=>c});var s=i(569708),n=i(283873),r=i(683350),o=i(688987),a=i(650151),l=i(942634),d=i(805578),u=i(485020);function h(e){return null===e||(0,s.default)(e)&&Number.isFinite(e)||(0,n.default)(e)||(0,r.default)(e)}class c extends u.PropertyBase{constructor(e){if(super(),this._listeners=new l.Delegate,this._muteChildChanges=!1,this._childs=[],this._dependents=[],void 0!==e)if(h(e))this._value=e;else for(const[t,i]of Object.entries(e))this.addProperty(t,i)}destroy(){var e,t;this.listeners().destroy();for(const i of this._childs)null===(t=null===(e=this.child(i))||void 0===e?void 0:e.destroy)||void 0===t||t.call(e)}merge(e,t){let i=null,s=0;if(t&&(i=[],s=i.length),void 0===e)return i;if(h(e))return this._value!==e&&(null==i||i.push(this)),this._value=e,i;if(Array.isArray(e))for(let s=0;s<e.length;s++){const n=this.childs()[s];if(n){const r=n.merge(e[s],t);null==i||i.push(...r)}else{const t=this.addProperty(`${s}`,e[s]);null==i||i.push(t)}}else for(const[s,n]of Object.entries(e)){const e=this.childs()[s];if(e){const s=e.merge(n,t);null==i||i.push(...s)}else{const e=this.addProperty(s,n);null==i||i.push(e)}}return i&&i.length>s&&i.push(this),i}mergeAndFire(e){const t=(0,a.ensureNotNull)(this.merge(e,!0));this._muteChildChanges=!0;for(const e of t)e._muteChildChanges=!0;for(const e of t)e._muteChildChanges=!1,e.listeners().fire(e,"");this._muteChildChanges=!1,t.length>0&&this.listeners().fire(this,"")}state(e){let t=(0,o.default)(this.value)?this.value():void 0;if(void 0!==t)return t;t={};for(const i of this._childs){if(e&&-1!==e.indexOf(i))continue;const s=this.childs()[i];let n;if(e){
const t=[];for(const s of e)s.startsWith(i+".")&&t.push(s.substring(i.length+1));n=null==s?void 0:s.state(t)}else n=null==s?void 0:s.state();(void 0!==n||(null==s?void 0:s.storeStateIfUndefined()))&&(t[i]=n)}return t}clone(){return new c(this.state())}value(){return this._value}listeners(){return this._listeners}childCount(){return this._childs.length}childNames(){return this._childs}child(e){if(this.hasChild(e))return this.childs()[e]}childByPath(e){let t=this;for(const i of e.split(".")){if(void 0===t)break;t=t.child(i)}return t}hasChild(e){return this._childs.includes(e)}setValue(e,t){(this._value!==e||t)&&(this._value=e,this._listeners.fire(this,""))}setValueSilently(e){this._value=e}addProperty(e,t){this.removeProperty(e);const i=new c(t);return this[e]=i,this._childs.push(e),i.subscribe(this,((t,i)=>this.childChanged(t,i?`${e}.${i}`:e))),i.setOwner(this),i.setNameInOwner(e),i}removeProperty(e){const t=this.child(e);t&&(t.setNameInOwner(""),t.setOwner(null),t.unsubscribeAll(this),delete this[e],this._childs=this._childs.filter((t=>t!==e)))}addChild(e,t){this[e]&&this.removeProperty(e),this[e]=t,-1===this._childs.indexOf(e)&&this._childs.push(e),t.subscribe(this,((t,i)=>this.childChanged(t,i?`${e}.${i}`:e))),t.setOwner(this),t.setNameInOwner(e)}childChanged(e,t){this._muteChildChanges||this._listeners.fire(this,t)}subscribe(e,t){this.listeners().subscribe(e,t,!1)}unsubscribe(e,t){this.listeners().unsubscribe(e,t)}unsubscribeAll(e){this.listeners().unsubscribeAll(e)}childs(){return this}storeStateIfUndefined(){return!0}ownership(){return(0,d.ownership)(this)}weakReference(){return(0,d.weakReference)(this)}addDependent(e){this._dependents.push(e)}removeDependent(e){const t=this._dependents.indexOf(e);t>=0&&this._dependents.splice(t,1)}dependents(){return this._dependents}}},526910:(e,t,i)=>{"use strict";TradingView.TIME_PLOT=0,TradingView.OPEN_PLOT=1,TradingView.HIGH_PLOT=2,TradingView.LOW_PLOT=3,TradingView.CLOSE_PLOT=4,TradingView.ADT_PLOT=6;var s=i(16508).SeriesBase,n=i(540519);class r extends s{}Object.assign(r,n),TradingView.Series=r,t.Series=r,t.isSeries=function(e){return e instanceof r}},971899:(e,t,i)=>{"use strict";i.d(t,{prepareStudyProperties:()=>S,prepareStudyPropertiesForLoadChart:()=>g});var s=i(998034),n=i(130551),r=i(338619),o=i(637761),a=i(124829),l=i(666574),d=i(211183),u=i(500323),h=i(985429),c=i(262624),p=i(389276),m=i(748947);const _=(0,r.getLogger)("Chart.Study");function g(e,t,i,n,r){return function(e,t,i,n,r,l){const u=function(e,t,i,n,r){var l;e.version&&i.version&&e.version!==i.version&&_.logWarn("Serialized metaInfo version "+e.version+" is not equal to the saved state version "+i.version);const u=t||e,h=null!==(l=(0,a.clone)(u.defaults))&&void 0!==l?l:{},c=o.StudyMetaInfo.getStudyPropertyRootName(u),p=o.StudyMetaInfo.getStudyPropertyRootName(e);let m=v();(0,s.default)(m,f(e)),(0,s.default)(m,(0,a.clone)(e.defaults)),(0,s.default)(m,h),(0,s.default)(m,(0,d.factoryDefaults)(c)),(0,s.default)(m,(0,d.factoryDefaults)(p)),(0,s.default)(m,y(u,n,c)),(0,s.default)(m,y(e,n,p)),(0,
s.default)(m,i),m=n.updateStudyState(m,e,t),void 0!==r&&t&&(m=r(i,m,e,t));o.StudyMetaInfo.versionOf(u)>=1&&(0,s.default)(m,w(h,m));return m}(e,t,i,n,l);return P(t||e,r,u)}(e,t,i,n,o.StudyMetaInfo.getStudyPropertyRootName(e),r)}function f(e){const t={};if(e.plots)for(let i=0;i<e.plots.length;i++){const s=e.plots[i],n=s.id;if((0,m.isColorerPlot)(s))continue;const r={display:15,color:"#0496FF",linestyle:l.LINESTYLE_SOLID,linewidth:2,plottype:m.LineStudyPlotStyle.Line,trackPrice:!1};(0,m.isBarColorerPlot)(s)&&(r.transparency=0),r.plottype=s.type,r.title=n,t[n]=r}return{styles:t}}function v(){const e=(0,a.clone)((0,d.defaults)("study"));return e.intervalsVisibilities=(0,a.clone)(h.intervalsVisibilitiesDefaults),e}function y(e,t,i){let s=(0,a.clone)((0,d.defaults)(i,t));return"Overlay"!==e.shortId&&"Compare"!==e.shortId||(s.currencyId=null,s.unitId=null),e.isTVScript&&e.TVScriptSourceCode!==s.TVScriptSourceCode&&(s=(0,a.clone)((0,d.factoryDefaults)(i))),s}function w(e,t){var i;const s={};return u.StudyVersioning.mergeInputsObjPart(s,null!==(i=e.inputs)&&void 0!==i?i:{}),u.StudyVersioning.mergeInputsObjPart(s,t.inputs),{inputs:s}}function b(e,t,i,r){var l;if(o.StudyMetaInfo.versionOf(e)<1)throw new Error("This function cannot work with metainfo of the old format version. Required format version >= 1");const u=o.StudyMetaInfo.getStudyPropertyRootName(e),h=(0,a.clone)(e.defaults),c=v();if((0,s.default)(c,f(e)),(0,s.default)(c,h),(0,s.default)(c,(0,d.factoryDefaults)(u)),(0,s.default)(c,y(e,r,u)),(0,s.default)(c,t),(0,s.default)(c,w(h,c)),null!==i){const t=i.model().studiesColorRotatorFactory().getColorRotator(e);null!==t&&("Overlay@tv-basicstudies"===e.id?c.lineStyle.color=t.getColor(c.lineStyle.color):(0,s.default)(c,function(e,t){for(const i of Object.keys(e.styles)){const s=e.styles[i];if((0,n.isObject)(s)&&"color"in s){const e=s.color;s.color=t.getColor(e)}}return e}(c,t)))}return r.updateStudyInputsIfNeeded(c,null!==(l=c.version)&&void 0!==l?l:e.version,e),c}function S(e,t,i,s,n){return function(e,t,i,s,n,r){const l=b(e,t,i,s);return o.StudyMetaInfo.getSourceInputIds(e).forEach(((e,t)=>{const i=l.inputs[e];t<r.length?l.inputs[e]=`${r[t].id()}$0`:(0,a.isString)(i)&&i.includes("$")&&(l.inputs[e]="close")})),P(e,n,l)}(e,t,i,s,o.StudyMetaInfo.getStudyPropertyRootName(e),n)}const x=["id","description","description_localized","shortDescription","_metainfoVersion","is_price_study","is_hidden_study","priceScale","fullId","shortId","scriptIdPart","packageId","productId","isTVScriptStub","defaults","symbolSource","historyCalculationMayChange","format","linkedToSeries","isTVLibrary","docs","exports","exportTypes","extra","usesPrivateLib","financialPeriod","groupingKey","pine","isRGB","isTVScript","TVScriptMetaInfoExprs","usePlotsZOrder","isTVScriptStrategy","TVScriptSourceCode","lookaheadFutureData","hasAlertFunction","defaultStrategyAlertMessage","tags","canBeChild","canNotBeChild","_serverMetaInfoVersion","warnings"];function P(e,t,i){var s;for(const e of x)delete i[e]
;const n=["visible","precision","minTick","intervalsVisibilities","inputs.first_visible_bar_time","inputs.last_visible_bar_time","inputs.subscribeRealtime"];for(let t=0;t<e.inputs.length;++t){const i=e.inputs[t];i.isHidden&&(n.push(`inputs.${t}`),n.push(`inputs.${i.id}`))}const r=new c.DefaultProperty({defaultName:t,state:i,excludedDefaultsKeys:n,excludedStateKeys:["version"]});r.removeProperty("intervalsVisibilities"),r.addChild("intervalsVisibilities",new p.IntervalsVisibilitiesProperty(i&&i.intervalsVisibilities)),"PivotPointsStandard@tv-basicstudies"!==e.id&&"PivotPointsHighLow@tv-basicstudies"!==e.id||!r.hasChild("font")||r.removeProperty("font");const a=o.StudyMetaInfo.versionOf(e);return r.hasChild("version")?null===(s=r.childs().version)||void 0===s||s.setValue(a):r.addProperty("version",a),r}},560047:(e,t,i)=>{"use strict";i.d(t,{ExtendedStudyDataSource:()=>r});var s=i(700087),n=i(757402);class r extends s.StudyDataSource{constructor(e,t,i,s){super(e,t.seriesSource(),i,s),this._series=t}_createStudyError(e){var t;return(0,n.createStudyError)(this._getStudyErrorDescription(e),null===(t=this._series.symbolInfo())||void 0===t?void 0:t.exchange)}}},759214:(e,t,i)=>{"use strict";i.d(t,{containsBackgroundTimePointIndexes:()=>o,dematerializeBackground:()=>l,isBackgroundInBarsRange:()=>d,materializeBackground:()=>a});var s=i(650151),n=i(501571),r=i(585240);const o=!0;function a(e,t){if(e.start>=t.length||e.stop>=t.length)return null;const i=t[e.start],r=t[e.stop];return r===n.INVALID_TIME_POINT_INDEX?null:((0,s.assert)(i===n.INVALID_TIME_POINT_INDEX||i<=r,"start should not exceed stop"),{start:i===n.INVALID_TIME_POINT_INDEX?null:i,stop:r})}function l(e,t,i){return{id:t,start:(0,r.ensureTimePointIndexIndex)(i.indexOf(null!==e.start?e.start:n.INVALID_TIME_POINT_INDEX)),stop:(0,r.ensureTimePointIndexIndex)(i.indexOf(e.stop))}}function d(e,t){if(null===e.start)return t.firstBar()<=e.stop;const i=Math.min(e.start,e.stop),s=Math.max(e.start,e.stop);return t.contains(i)||t.contains(s)||i<t.firstBar()&&s>t.lastBar()}},18613:(e,t,i)=>{"use strict";i.d(t,{DwgBoxFontType:()=>r,DwgBoxStyle:()=>s,containsDwgBoxTimePointIndexes:()=>d,dematerializeDwgBox:()=>h,isDwgBoxInBarsRange:()=>c,materializeDwgBox:()=>u});var s,n,r,o=i(501571),a=i(585240),l=i(597461);!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.LeftArrow="al",e.RightArrow="ar",e.BothArrow="ab"}(s||(s={})),function(e){e.Top="top",e.Center="center",e.Bottom="bottom"}(n||(n={})),function(e){e.Monospace="monospace"}(r||(r={}));const d=!0;function u(e,t){var i,s;if(e.x1>=t.length||e.x2>=t.length||null===e.y1||null===e.y2)return null;let n=t[e.x1],r=t[e.x2];return n===o.INVALID_TIME_POINT_INDEX&&(n=null),r===o.INVALID_TIME_POINT_INDEX&&(r=null),{left:n,right:r,top:e.y1,bottom:e.y2,borderColorIndex:e.c,backgroundColorIndex:e.bc,extend:e.ex,borderStyle:e.st,borderWidth:e.w,text:e.t,wordWrap:e.tw,horizontalTextAlignment:e.tha,verticalTextAlignment:e.tva,fontSize:e.ts,textColorIndex:null!==(i=e.tc)&&void 0!==i?i:null,fontType:null!==(s=e.tf)&&void 0!==s?s:null,
forceOverlay:e.fo}}function h(e,t,i){var s,n,r;return{id:t,x1:(0,a.ensureTimePointIndexIndex)(i.indexOf(null!==(s=e.left)&&void 0!==s?s:o.INVALID_TIME_POINT_INDEX)),x2:(0,a.ensureTimePointIndexIndex)(i.indexOf(null!==(n=e.right)&&void 0!==n?n:o.INVALID_TIME_POINT_INDEX)),y1:e.top,y2:e.bottom,c:e.borderColorIndex,bc:e.backgroundColorIndex,ex:e.extend,st:e.borderStyle,w:e.borderWidth,t:e.text,tw:e.wordWrap,tha:e.horizontalTextAlignment,tva:e.verticalTextAlignment,ts:e.fontSize,tf:null!==(r=e.fontType)&&void 0!==r?r:void 0,tc:e.textColorIndex,fo:e.forceOverlay}}function c(e,t){const i=e.extend;if(i===l.DwgExtend.Both)return null===e.left||null===e.right;if(null===e.left||null===e.right)return null!==e.right?e.right<=t.lastBar()&&i===l.DwgExtend.Right:null!==e.left&&(e.left>=t.firstBar()&&i===l.DwgExtend.Left);const s=Math.min(e.left,e.right),n=Math.max(e.left,e.right);if(t.contains(s)||t.contains(n)||s<t.firstBar()&&n>t.lastBar())return!0;const r=e.left<e.right?e.extend===l.DwgExtend.Left:e.extend===l.DwgExtend.Right,o=e.left<e.right?e.extend===l.DwgExtend.Right:e.extend===l.DwgExtend.Left;return n<t.firstBar()&&o||s>t.lastBar()&&r}},597461:(e,t,i)=>{"use strict";i.d(t,{DwgExtend:()=>s,convertPointsToScreenDimension:()=>a,doesItemAffectVisibleRange:()=>l,isExtendInSameDirection:()=>o});var s,n=i(650151);function r(e,t){return e===s.None?t:t===s.None?e:e===s.Both||t===s.Both?s.Both:e===t?t:s.Both}function o(e,t){return e===s.Both||e===t}function a(e,t,i,o,a,l,d,u,h,c){let p,m;if(null===e&&null===i){if(a!==s.Right&&a!==s.Both)return null;a=s.Both,p=0,m=u}else null===e?(p=d.indexToCoordinate((0,n.ensureNotNull)(i)-1),a=r(a,s.Left)):p=d.indexToCoordinate(e),null===i?(m=d.indexToCoordinate((0,n.ensureNotNull)(e)-1),a=r(a,s.Right)):m=d.indexToCoordinate(i);const _=p,g=l.priceToCoordinate(t,h),f=m,v=l.priceToCoordinate(o,h);return void 0!==c?(c.x1=_,c.y1=g,c.x2=f,c.y2=v,c.extend=a,c):{x1:_,y1:g,x2:f,y2:v,extend:a}}function l(e,t,i,n,r){let o=!1;switch(i){case s.Both:o=!0;break;case s.Right:o=null===t||null===e||e<=r;break;case s.Left:o=null===t||t>=n;break;default:null!==e&&null!==t?o=(e>=n||t>=n)&&(e<=r||t<=r):null!==e&&null===t?o=e<=r:null===e&&null!==t&&(o=t>=n)}return o}!function(e){e.None="n",e.Left="l",e.Right="r",e.Both="b"}(s||(s={}))},15141:(e,t,i)=>{"use strict";i.d(t,{DwgLabelStyle:()=>r,DwgLabelTextAlign:()=>s,DwgLabelYloc:()=>n,containsDwgLabelTimePointIndexes:()=>d,dematerializeDwgLabel:()=>h,isDwgLabelInBarsRange:()=>c,materializeDwgLabel:()=>u});var s,n,r,o,a=i(501571),l=i(585240);!function(e){e.Left="left",e.Center="center",e.Right="right"}(s||(s={})),function(e){e.AboveBar="ab",e.BelowBar="bl",e.Price="pr",e.Auto="auto"}(n||(n={})),function(e){e.Xcross="xcr",e.Cross="cr",e.Triangleup="tup",e.Triangledown="tdn",e.Flag="flg",e.Circle="cir",e.Arrowup="aup",e.Arrowdown="adn",e.LabelUp="lup",e.LabelDown="ldn",e.LabelLeft="llf",e.LabelRight="lrg",e.LabelCenter="lcn",e.LabelLeftUp="luplf",e.LabelLeftDown="llwlf",e.LabelRightUp="luprg",e.LabelRightDown="llwrg",e.Square="sq",e.Diamond="dia",e.TextOutline="to",
e.None="n"}(r||(r={})),function(e){e.Monospace="monospace"}(o||(o={}));const d=!0;function u(e,t){var i;if(e.x>=t.length)return null;const n=t[e.x];return n===a.INVALID_TIME_POINT_INDEX?null:{x:n,y:e.y,yloc:e.yl,text:e.t,style:e.st,size:e.sz,colorIndex:e.ci,textColorIndex:e.tci,textAlign:e.ta||s.Center,tooltip:e.tt||"",fontType:null!==(i=e.tf)&&void 0!==i?i:null,forceOverlay:e.fo}}function h(e,t,i){var s;return{id:t,x:(0,l.ensureTimePointIndexIndex)(i.indexOf(e.x)),y:e.y,yl:e.yloc,t:e.text,st:e.style,sz:e.size,ci:e.colorIndex,tci:e.textColorIndex,ta:e.textAlign,tt:e.tooltip,tf:null!==(s=e.fontType)&&void 0!==s?s:void 0,fo:e.forceOverlay}}function c(e,t){return t.contains(e.x)}},276507:(e,t,i)=>{"use strict";i.d(t,{containsDwgLineFillTimePointIndexes:()=>s,dematerializeDwgLineFill:()=>r,materializeDwgLineFill:()=>n});const s=!1;function n(e){return{id:e.id,line1:e.line1,line2:e.line2,colorIndex:e.ci}}function r(e,t){return{id:t,line1:e.line1,line2:e.line2,ci:e.colorIndex}}},164937:(e,t,i)=>{"use strict";i.d(t,{DwgLineStyle:()=>s,containsDwgLineTimePointIndexes:()=>a,dematerializeDwgLine:()=>d,isDwgLineInBarsRange:()=>u,materializeDwgLine:()=>l});var s,n=i(501571),r=i(585240),o=i(597461);!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.LeftArrow="al",e.RightArrow="ar",e.BothArrow="ab"}(s||(s={}));const a=!0;function l(e,t){if(e.x1>=t.length||e.x2>=t.length||null===e.y1||null===e.y2)return null;let i=t[e.x1],s=t[e.x2];return i===n.INVALID_TIME_POINT_INDEX&&(i=null),s===n.INVALID_TIME_POINT_INDEX&&(s=null),null!==i&&null!==s||e.y1===e.y2?{id:e.id,x1:i,y1:e.y1,x2:s,y2:e.y2,style:e.st,extend:e.ex,width:e.w,colorIndex:e.ci,forceOverlay:e.fo}:null}function d(e,t,i){var s,o;const a=(0,r.ensureTimePointIndexIndex)(i.indexOf(null!==(s=e.x1)&&void 0!==s?s:n.INVALID_TIME_POINT_INDEX)),l=(0,r.ensureTimePointIndexIndex)(i.indexOf(null!==(o=e.x2)&&void 0!==o?o:n.INVALID_TIME_POINT_INDEX));return{id:t,x1:a,y1:e.y1,x2:l,y2:e.y2,st:e.style,ex:e.extend,w:e.width,ci:e.colorIndex,fo:e.forceOverlay}}function u(e,t){const i=e.extend;if(i===o.DwgExtend.Both)return!0;if(null===e.x1||null===e.x2)return null!==e.x2?e.x2<=t.lastBar()&&i===o.DwgExtend.Right:null!==e.x1&&(e.x1>=t.firstBar()&&i===o.DwgExtend.Left);const s=Math.min(e.x1,e.x2),n=Math.max(e.x1,e.x2);if(t.contains(s)||t.contains(n)||s<t.firstBar()&&n>t.lastBar())return!0;const r=e.x1<e.x2?e.extend===o.DwgExtend.Left:e.extend===o.DwgExtend.Right,a=e.x1<e.x2?e.extend===o.DwgExtend.Right:e.extend===o.DwgExtend.Left;return n<t.firstBar()&&a||s>t.lastBar()&&r}},551789:(e,t,i)=>{"use strict";i.d(t,{DwgPolylineStyle:()=>o,containsDwgPolylineTimePointIndexes:()=>r,dematerializeDwgPolyline:()=>l,isDwgPolylineInBarsRange:()=>d,materializeDwgPolyline:()=>a});var s=i(585240),n=i(501571);const r=!0;var o;function a(e,t){const i=[];for(const s of e.points){if(s.x>=t.length)continue;const e=t[s.x];e!==n.INVALID_TIME_POINT_INDEX&&i.push({x:e,y:s.y})}return 0===i.length?null:{id:e.id,points:i,width:e.w,curved:e.crv,closed:e.cls,color:e.c,fillColor:e.fc,style:e.st,forceOverlay:e.fo}}
function l(e,t,i){return{id:t,points:e.points.map((e=>{var t;return{x:(0,s.ensureTimePointIndexIndex)(i.indexOf(null!==(t=e.x)&&void 0!==t?t:n.INVALID_TIME_POINT_INDEX)),y:e.y}})),w:e.width,crv:e.curved,cls:e.closed,c:e.color,fc:e.fillColor,st:e.style,fo:e.forceOverlay}}function d(e,t){if(0===e.points.length)return!1;const i=t.firstBar(),s=t.lastBar();let n=!1,r=!1;for(const o of e.points){if(t.contains(o.x))return!0;if(o.x<i?n=!0:o.x>s&&(r=!0),n&&r)return!0}return!1}!function(e){e.Solid="sol",e.Dotted="dot",e.Dashed="dsh",e.ArrowLeft="al",e.ArrowRight="ar",e.ArrowBoth="ab"}(o||(o={}))},817959:(e,t,i)=>{"use strict";var s,n;i.d(t,{DwgTableCellFontType:()=>n,containsDwgTableCellTimePointIndexes:()=>l,containsDwgTableTimePointIndexes:()=>r,dematerializeDwgTable:()=>a,dematerializeDwgTableCell:()=>u,materializeDwgTable:()=>o,materializeDwgTableCell:()=>d}),function(e){e.Top="top",e.Center="center",e.Bottom="bottom"}(s||(s={})),function(e){e.Monospace="monospace"}(n||(n={}));const r=!1;function o(e,t){return{id:e.id,position:e.pos,rows:e.rows,columns:e.cols,backgroundColorIndex:e.bgc,frameColorIndex:e.frmc,frameWidth:e.frmw,borderColorIndex:e.brdc,borderWidth:e.brdw,forceOverlay:e.fo}}function a(e,t,i){return{id:t,pos:e.position,rows:e.rows,cols:e.columns,bgc:e.backgroundColorIndex,frmc:e.frameColorIndex,frmw:e.frameWidth,brdc:e.borderColorIndex,brdw:e.borderWidth,fo:e.forceOverlay}}const l=!1;function d(e,t){var i,s,n;return{tableId:e.tid,row:e.row,column:e.col,widthInPercentsOfPaneWidth:e.w,heightInPercentOfPaneHeight:e.h,text:e.t,textColorIndex:e.tc,horizontalTextAlignment:e.tha,verticalTextAlignment:e.tva,fontSize:e.ts,backgroundColorIndex:e.bgc,colSpan:null!==(i=e.colspan)&&void 0!==i?i:1,rowSpan:null!==(s=e.rowspan)&&void 0!==s?s:1,tooltip:e.tt,fontType:null!==(n=e.tf)&&void 0!==n?n:null}}function u(e,t,i){var s;return{id:t,tid:e.tableId,row:e.row,col:e.column,w:e.widthInPercentsOfPaneWidth,h:e.heightInPercentOfPaneHeight,t:e.text,tc:e.textColorIndex,tha:e.horizontalTextAlignment,tva:e.verticalTextAlignment,ts:e.fontSize,bgc:e.backgroundColorIndex,colspan:e.colSpan,rowspan:e.rowSpan,tt:e.tooltip,tf:null!==(s=e.fontType)&&void 0!==s?s:void 0}}},656723:(e,t,i)=>{"use strict";i.d(t,{LiveStudyGraphics:()=>o.LiveStudyGraphics,createGraphicsPaneViews:()=>p,createGraphicsPriceAxisViews:()=>_,emptyStudyGraphics:()=>r.emptyStudyGraphics,isStudyGraphicsEmpty:()=>n.isStudyGraphicsEmpty,loadStudyGraphics:()=>r.loadStudyGraphics,saveStudyGraphics:()=>r.saveStudyGraphics});var s=i(338619),n=i(355468),r=i(515821),o=i(444468),a=i(347808),l=i(432059);class d extends a.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t}_updateRendererData(e,t,i){var s,n;e.visible=!1;const r=this._source.priceScale(),o=this._source.properties().childs(),a=o.visible.value();if(!r||r.isEmpty()||!a)return;const d=null===(n=null===(s=o.graphics.childs()[this._data.lineType])||void 0===s?void 0:s.childs()[this._data.styleId])||void 0===n?void 0:n.childs()
;if(!(void 0!==d&&d.visible&&d.visible.value()&&d.showPrice&&d.showPrice.value()&&this._isLabelVisibleAccordinglyToProperties()))return;const u=this._source.firstValue();if(null===u)return;const h=this._data.line.level,c=(0,l.resetTransparency)(d.color.value());i.background=c,i.textColor=this.generateTextColor(c),i.coordinate=r.priceToCoordinate(h,u),e.text=r.formatPrice(h,u,{signPositive:r.isPercentage()}),e.visible=!0}_isLabelVisibleAccordinglyToProperties(){const e=this._source.model().properties().childs().scalesProperties.childs();return(e.showStudyLastValue.value()||e.showFundamentalLastValue.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()}}const u=(0,s.getLogger)("Chart.StudyGraphics"),h=new Set(["dwgtablecells","tpoBlockSets","tpoLevels","tpoVolumeRows","logs","performance"]);async function c(e,t,s,n){const r=e=>({regularPaneView:new e(t,s,n)}),o=e=>({regularPaneView:new e(t,s,!1,n),forceOverlayPaneView:new e(t,s,!0,n)});switch(e){case"hlines":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,600458))).LevelPaneView);case"lines":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,565165))).LinePaneView);case"shapemarks":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,515128))).ShapeMarkPaneView);case"textmarks":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,326750))).TextMarkPaneView);case"trendchannels":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,122466))).TrendChannelPaneView);case"dwglabels":return o((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,497861))).DwgLabelPaneView);case"dwglines":return o((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,542435))).DwgLinePaneView);case"dwgpolylines":return o((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,230123))).DwgPolylinePaneView);case"dwgboxes":return o((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,801028))).DwgBoxPaneView);case"dwgtables":return o((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,492080))).DwgTablePaneView);case"dwglinefills":return o((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,700885))).DwgLineFillPaneView);case"tpos":return{regularPaneView:new((await Promise.all([i.e(8331),i.e(92013),i.e(88509),i.e(89052),i.e(10640),i.e(19024),i.e(93255),i.e(769)]).then(i.bind(i,372061))).TpoPaneView)(t,s,n)};case"footprints":return{regularPaneView:new((await Promise.all([i.e(80977),i.e(9141)]).then(i.bind(i,5261))).VolumeFootprintPaneView)(t,s)}}switch(e){case"hhists":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,266096))).HHistPaneView);case"horizlines":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,72450))).HorizLinePaneView);case"vertlines":
return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,785805))).VertLinePaneView);case"polygons":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,900940))).PolygonPaneView);case"backgrounds":return r((await Promise.all([i.e(77916),i.e(88509),i.e(19063),i.e(20507)]).then(i.bind(i,342792))).BackgroundPaneView)}return null}async function p(e,t,i){const s=[],n=[],r=Object.keys(e.graphicsInfo());r.sort(((e,t)=>m(e)-m(t)));for(const o of r){const r=await c(o,e,t,i);null!==r?(s.push(r.regularPaneView),r.forceOverlayPaneView&&n.push(r.forceOverlayPaneView)):h.has(o)||u.logWarn(`${o} is not supported by this build of graphics subsystem, skipping`)}return{regularPaneViews:s,forceOverlayPaneViews:n}}function m(e){var t;return null!==(t=n.primitivesZOrders.get(e))&&void 0!==t?t:0}function _(e){const t=Object.keys(e.graphicsInfo()),i=[];for(const s of t)switch(s){case"hlines":e.graphics().hlines().forEach(((t,n)=>{t.forEach((t=>{void 0!==t.level&&i.push(new d(e,{line:{level:t.level},styleId:n,lineType:s}))}))}));break;case"horizlines":e.graphics().horizlines().forEach(((t,n)=>{t.forEach((t=>{void 0!==t.level&&i.push(new d(e,{line:{level:t.level},styleId:n,lineType:s}))}))}))}return i}},307801:(e,t,i)=>{"use strict";i.d(t,{HHistDirection:()=>o.HHistDirection,HHistLocation:()=>o.HHistLocation,HHistVolumeMode:()=>o.HHistVolumeMode,containsHHistTimePointIndexes:()=>a,dematerializeHHist:()=>d,isHHistInBarsRange:()=>u,materializeHHist:()=>l});var s=i(650151),n=i(501571),r=i(585240),o=i(577916);const a=!0;function l(e,t){if(e.firstBarTime>=t.length||e.lastBarTime>=t.length)return null;const i=t[e.firstBarTime],r=t[e.lastBarTime];return i===n.INVALID_TIME_POINT_INDEX||r===n.INVALID_TIME_POINT_INDEX?null:((0,s.assert)(i<=r,"firstBarTime should not exceed lastBarTime"),(0,s.assert)(e.priceLow<=e.priceHigh,"priceLow should not exceed priceHigh"),{firstBarTime:i,lastBarTime:r,rate:e.rate,priceHigh:e.priceHigh,priceLow:e.priceLow})}function d(e,t,i){const s=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.firstBarTime)),n=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.lastBarTime));return{id:t,...e,firstBarTime:s,lastBarTime:n}}function u(e,t){const i=Math.min(e.firstBarTime,e.lastBarTime),s=Math.max(e.firstBarTime,e.lastBarTime);return t.contains(i)||t.contains(s)||i<t.firstBar()&&s>t.lastBar()}},224621:(e,t,i)=>{"use strict";i.d(t,{containsHorizLineTimePointIndexes:()=>o,dematerializeHorizLine:()=>l,isHorizLineInBarsRange:()=>d,materializeHorizLine:()=>a});var s=i(650151),n=i(501571),r=i(585240);const o=!0;function a(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],r=t[e.endIndex];return i===n.INVALID_TIME_POINT_INDEX||r===n.INVALID_TIME_POINT_INDEX?null:((0,s.assert)(i<=r,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:r,level:e.level,extendLeft:e.extendLeft,extendRight:e.extendRight})}function l(e,t,i){const s=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),n=(0,
r.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:s,endIndex:n}}function d(e,t){const i=Math.min(e.startIndex,e.endIndex),s=Math.max(e.startIndex,e.endIndex);if(t.contains(i)||t.contains(s)||i<t.firstBar()&&s>t.lastBar())return!0;const n=e.startIndex<e.endIndex?e.extendLeft:e.extendRight,r=e.startIndex<e.endIndex?e.extendRight:e.extendLeft;return s<t.firstBar()&&r||i>t.lastBar()&&n}},951586:(e,t,i)=>{"use strict";var s;i.d(t,{TextPos:()=>s,containsLevelTimePointIndexes:()=>n,dematerializeLevel:()=>o,materializeLevel:()=>r}),function(e){e[e.TopLeft=0]="TopLeft",e[e.TopCenter=1]="TopCenter",e[e.TopRight=2]="TopRight",e[e.MiddleLeft=3]="MiddleLeft",e[e.MiddleCenter=4]="MiddleCenter",e[e.MiddleRight=5]="MiddleRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomCenter=7]="BottomCenter",e[e.BottomRight=8]="BottomRight"}(s||(s={}));const n=!1;function r(e){return{level:e.level,text:e.text}}function o(e,t,i){return{id:t,...e}}},649420:(e,t,i)=>{"use strict";i.d(t,{containsLineTimePointIndexes:()=>o,dematerializeLine:()=>l,isLineInBarsRange:()=>d,materializeLine:()=>a});var s=i(650151),n=i(501571),r=i(585240);const o=!0;function a(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],r=t[e.endIndex];return i===n.INVALID_TIME_POINT_INDEX||r===n.INVALID_TIME_POINT_INDEX?null:((0,s.assert)(i<=r,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:r,startOffset:e.startOffset,endOffset:e.endOffset,startPrice:e.startPrice,endPrice:e.endPrice})}function l(e,t,i){const s=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),n=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:s,endIndex:n}}function d(e,t){var i,s;const n=e.startIndex+(null!==(i=e.startOffset)&&void 0!==i?i:0),r=e.endIndex+(null!==(s=e.endOffset)&&void 0!==s?s:0),o=Math.min(n,r),a=Math.max(n,r);return t.contains(n)||t.contains(r)||o<t.firstBar()&&a>t.lastBar()}},444468:(e,t,i)=>{"use strict";i.d(t,{LiveStudyGraphics:()=>k});var s=i(650151),n=i(828473),r=i(942634),o=i(307801),a=i(224621),l=i(267439),d=i(239041),u=i(759214),h=i(15141),c=i(164937),p=i(551789),m=i(18613),_=i(951586),g=i(649420),f=i(521854),v=i(968632),y=i(323070),w=i(817959),b=i(276507),S=i(892686),x=i(487027),P=i(399890),I=i(73239),T=i(130551);function C(e){const t=JSON.parse(e.pp);var i;return(0,s.assert)("s"in(i=t)&&(0,T.isObject)(i.s)&&"l"in i.s&&"c"in i.s&&"e"in i&&(0,T.isObject)(i.e)&&"l"in i.e&&"c"in i.e,"unexpected log source"),{barTime:e.t,time:e.tms,level:e.ll,source:{start:{line:t.s.l,column:t.s.c},end:{line:t.e.l,column:t.e.c}},message:e.m}}function E(e){return{lines:e.l,time:e.t,invocations:e.c}}function A(e){return{total:e.total,profile:e.profile.map(E)}}var L=i(255866),D=i(408582),M=i(355468),V=i(515821);class k{constructor(e={}){this._indexes=[],this._hhistsByTimePointIndex=new Map,this._primitivesCollection=function(e){const t={};for(const i of M.primitiveNames){t[i]=new Map;const s=e[i];if(void 0!==s)for(const e in s)if(s.hasOwnProperty(e))switch(i){case"horizlines":
t[i].set(e,W.horizlines());break;case"vertlines":t[i].set(e,W.vertlines());break;case"lines":t[i].set(e,W.lines());break;case"hlines":t[i].set(e,W.hlines());break;case"textmarks":t[i].set(e,W.textmarks());break;case"shapemarks":t[i].set(e,W.shapemarks());break;case"backgrounds":t[i].set(e,W.backgrounds());break;case"polygons":t[i].set(e,W.polygons());break;case"trendchannels":t[i].set(e,W.trendchannels());break;case"hhists":t[i].set(e,W.hhists());break;case"dwglabels":case"dwglines":case"dwgpolylines":case"dwgboxes":case"dwgtables":case"tpoBlockSets":case"tpoLevels":case"tpoVolumeRows":t[i].set(e,new Map);break;case"dwgtablecells":t[i].set(e,W.dwgtablecells());break;case"dwglinefills":t[i].set(e,W.dwglinefills());break;case"tpos":t[i].set(e,W.tpos());break;case"logs":t[i].set(e,W.logs());break;case"footprints":t[i].set(e,W.footprints());break;case"footprintLevels":t[i].set(e,W.footprintLevels())}}t.performance.set("performance",new R(A,false));return t}(e)}horizlines(){return this._primitivesCollection.horizlines}vertlines(){return this._primitivesCollection.vertlines}lines(){return this._primitivesCollection.lines}hlines(){return this._primitivesCollection.hlines}textmarks(){return this._primitivesCollection.textmarks}shapemarks(){return this._primitivesCollection.shapemarks}backgrounds(){return this._primitivesCollection.backgrounds}polygons(){return this._primitivesCollection.polygons}trendchannels(){return this._primitivesCollection.trendchannels}hhists(){return this._primitivesCollection.hhists}dwglabels(){return this._primitivesCollection.dwglabels}dwglines(){return this._primitivesCollection.dwglines}dwgpolylines(){return this._primitivesCollection.dwgpolylines}dwgboxes(){return this._primitivesCollection.dwgboxes}dwgtables(){return this._primitivesCollection.dwgtables}dwgtablecells(){return this._primitivesCollection.dwgtablecells}dwglinefills(){return this._primitivesCollection.dwglinefills}tpos(){return this._primitivesCollection.tpos}tpoBlockSets(){return this._primitivesCollection.tpoBlockSets}tpoLevels(){return this._primitivesCollection.tpoLevels}tpoVolumeRows(){return this._primitivesCollection.tpoVolumeRows}logs(){return this._primitivesCollection.logs}observableLogs(){return this._primitivesCollection.logs}performance(){return this._primitivesCollection.performance}observablePerformance(){return this._primitivesCollection.performance}footprints(){return this._primitivesCollection.footprints}footprintLevels(){return this._primitivesCollection.footprintLevels}hhistsByTimePointIndex(){return this._hhistsByTimePointIndex}clear(){this._indexes=[];for(const e of M.regularPrimitiveNames)this._primitivesCollection[e].forEach((e=>e.clear()));for(const e of M.groupedPrimitiveNames)this._primitivesCollection[e].forEach((e=>{e.forEach((e=>e.clear()))}));this._hhistsByTimePointIndex=new Map}extract(){const e={indexes:this._indexes,horizlines:B(this._primitivesCollection.horizlines),vertlines:B(this._primitivesCollection.vertlines),lines:B(this._primitivesCollection.lines),
hlines:B(this._primitivesCollection.hlines),textmarks:B(this._primitivesCollection.textmarks),shapemarks:B(this._primitivesCollection.shapemarks),backgrounds:B(this._primitivesCollection.backgrounds),polygons:B(this._primitivesCollection.polygons),trendchannels:B(this._primitivesCollection.trendchannels),hhists:B(this._primitivesCollection.hhists),dwglabels:O(this._primitivesCollection.dwglabels),dwglines:O(this._primitivesCollection.dwglines),dwgpolylines:O(this._primitivesCollection.dwgpolylines),dwgboxes:O(this._primitivesCollection.dwgboxes),dwgtables:O(this._primitivesCollection.dwgtables),dwgtablecells:B(this._primitivesCollection.dwgtablecells),dwglinefills:B(this._primitivesCollection.dwglinefills),tpos:B(this._primitivesCollection.tpos),tpoBlockSets:O(this._primitivesCollection.tpoBlockSets),tpoLevels:O(this._primitivesCollection.tpoLevels),tpoVolumeRows:O(this._primitivesCollection.tpoVolumeRows),logs:new Map,performance:new Map,footprints:B(this._primitivesCollection.footprints),footprintLevels:B(this._primitivesCollection.footprintLevels)};return this._hhistsByTimePointIndex=new Map,new V.StaticStudyGraphics("data",e)}replaceIndexesTo(e){this._indexes=e;const t=e=>e.replaceIndexesTo(this._indexes);for(const e of M.regularPrimitiveNames)this._primitivesCollection[e].forEach(t);for(const e of M.groupedPrimitiveNames)this._primitivesCollection[e].forEach((e=>{e.forEach(t)}));this._hhistsByTimePointIndex=(0,M.splitHHistsByTimePointIndex)(this._primitivesCollection.hhists)}processCommands(e){void 0!==e.erase&&this._processEraseCommands(e.erase),void 0!==e.create&&this._processCreateCommands(e.create)}_processCreateCommands(e){for(const t in e){if(!e.hasOwnProperty(t))continue;const i=t;switch(i){case"horizlines":F(this._indexes,this._primitivesCollection.horizlines,e[i]);break;case"vertlines":F(this._indexes,this._primitivesCollection.vertlines,e[i]);break;case"lines":F(this._indexes,this._primitivesCollection.lines,e[i]);break;case"hlines":F(this._indexes,this._primitivesCollection.hlines,e[i]);break;case"textmarks":F(this._indexes,this._primitivesCollection.textmarks,e[i]);break;case"shapemarks":F(this._indexes,this._primitivesCollection.shapemarks,e[i]);break;case"backgrounds":F(this._indexes,this._primitivesCollection.backgrounds,e[i]);break;case"polygons":F(this._indexes,this._primitivesCollection.polygons,e[i]);break;case"trendchannels":F(this._indexes,this._primitivesCollection.trendchannels,e[i]);break;case"hhists":F(this._indexes,this._primitivesCollection.hhists,e[i]);break;case"dwglabels":z(i,this._indexes,this._primitivesCollection.dwglabels,W.dwglabels,e[i]);break;case"dwglines":z(i,this._indexes,this._primitivesCollection.dwglines,W.dwglines,e[i]);break;case"dwgpolylines":z(i,this._indexes,this._primitivesCollection.dwgpolylines,W.dwgpolylines,e[i]);break;case"dwgboxes":z(i,this._indexes,this._primitivesCollection.dwgboxes,W.dwgboxes,e[i]);break;case"dwgtables":z(i,this._indexes,this._primitivesCollection.dwgtables,W.dwgtables,e[i]);break;case"dwgtablecells":
F(this._indexes,this._primitivesCollection.dwgtablecells,e[i]);break;case"dwglinefills":F(this._indexes,this._primitivesCollection.dwglinefills,e[i]);break;case"tpos":F(this._indexes,this._primitivesCollection.tpos,e[i]);break;case"tpoBlockSets":z(i,this._indexes,this._primitivesCollection.tpoBlockSets,W.tpoBlockSets,e[i]);break;case"tpoLevels":z(i,this._indexes,this._primitivesCollection.tpoLevels,W.tpoLevels,e[i]);break;case"tpoVolumeRows":z(i,this._indexes,this._primitivesCollection.tpoVolumeRows,W.tpoVolumeRows,e[i]);break;case"logs":F(this._indexes,this._primitivesCollection.logs,e[i]);break;case"performance":F(this._indexes,this._primitivesCollection.performance,e[i]);break;case"footprints":F(this._indexes,this._primitivesCollection.footprints,e[i]);break;case"footprintLevels":F(this._indexes,this._primitivesCollection.footprintLevels,e[i])}}this._hhistsByTimePointIndex=(0,M.splitHHistsByTimePointIndex)(this._primitivesCollection.hhists)}_processEraseCommands(e){for(const t of e)if("all"===t.action){for(const e of M.regularPrimitiveNames)this._primitivesCollection[e].forEach((e=>e.clearPrimitives()));for(const e of M.groupedPrimitiveNames)this._primitivesCollection[e].forEach((e=>{e.forEach((e=>e.clearPrimitives()))}))}else{const e=e=>e.deleteById(t.id);(0,M.isRegularPrimiriveName)(t.type)?this._primitivesCollection[t.type].forEach(e):this._primitivesCollection[t.type].forEach((t=>{t.forEach(e)}))}this._hhistsByTimePointIndex=(0,M.splitHHistsByTimePointIndex)(this._primitivesCollection.hhists)}}class R{constructor(e,t){this._primitivesDataById=new Map,this._primitiveById=new Map,this._changed=new r.Delegate,this._cleared=new r.Delegate,this._materializePrimitive=e,this._isRematerializationRequiredWithNewIndexes=t}changed(){return this._changed}cleared(){return this._cleared}forEach(e,t){this._primitiveById.forEach((i=>{e.call(t,i,i,this)}))}has(e){let t=!1;return this._primitiveById.forEach((i=>{t=t||i===e})),t}get size(){return this._primitiveById.size}[Symbol.iterator](){return this._primitiveById.values()}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}union(){throw new Error("Not implemented")}intersection(){throw new Error("Not implemented")}difference(){throw new Error("Not implemented")}symmetricDifference(){throw new Error("Not implemented")}isSubsetOf(){throw new Error("Not implemented")}isSupersetOf(){throw new Error("Not implemented")}isDisjointFrom(){throw new Error("Not implemented")}values(){return this._primitiveById.values()}hasId(e){return this._primitiveById.has(e)}addData(e,t){const i=[];e.forEach((e=>{this._primitivesDataById.set(e.id,e);const s=this._tryMaterialize(t,e);null!==s&&i.push(s)})),i.length>0&&this._changed.fire({created:i,removed:[]})}deleteById(e){const t=this._primitiveById.get(e);t&&(this._primitiveById.delete(e),this._primitivesDataById.delete(e),this._changed.fire({created:[],removed:[t]}))}clear(){this.clearPrimitives()}clearPrimitives(){this._primitivesDataById.clear(),this._primitiveById.clear(),this._cleared.fire()}
replaceIndexesTo(e){if(!this._isRematerializationRequiredWithNewIndexes)return;const t=Array.from(this._primitiveById.values());this._primitiveById.clear(),this._primitivesDataById.forEach(this._tryMaterialize.bind(this,e),this);const i=Array.from(this._primitiveById.values());this._changed.fire({created:i,removed:t})}extract(){const e=new Set(this._primitivesDataById.values());return this.clearPrimitives(),e}_tryMaterialize(e,t){const i=this._materializePrimitive(t,e);return null!==i&&((0,s.assert)(!this._primitiveById.has(t.id),"primitive with specified id should not exist"),this._primitiveById.set(t.id,i)),i}}function N(e){const t=new Map;for(const[r,o]of e)t.set(r,(i=o,(s=t.get(r))?(0,n.join)(s,i.extract()):i.extract()));var i,s;return t}function B(e){return N((0,n.mapEntriesGenerator)(e))}function O(e){return N((0,n.nestedMapGenerator)(e))}function F(e,t,i=[]){for(const n of i){const i=n.styleId,r=t.get(i);(0,s.assert)(void 0!==r,"Every style used by graphics primitive should be declared in study metainfo"),r.addData(n.data,e)}}function z(e,t,i,n,r=[]){for(const o of r){const r=o.styleId,a=i.get(r);(0,s.assert)(void 0!==a,"Every style used by graphics primitive should be declared in study metainfo"),o.data.forEach((i=>{var s;const r=(0,M.getPrimitiveDataKey)(i,e),o=null!==(s=a.get(r))&&void 0!==s?s:n();o.addData([i],t),a.set(r,o)}))}}const W={horizlines:()=>new R(a.materializeHorizLine,a.containsHorizLineTimePointIndexes),vertlines:()=>new R(l.materializeVertLine,l.containsVertLineTimePointIndexes),lines:()=>new R(g.materializeLine,g.containsLineTimePointIndexes),hlines:()=>new R(_.materializeLevel,_.containsLevelTimePointIndexes),textmarks:()=>new R(v.materializeTextMark,v.containsTextMarkTimePointIndexes),shapemarks:()=>new R(f.materializeShapeMark,f.containsShapeMarkTimePointIndexes),backgrounds:()=>new R(u.materializeBackground,u.containsBackgroundTimePointIndexes),polygons:()=>new R(d.materializePolygon,d.containsPolygonTimePointIndexes),trendchannels:()=>new R(y.materializeTrendChannel,y.containsTrendChannelTimePointIndexes),hhists:()=>new R(o.materializeHHist,o.containsHHistTimePointIndexes),dwglines:()=>new R(c.materializeDwgLine,c.containsDwgLineTimePointIndexes),dwglinefills:()=>new R(b.materializeDwgLineFill,b.containsDwgLineFillTimePointIndexes),dwglabels:()=>new R(h.materializeDwgLabel,h.containsDwgLabelTimePointIndexes),dwgtablecells:()=>new R(w.materializeDwgTableCell,w.containsDwgTableCellTimePointIndexes),dwgpolylines:()=>new R(p.materializeDwgPolyline,p.containsDwgPolylineTimePointIndexes),dwgboxes:()=>new R(m.materializeDwgBox,m.containsDwgBoxTimePointIndexes),dwgtables:()=>new R(w.materializeDwgTable,w.containsDwgTableTimePointIndexes),tpos:()=>new R(S.materializeTpo,S.containsTpoTimePointIndexes),tpoBlockSets:()=>new R(x.materializeTpoBlockSet,x.containsTpoBlockSetTimePointIndexes),tpoLevels:()=>new R(P.materializeTpoLevelGroup,P.containsTpoLevelGroupTimePointIndexes),tpoVolumeRows:()=>new R(I.materializeTpoVolumeRow,I.containsTpoVolumeRowTimePointIndexes),logs:()=>new R(C,false),
footprints:()=>new R(L.materializeVolumeFootprint,L.containsFootprintTimePointIndexes),footprintLevels:()=>new R(D.materializeVolumeFootprintPriceLevel,D.containsFootprintPriceLevelTimePointIndexes)}},239041:(e,t,i)=>{"use strict";i.d(t,{containsPolygonTimePointIndexes:()=>r,dematerializePolygon:()=>a,isPolygonInBarsRange:()=>l,materializePolygon:()=>o});var s=i(501571),n=i(585240);const r=!0;function o(e,t){for(const i of e.points){if(i.index>=t.length)return null;if(t[i.index]===s.INVALID_TIME_POINT_INDEX)return null}return{points:e.points.map((e=>({index:t[e.index],offset:e.offset,level:e.level})))}}function a(e,t,i){return{id:t,points:e.points.map((e=>({...e,index:(0,n.ensureTimePointIndexIndex)(i.indexOf(e.index))})))}}function l(e,t){var i;if(e.points.some((e=>{var i;return t.contains(e.index+(null!==(i=e.offset)&&void 0!==i?i:0))})))return!0;let s=!1,n=!1;const r=t.firstBar();for(const t of e.points)t.index+(null!==(i=t.offset)&&void 0!==i?i:0)<r?s=!0:n=!0;return s&&n}},521854:(e,t,i)=>{"use strict";i.d(t,{containsShapeMarkTimePointIndexes:()=>o,dematerializeShapeMark:()=>l,isShapeMarkInBarsRange:()=>d,materializeShapeMark:()=>a});var s,n=i(501571),r=i(585240);!function(e){e.Circle="circle",e.ArrowUp="arrowUp",e.ArrowDown="arrowDown",e.ArrowRight="arrowRight",e.ArrowLeft="arrowLeft",e.Square="square"}(s||(s={}));const o=!0;function a(e,t){if(e.time>=t.length)return null;const i=t[e.time];return i===n.INVALID_TIME_POINT_INDEX?null:{time:i,price:e.price}}function l(e,t,i){const s=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.time));return{id:t,...e,time:s}}function d(e,t){return t.contains(e.time)}},515821:(e,t,i)=>{"use strict";i.d(t,{StaticStudyGraphics:()=>E,emptyStudyGraphics:()=>N,loadStudyGraphics:()=>B,saveStudyGraphics:()=>F});var s=i(501571),n=i(224621),r=i(267439),o=i(307801),a=i(239041),l=i(759214),d=i(951586),u=i(649420),h=i(521854),c=i(968632),p=i(323070),m=i(15141),_=i(164937),g=i(551789),f=i(18613),v=i(817959),y=i(276507),w=i(892686),b=i(487027),S=i(399890),x=i(73239),P=i(255866),I=i(408582),T=i(355468),C=i(124829);class E{constructor(e,t){if(this._indexes=[],this._horizlines=new Map,this._vertlines=new Map,this._lines=new Map,this._hlines=new Map,this._textmarks=new Map,this._shapemarks=new Map,this._backgrounds=new Map,this._polygons=new Map,this._trendchannels=new Map,this._hhists=new Map,this._dwglabels=new Map,this._dwglines=new Map,this._dwgpolylines=new Map,this._dwgboxes=new Map,this._dwgtables=new Map,this._dwgtablecells=new Map,this._dwglinefills=new Map,this._tpos=new Map,this._tpoBlockSets=new Map,this._tpoLevelGroups=new Map,this._tpoVolumeRows=new Map,this._logs=new Map,this._performance=new Map,this._footprints=new Map,this._footprintLevels=new Map,"data"===e){const e=t;this._indexes=e.indexes,this._vertlines=A(e.vertlines,this._indexes,r.materializeVertLine),this._horizlines=A(e.horizlines,this._indexes,n.materializeHorizLine),this._polygons=A(e.polygons,this._indexes,a.materializePolygon),this._hhists=A(e.hhists,this._indexes,o.materializeHHist),
this._backgrounds=A(e.backgrounds,this._indexes,l.materializeBackground),this._lines=A(e.lines,this._indexes,u.materializeLine),this._hlines=A(e.hlines,this._indexes,d.materializeLevel),this._textmarks=A(e.textmarks,this._indexes,c.materializeTextMark),this._shapemarks=A(e.shapemarks,this._indexes,h.materializeShapeMark),this._trendchannels=A(e.trendchannels,this._indexes,p.materializeTrendChannel),this._dwglabels=L("dwglabels",e.dwglabels,this._indexes,m.materializeDwgLabel),this._dwglines=L("dwglines",e.dwglines,this._indexes,_.materializeDwgLine),this._dwgpolylines=L("dwgpolylines",e.dwgpolylines,this._indexes,g.materializeDwgPolyline),this._dwgboxes=L("dwgboxes",e.dwgboxes,this._indexes,f.materializeDwgBox),this._dwgtables=L("dwgtables",e.dwgtables,this._indexes,v.materializeDwgTable),this._dwgtablecells=A(e.dwgtablecells,this._indexes,v.materializeDwgTableCell),this._dwglinefills=A(e.dwglinefills,this._indexes,y.materializeDwgLineFill),this._tpos=A(e.tpos,this._indexes,w.materializeTpo),this._tpoBlockSets=L("tpoBlockSets",e.tpoBlockSets,this._indexes,b.materializeTpoBlockSet),this._tpoVolumeRows=L("tpoVolumeRows",e.tpoVolumeRows,this._indexes,x.materializeTpoVolumeRow),this._tpoLevelGroups=L("tpoLevels",e.tpoLevels,this._indexes,S.materializeTpoLevelGroup),this._footprints=A(e.footprints,this._indexes,P.materializeVolumeFootprint),this._footprintLevels=A(e.footprintLevels,this._indexes,I.materializeVolumeFootprintPriceLevel)}else if("state"===e){const e=t;this._indexes=e.indexes||[],this._vertlines=D(e.vertlines,this._indexes,r.materializeVertLine),this._horizlines=D(e.horizlines,this._indexes,n.materializeHorizLine),this._polygons=D(e.polygons,this._indexes,a.materializePolygon),this._hhists=D(e.hhists,this._indexes,o.materializeHHist),this._backgrounds=D(e.backgrounds,this._indexes,l.materializeBackground),this._lines=D(e.lines,this._indexes,u.materializeLine),this._hlines=D(e.hlines,this._indexes,d.materializeLevel),this._textmarks=D(e.textmarks,this._indexes,c.materializeTextMark),this._shapemarks=D(e.shapemarks,this._indexes,h.materializeShapeMark),this._trendchannels=D(e.trendchannels,this._indexes,p.materializeTrendChannel),this._dwglabels=M("dwglabels",e.dwglabels,this._indexes,m.materializeDwgLabel),this._dwglines=M("dwglines",e.dwglines,this._indexes,_.materializeDwgLine),this._dwgpolylines=M("dwgpolylines",e.dwgpolylines,this._indexes,g.materializeDwgPolyline),this._dwgboxes=M("dwgboxes",e.dwgboxes,this._indexes,f.materializeDwgBox),this._dwgtables=M("dwgtables",e.dwgtables,this._indexes,v.materializeDwgTable),this._dwgtablecells=D(e.dwgtablecells,this._indexes,v.materializeDwgTableCell),this._dwglinefills=D(e.dwglinefills,this._indexes,y.materializeDwgLineFill),this._tpos=D(e.tpos,this._indexes,w.materializeTpo),this._tpoBlockSets=M("tpoBlockSets",e.tpoBlockSets,this._indexes,b.materializeTpoBlockSet),this._tpoVolumeRows=M("tpoVolumeRows",e.tpoVolumeRows,this._indexes,x.materializeTpoVolumeRow),this._tpoLevelGroups=M("tpoLevels",e.tpoLevels,this._indexes,S.materializeTpoLevelGroup),
this._footprints=D(e.footprints,this._indexes,P.materializeVolumeFootprint),this._footprintLevels=D(e.footprintLevels,this._indexes,I.materializeVolumeFootprintPriceLevel)}this._hhistsByTimePointIndex=(0,T.splitHHistsByTimePointIndex)(this._hhists)}horizlines(){return this._horizlines}vertlines(){return this._vertlines}lines(){return this._lines}hlines(){return this._hlines}textmarks(){return this._textmarks}shapemarks(){return this._shapemarks}backgrounds(){return this._backgrounds}polygons(){return this._polygons}trendchannels(){return this._trendchannels}hhists(){return this._hhists}dwglabels(){return this._dwglabels}dwglines(){return this._dwglines}dwgpolylines(){return this._dwgpolylines}dwgboxes(){return this._dwgboxes}dwgtables(){return this._dwgtables}dwgtablecells(){return this._dwgtablecells}dwglinefills(){return this._dwglinefills}tpos(){return this._tpos}tpoBlockSets(){return this._tpoBlockSets}tpoLevels(e){return this._tpoLevelGroups}tpoVolumeRows(e){return this._tpoVolumeRows}logs(){return this._logs}performance(){return this._performance}footprints(){return this._footprints}footprintLevels(){return this._footprintLevels}hhistsByTimePointIndex(){return this._hhistsByTimePointIndex}}function A(e,t,i){return new Map(Array.from(e.entries()).map((e=>[e[0],new Set(Array.from(e[1]).map((e=>i(e,t))).filter(C.notNull))])))}function L(e,t,i,s){const n=t=>{const i=new Map;return t.forEach((t=>{var s;const n=(0,T.getPrimitiveKey)(t,e),r=null!==(s=i.get(n))&&void 0!==s?s:new Set;r.add(t),i.set(n,r)})),i};return new Map(Array.from(t.entries()).map((e=>[e[0],n(Array.from(e[1]).map((e=>s(e,i))).filter(C.notNull))])))}function D(e,t,i){const s=new Map;if(void 0===e)return s;for(const n of e){const e=n.styleId,r=s.get(e)||new Set;n.data.forEach((e=>{const s=i(e,t);null!==s&&r.add(s)})),s.set(e,r)}return s}function M(e,t,i,s){const n=t=>{const i=new Map;return t.forEach((t=>{var s;const n=(0,T.getPrimitiveKey)(t,e),r=null!==(s=i.get(n))&&void 0!==s?s:new Set;r.add(t),i.set(n,r)})),i};return new Map((null!=t?t:[]).map((e=>[e.styleId,n(e.data.map((e=>s(e,i))).filter(C.notNull))])))}function V(e,t,i){let s=null;for(const i of e)i.styleId===t&&(s=i);null===s&&(s={styleId:t,data:[]},e.push(s)),s.data.push(i)}function k(e,t,i,s,n,r){const o=[];return e.forEach(((e,a)=>{e.forEach((e=>{(null===n||s(e,n))&&V(o,a,r(e,t(e),i))}))})),o.length>0?o:void 0}function R(e,t,i,s,n,r){const o=[];return e.forEach(((e,a)=>{e.forEach((e=>{e.forEach((e=>{(null===n||s(e,n))&&V(o,a,r(e,t(e),i))}))}))})),o.length>0?o:void 0}function N(){return new E}function B(e){return new E("state",e)}function O(e,t){return!0}function F(e,t){var i,T,E,A;const L=function(e){const t=new Set,i=e=>{null!=e&&t.add(e)};e.horizlines().forEach(((e,i)=>{e.forEach((e=>{t.add(e.startIndex),t.add(e.endIndex)}))})),e.vertlines().forEach(((e,i)=>{e.forEach((e=>{t.add(e.index)}))})),e.lines().forEach(((e,i)=>{e.forEach((e=>{t.add(e.startIndex),t.add(e.endIndex)}))})),e.textmarks().forEach(((e,i)=>{e.forEach((e=>{t.add(e.time)}))})),e.shapemarks().forEach(((e,i)=>{
e.forEach((e=>{t.add(e.time)}))})),e.backgrounds().forEach(((e,i)=>{e.forEach((e=>{t.add(null!==e.start?e.start:s.INVALID_TIME_POINT_INDEX),t.add(e.stop)}))})),e.polygons().forEach(((e,i)=>{e.forEach((e=>{e.points.forEach((e=>{t.add(e.index)}))}))})),e.trendchannels().forEach(((e,i)=>{e.forEach((e=>{t.add(e.startIndex),t.add(e.endIndex)}))})),e.hhists().forEach(((e,i)=>{e.forEach((e=>{t.add(e.firstBarTime),t.add(e.lastBarTime)}))})),e.dwglabels().forEach((e=>{e.forEach((e=>{e.forEach((e=>{t.add(e.x)}))}))})),e.dwglines().forEach((e=>{e.forEach((e=>{e.forEach((e=>{var i,n;t.add(null!==(i=e.x1)&&void 0!==i?i:s.INVALID_TIME_POINT_INDEX),t.add(null!==(n=e.x2)&&void 0!==n?n:s.INVALID_TIME_POINT_INDEX)}))}))})),e.dwgpolylines().forEach((e=>{e.forEach((e=>{e.forEach((e=>{var i;for(const n of e.points)t.add(null!==(i=n.x)&&void 0!==i?i:s.INVALID_TIME_POINT_INDEX)}))}))})),e.dwgboxes().forEach((e=>{e.forEach((e=>{e.forEach((e=>{var i,n;t.add(null!==(i=e.left)&&void 0!==i?i:s.INVALID_TIME_POINT_INDEX),t.add(null!==(n=e.right)&&void 0!==n?n:s.INVALID_TIME_POINT_INDEX)}))}))})),e.tpos().forEach((e=>{e.forEach((e=>{t.add(e.firstBarTime),t.add(e.lastBarTime)}))})),e.tpoLevels().forEach((e=>{e.forEach((e=>{e.forEach((e=>{var t;i(e.poorHighExtendTo),i(e.poorLowExtendTo),i(e.tpoPocExtendTo),(null!==(t=e.singleprints)&&void 0!==t?t:[]).map((e=>e.extendTo)).map(i)}))}))})),e.footprints().forEach((e=>{e.forEach((e=>{t.add(e.index)}))})),e.footprintLevels().forEach((e=>{e.forEach((e=>{t.add(e.startIndex),i(e.extendTo)}))}));const n=Array.from(t);return n.sort(((e,t)=>e-t)),n}(e),D={indexes:L};let M=0;const V=()=>++M,N=e=>e.id;D.vertlines=k(e.vertlines(),V,L,r.isVertLineInBarsRange,t,r.dematerializeVertLine),D.horizlines=k(e.horizlines(),V,L,n.isHorizLineInBarsRange,t,n.dematerializeHorizLine),D.polygons=k(e.polygons(),V,L,a.isPolygonInBarsRange,t,a.dematerializePolygon),D.hhists=k(e.hhists(),V,L,o.isHHistInBarsRange,t,o.dematerializeHHist),D.backgrounds=k(e.backgrounds(),V,L,l.isBackgroundInBarsRange,t,l.dematerializeBackground);{D.lines=k(e.lines(),V,L,u.isLineInBarsRange,t,u.dematerializeLine),D.hlines=k(e.hlines(),V,L,O,t,d.dematerializeLevel),D.textmarks=k(e.textmarks(),V,L,c.isTextMarkInBarsRange,t,c.dematerializeTextMark),D.shapemarks=k(e.shapemarks(),V,L,h.isShapeMarkInBarsRange,t,h.dematerializeShapeMark),D.trendchannels=k(e.trendchannels(),V,L,p.isTrendChannelInBarsRange,t,p.dematerializeTrendChannel),D.dwglabels=R(e.dwglabels(),V,L,m.isDwgLabelInBarsRange,t,m.dematerializeDwgLabel),D.dwglines=R(e.dwglines(),N,L,_.isDwgLineInBarsRange,t,_.dematerializeDwgLine),D.dwgpolylines=R(e.dwgpolylines(),N,L,g.isDwgPolylineInBarsRange,t,g.dematerializeDwgPolyline),D.dwgboxes=R(e.dwgboxes(),V,L,f.isDwgBoxInBarsRange,t,f.dematerializeDwgBox),D.dwgtables=R(e.dwgtables(),N,L,O,t,v.dematerializeDwgTable),D.dwgtablecells=k(e.dwgtablecells(),V,L,O,t,v.dematerializeDwgTableCell),D.dwglinefills=k(e.dwglinefills(),V,L,O,t,y.dematerializeDwgLineFill)
;const s=new Map(Array.from(null!==(T=null===(i=e.tpos().get("tpo"))||void 0===i?void 0:i.values())&&void 0!==T?T:[]).map((e=>[e.id,e]))),n=e=>s.get(e),r=R(e.tpoBlockSets(),V,L,b.isTpoBlockSetInBarsRange.bind(null,n),t,b.dematerializeTpoBlockSet);D.tpoLevels=R(e.tpoLevels(),V,L,S.isTpoLevelInBarsRange.bind(null,n),t,S.dematerializeTpoLevelGroup),D.tpoVolumeRows=R(e.tpoVolumeRows(),V,L,x.isTpoVolumeRowsInBarsRange.bind(null,n),t,x.dematerializeTpoVolumeRow);const o=[null==r?void 0:r[0].data,null===(E=D.tpoLevels)||void 0===E?void 0:E[0].data,null===(A=D.tpoVolumeRows)||void 0===A?void 0:A[0].data].filter(C.notUndefined).reduce(((e,t)=>e.concat(t.map((e=>e.tpoId)))),[]),a=new Set(o);D.tpos=k(e.tpos(),N,L,(e=>a.has(e.id)),t,w.dematerializeTpo),D.tpoBlockSets=R(e.tpoBlockSets(),V,L,(e=>a.has(e.tpoId)),t,b.dematerializeTpoBlockSet),D.footprints=k(e.footprints(),V,L,P.isVolumeFootprintInBarsRange,t,P.dematerializeVolumeFootprint),D.footprintLevels=k(e.footprintLevels(),V,L,I.isVolumeFootprintPriceLevelInBarsRange,t,I.dematerializeVolumeFootprintPriceLevel)}return D}},355468:(e,t,i)=>{"use strict";i.d(t,{getPrimitiveDataKey:()=>o,getPrimitiveKey:()=>r,groupedPrimitiveNames:()=>l,hasForceOverlayPrimitives:()=>m,isRegularPrimiriveName:()=>u,isStudyGraphicsEmpty:()=>c,primitiveNames:()=>d,primitivesZOrders:()=>h,regularPrimitiveNames:()=>a,splitHHistsByTimePointIndex:()=>p});const s=["dwglines","dwgboxes","dwglabels","dwgpolylines","dwgtables"];function n(e){return s.includes(e)}function r(e,t){return n(t)?(e=>!!e.forceOverlay)(e):(e=>e.tpoId)(e)}function o(e,t){return n(t)?!!e.fo:(e=>e.tpoId)(e)}const a=["horizlines","vertlines","lines","hlines","textmarks","shapemarks","backgrounds","polygons","trendchannels","hhists","dwgtablecells","dwglinefills","tpos","logs","performance","footprints","footprintLevels"],l=s.concat(["tpoBlockSets","tpoLevels","tpoVolumeRows"]),d=a.concat(l);function u(e){return a.includes(e)}const h=new Map([["logs",-4],["performance",-4],["polygons",-4],["trendchannels",-3],["textmarks",-2],["shapemarks",-2],["backgrounds",-1],["footprints",1],["footprintLevels",1],["hlines",1],["horizlines",1],["hhists",1],["dwglinefills",2],["vertlines",3],["lines",3],["dwglines",3],["dwgpolylines",3],["dwgboxes",4],["dwglabels",5],["dwgtables",6],["dwgtablecells",6],["tpos",7],["tpoBlockSets",7],["tpoLevels",7],["tpoVolumeRows",7]]);function c(e){return!d.some((t=>{const i=e[t]();for(const[,e]of i)if(e.size>0)return!0;return!1}))}function p(e){const t=new Map;return e.forEach(((e,i)=>{e.forEach((e=>{const s={...e,styleId:i},n=e.firstBarTime;let r=t.get(n);void 0===r&&(r=new Set,t.set(n,r)),r.add(s)}))})),t}function m(e){return!!(e.graphics.dwglines||e.graphics.dwgboxes||e.graphics.dwglabels||e.graphics.dwgpolylines||e.graphics.dwgtables)}},968632:(e,t,i)=>{"use strict";i.d(t,{TextMarkType:()=>s,containsTextMarkTimePointIndexes:()=>a,dematerializeTextMark:()=>d,isTextMarkInBarsRange:()=>u,materializeTextMark:()=>l});var s,n,r=i(501571),o=i(585240);!function(e){e.Triangle="triangle",e.Rectangle="rectangle"}(s||(s={})),
function(e){e.Verdana="Verdana",e.CourierNew="Courier New",e.TimesNewRoman="Times New Roman",e.Arial="Arial"}(n||(n={}));const a=!0;function l(e,t){if(e.time>=t.length)return null;const i=t[e.time];return i===r.INVALID_TIME_POINT_INDEX?null:{time:i,offset:e.offset,text:e.text,price:e.price}}function d(e,t,i){const s=(0,o.ensureTimePointIndexIndex)(i.indexOf(e.time));return{id:t,...e,time:s}}function u(e,t){var i;return t.contains(e.time+(null!==(i=e.offset)&&void 0!==i?i:0))}},487027:(e,t,i)=>{"use strict";i.d(t,{containsTpoBlockSetTimePointIndexes:()=>n,dematerializeTpoBlockSet:()=>o,isTpoBlockSetInBarsRange:()=>a,materializeTpoBlockSet:()=>r});var s=i(892686);const n=!1;function r(e,t){return{tpoId:e.tpoId,blocks:e.blocks,rowIndex:e.rowIndex}}function o(e,t,i){return{id:t,tpoId:e.tpoId,blocks:e.blocks,rowIndex:e.rowIndex}}function a(e,t,i){const n=e(t.tpoId);return Boolean(n&&(0,s.isTpoInBarsRange)(n,i))}},399890:(e,t,i)=>{"use strict";i.d(t,{containsTpoLevelGroupTimePointIndexes:()=>o,dematerializeTpoLevelGroup:()=>h,isTpoLevelInBarsRange:()=>c,materializeTpoLevelGroup:()=>l});var s=i(124829),n=i(501571),r=i(585240);const o=!0;function a(e,t){const i=null==e?e:t[e];return i===n.INVALID_TIME_POINT_INDEX?null:i}function l(e,t){var i;return{tpoId:e.tpoId,tpoPocIndex:e.tpoPocIndex,tpoPocExtendTo:a(e.tpoPocExtendTo,t),tpoValIndex:e.tpoValIndex,tpoValExtendTo:a(e.tpoValExtendTo,t),tpoVahIndex:e.tpoVahIndex,tpoVahExtendTo:a(e.tpoVahExtendTo,t),tpoMidpointIndex:e.tpoMidpointIndex,volumePocIndex:e.volumePocIndex,volumePocExtendTo:a(e.volumePocExtendTo,t),volumeValIndex:e.volumeValIndex,volumeValExtendTo:a(e.volumeValExtendTo,t),volumeVahIndex:e.volumeVahIndex,volumeVahExtendTo:a(e.volumeVahExtendTo,t),poorHighIndex:e.poorHighIndex,poorHighExtendTo:a(e.poorHighExtendTo,t),poorLowIndex:e.poorLowIndex,poorLowExtendTo:a(e.poorLowExtendTo,t),singleprints:null===(i=e.singleprints)||void 0===i?void 0:i.map((e=>function(e,t){return{index:e.index,extendTo:a(e.extendTo,t)}}(e,t)))}}function d(e,t){return null==e?e:(0,r.ensureTimePointIndexIndex)(t.indexOf(e))}function u(e){return Object.keys(e).filter((t=>void 0===e[t])).forEach((t=>delete e[t])),e}function h(e,t,i){var s;return u({id:t,tpoId:e.tpoId,tpoPocIndex:e.tpoPocIndex,tpoPocExtendTo:d(e.tpoPocExtendTo,i),tpoValIndex:e.tpoValIndex,tpoValExtendTo:d(e.tpoValExtendTo,i),tpoVahIndex:e.tpoVahIndex,tpoVahExtendTo:d(e.tpoVahExtendTo,i),tpoMidpointIndex:e.tpoMidpointIndex,volumePocIndex:e.volumePocIndex,volumePocExtendTo:d(e.volumePocExtendTo,i),volumeValIndex:e.volumeValIndex,volumeValExtendTo:d(e.volumeValExtendTo,i),volumeVahIndex:e.volumeVahIndex,volumeVahExtendTo:d(e.volumeVahExtendTo,i),poorHighIndex:e.poorHighIndex,poorHighExtendTo:d(e.poorHighExtendTo,i),poorLowIndex:e.poorLowIndex,poorLowExtendTo:d(e.poorLowExtendTo,i),singleprints:null===(s=e.singleprints)||void 0===s?void 0:s.map((e=>function(e,t){return u({index:e.index,extendTo:d(e.extendTo,t)})}(e,i)))})}function c(e,t,i){var n;const r=e(t.tpoId);if(!r)return!1
;const o=r.firstBarTime,a=[t.poorHighExtendTo,t.poorLowExtendTo,t.tpoPocExtendTo,t.tpoValExtendTo,t.tpoVahExtendTo,t.volumePocExtendTo,t.volumeValExtendTo,t.volumeVahExtendTo].concat((null!==(n=t.singleprints)&&void 0!==n?n:[]).map((e=>e.extendTo))).filter(s.notUndefined).map((e=>null!=e?e:1/0)),l=a.length?Math.max(...a):null;return!((null!=l?l:r.lastBarTime)<i.firstBar()||o>i.lastBar())}},73239:(e,t,i)=>{"use strict";i.d(t,{containsTpoVolumeRowTimePointIndexes:()=>n,dematerializeTpoVolumeRow:()=>o,isTpoVolumeRowsInBarsRange:()=>a,materializeTpoVolumeRow:()=>r});var s=i(892686);const n=!1;function r(e,t){return{tpoId:e.tpoId,rowIndex:e.rowIndex,volume:e.volume}}function o(e,t,i){return{id:t,tpoId:e.tpoId,rowIndex:e.rowIndex,volume:e.volume}}function a(e,t,i){const n=e(t.tpoId);return Boolean(n&&(0,s.isTpoInBarsRange)(n,i))}},892686:(e,t,i)=>{"use strict";i.d(t,{containsTpoTimePointIndexes:()=>o,dematerializeTpo:()=>l,isTpoInBarsRange:()=>d,materializeTpo:()=>a});var s=i(650151),n=i(501571),r=i(585240);const o=!0;function a(e,t){if(e.firstBarTime>=t.length||e.lastBarTime>=t.length)return null;const i=t[e.firstBarTime],r=t[e.lastBarTime];return i===n.INVALID_TIME_POINT_INDEX||r===n.INVALID_TIME_POINT_INDEX?null:((0,s.assert)(i<=r,"firstBarTime should not exceed lastBarTime"),{id:e.id,firstBarTime:i,lastBarTime:r,priceRange:e.priceRange,times:e.times})}function l(e,t,i){return{id:t,firstBarTime:(0,r.ensureTimePointIndexIndex)(i.indexOf(e.firstBarTime)),lastBarTime:(0,r.ensureTimePointIndexIndex)(i.indexOf(e.lastBarTime)),priceRange:e.priceRange,times:e.times}}function d(e,t){return!(e.lastBarTime<t.firstBar()||e.firstBarTime>t.lastBar())}},323070:(e,t,i)=>{"use strict";i.d(t,{containsTrendChannelTimePointIndexes:()=>o,dematerializeTrendChannel:()=>l,isTrendChannelInBarsRange:()=>d,materializeTrendChannel:()=>a});var s=i(650151),n=i(501571),r=i(585240);const o=!0;function a(e,t){if(e.startIndex>=t.length||e.endIndex>=t.length)return null;const i=t[e.startIndex],r=t[e.endIndex];return i===n.INVALID_TIME_POINT_INDEX||r===n.INVALID_TIME_POINT_INDEX?null:((0,s.assert)(i<=r,"startIndex should not exceed endIndex"),{startIndex:i,endIndex:r,extendLeft:e.extendLeft,extendRight:e.extendRight,startHighPrice:e.startHighPrice,startLowPrice:e.startLowPrice,endHighPrice:e.endHighPrice,transparency:e.transparency})}function l(e,t,i){const s=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.startIndex)),n=(0,r.ensureTimePointIndexIndex)(i.indexOf(e.endIndex));return{id:t,...e,startIndex:s,endIndex:n}}function d(e,t){const i=Math.min(e.startIndex,e.endIndex),s=Math.max(e.startIndex,e.endIndex);if(t.contains(i)||t.contains(s)||i<t.firstBar()&&s>t.lastBar())return!0;const n=e.startIndex<e.endIndex?e.extendLeft:e.extendRight,r=e.startIndex<e.endIndex?e.extendRight:e.extendLeft;return s<t.firstBar()&&r||i>t.lastBar()&&n}},267439:(e,t,i)=>{"use strict";i.d(t,{containsVertLineTimePointIndexes:()=>r,dematerializeVertLine:()=>a,isVertLineInBarsRange:()=>l,materializeVertLine:()=>o});var s=i(501571),n=i(585240);const r=!0;function o(e,t){
if(e.index>=t.length)return null;const i=t[e.index];return i===s.INVALID_TIME_POINT_INDEX?null:{startPrice:e.startPrice,endPrice:e.endPrice,index:i,extendTop:e.extendTop,extendBottom:e.extendBottom}}function a(e,t,i){const s=(0,n.ensureTimePointIndexIndex)(i.indexOf(e.index));return{id:t,...e,index:s}}function l(e,t){return t.contains(e.index)}},408582:(e,t,i)=>{"use strict";i.d(t,{containsFootprintPriceLevelTimePointIndexes:()=>r,dematerializeVolumeFootprintPriceLevel:()=>a,isVolumeFootprintPriceLevelInBarsRange:()=>l,materializeVolumeFootprintPriceLevel:()=>o});var s=i(501571),n=i(585240);const r=!0;function o(e,t){if(e.startIndex>=t.length)return null;const i=t[e.startIndex],n=null===e.extendTo?null:t[e.extendTo];return i===s.INVALID_TIME_POINT_INDEX||n===s.INVALID_TIME_POINT_INDEX?null:{id:e.id,price:e.price,type:e.type,startIndex:i,extendTo:n}}function a(e,t,i){var r,o;const a=(0,n.ensureTimePointIndexIndex)(i.indexOf(null!==(r=e.startIndex)&&void 0!==r?r:s.INVALID_TIME_POINT_INDEX)),l=null===e.extendTo?null:(0,n.ensureTimePointIndexIndex)(i.indexOf(null!==(o=e.extendTo)&&void 0!==o?o:s.INVALID_TIME_POINT_INDEX));return{id:t,price:e.price,type:e.type,startIndex:a,extendTo:l}}function l(e,t){var i;const s=e.startIndex;return!((null!==(i=e.extendTo)&&void 0!==i?i:1/0)<t.firstBar()||s>t.lastBar())}},281233:(e,t,i)=>{"use strict";var s;i.d(t,{StudyStatusType:()=>s}),function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(s||(s={}))},700087:(e,t,i)=>{"use strict";i.r(t),i.d(t,{StudyDataSource:()=>p});var s=i(650151),n=i(942634),r=i(55243),o=i(979351),a=i(362805),l=i(984217),d=i(444468),u=i(281233);const h=(0,i(338619).getLogger)("Chart.StudyDataSource");var c;!function(e){e[e.Idle=0]="Idle",e[e.AwaitingConnection=1]="AwaitingConnection",e[e.AwaitingParent=2]="AwaitingParent",e[e.AwaitingFirstDataUpdate=3]="AwaitingFirstDataUpdate",e[e.Active=4]="Active"}(c||(c={}));class p{constructor(e,t,i,s){this._inputs=null,this._status=c.Idle,this._studyId=null,this._turnaroundCounter=1,this._studyStatus={type:u.StudyStatusType.Undefined},this._studyStatusChanged=new n.Delegate,this._dataCleared=new n.Delegate,this._dataUpdated=new n.Delegate,this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=e,this._metaInfo=s,this._seriesSource=t,this._turnaroundPrefix=i,this._plots=new r.PlotList((0,l.studyPlotFunctionMap)(s),l.studyEmptyPlotValuePredicate),this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged),this._graphics=new d.LiveStudyGraphics(s.graphics)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged),this._seriesSource.dataEvents().created().unsubscribeAll(this)}metaInfo(){return this._metaInfo}inputs(){return this._inputs}setInputs(e){this._inputs=e,null!==this._studyId&&(this._turnaroundCounter++,this._onStudyStatusChangedTo({type:u.StudyStatusType.Undefined}),
this._gateway.modifyStudy(this._studyId,this._turnaround(),e,this._onMessage.bind(this)),this._status===c.Active&&this._changeStatusTo(c.AwaitingFirstDataUpdate))}isStarted(){return this._status!==c.Idle}isActive(){return this._status===c.Active}start(){this.isStarted()?h.logNormal("start: data source is already started, nothing to do"):((0,s.assert)(null!==this._inputs,"Inputs should be defined when starting a study data source"),this._gateway.isConnected().value()?this._createStudy():this._changeStatusTo(c.AwaitingConnection))}stop(){this.isStarted()?(null!==this._studyId&&(this._gateway.removeStudy(this._studyId),this._studyId=null,this._onStudyStatusChangedTo({type:u.StudyStatusType.Undefined})),this._changeStatusTo(c.Idle)):h.logNormal("stop: data source is already stopped, nothing to do")}studyId(){return this._studyId}studyStatus(){return this._studyStatus}studyStatusChanged(){return this._studyStatusChanged}plots(){return this._plots}graphics(){return this._graphics}clearData(){this._plots.clear(),this._graphics.clear(),this._dataCleared.fire()}stopAndStealData(){(0,s.assert)(this._status===c.Active,"Couldn't steal data from non-active data source"),this.stop();const e=this._plots,t=this._graphics.extract();return this._plots=new r.PlotList((0,l.studyPlotFunctionMap)(this._metaInfo),l.studyEmptyPlotValuePredicate),{plots:e,graphics:t}}dataCleared(){return this._dataCleared}dataUpdated(){return this._dataUpdated}moveData(e){this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>{this._plots.move(e)}))}pendingUpdatesReady(){return this._ongoingDataUpdate}_createStudyError(e){return{type:u.StudyStatusType.Error,errorDescription:this._getStudyErrorDescription(e)}}_getStudyErrorDescription(e){return"string"==typeof e?{error:e.split(":",2)[0]}:e}_changeStatusTo(e){(0,s.assert)(this._status!==e,"Source and destination status should be distinct"),h.logNormal(`Status changed from ${c[this._status]} to ${c[e]}`),this._status=e}_createStudy(){const e=this._seriesSource.instanceId();null!==e?this._createStudyUsingParentId(e):(this._changeStatusTo(c.AwaitingParent),this._seriesSource.dataEvents().created().subscribe(this,this._onSeriesCreated,!0))}_createStudyUsingParentId(e){(0,s.assert)(this._status!==c.Active,'Status should not be "Active" when creating a study'),(0,s.assert)(this._studyStatus.type===u.StudyStatusType.Undefined,'Study status should be "Undefined" when creating a study'),(0,s.assert)(null===this._studyId,"Study id should be empty when creating a study"),this._studyId=(0,a.makeNextStudyId)(),this._gateway.createStudy(this._studyId,this._turnaround(),e,this._metaInfo.fullId+("tv-basicstudies"===this._metaInfo.packageId?"":"!"),(0,s.ensureNotNull)(this._inputs),this._onMessage.bind(this),{id:this._metaInfo.id}),this._changeStatusTo(c.AwaitingFirstDataUpdate)}_onGatewayIsConnectedChanged(e){e?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===c.AwaitingConnection&&this._createStudy()}_onGatewayDisconnected(){
this._status!==c.Idle&&this._status!==c.AwaitingConnection&&(this._studyId=null,this._changeStatusTo(c.AwaitingConnection),this._studyStatus.type!==u.StudyStatusType.Undefined&&this._onStudyStatusChangedTo({type:u.StudyStatusType.Undefined})),this._turnaroundCounter=1}_onSeriesCreated(){this._status===c.AwaitingParent&&this._createStudyUsingParentId((0,s.ensure)(this._seriesSource.instanceId()))}_onStudyStatusChangedTo(e){const t=this._studyStatus;this._studyStatus=e,h.logNormal(`Study status type changed from ${u.StudyStatusType[t.type]} to ${u.StudyStatusType[e.type]}`),this._studyStatusChanged.fire(t,e)}_onMessage(e){if("data_update"===e.method){const{customId:t,turnaround:i,plots:n,nonseries:r}=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onDataUpdate(n,(0,s.ensureDefined)(r))}else if("study_loading"===e.method){const[t,i,s]=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onStudyLoading(s)}else if("study_completed"===e.method){const[t,i,s]=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onStudyCompleted(s)}else if("study_error"===e.method){const[t,i,s,n,r]=e.params;t===this._studyId&&this._checkTurnaround(i)&&this._onStudyError(s,n,r)}else"clear_data"===e.method&&this._checkTurnaround(e.params.turnaround)&&this.clearData()}_onDataUpdate(e,t){const i=(0,o.unpackNonSeriesData)(t.d);return this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>i),(()=>i)).then(this._onDataUnpacked.bind(this,e,t.indexes)),this._ongoingDataUpdate}_onDataUnpacked(e,t,i){this._status!==c.Idle&&(this._status===c.AwaitingFirstDataUpdate&&(this._changeStatusTo(c.Active),this.clearData()),this._mergePlots(e),null!==i&&(i.indexes_replace?((0,s.assert)("nochange"!==t),this._graphics.replaceIndexesTo(t)):("nochange"!==t&&this._graphics.replaceIndexesTo(t),void 0!==i.graphicsCmds&&this._graphics.processCommands(i.graphicsCmds))),this._dataUpdated.fire(e,i,t))}_onStudyLoading(e){this._onStudyStatusChangedTo({type:u.StudyStatusType.Loading,startTime:Date.now()})}_onStudyError(e,t,i){this.clearData(),this._onStudyStatusChangedTo(this._createStudyError(e))}_onStudyCompleted(e){this._onStudyStatusChangedTo({type:u.StudyStatusType.Completed})}_mergePlots(e){this._plots.merge(e)}_turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}_checkTurnaround(e){const t=this._turnaround();return e===t||e===this._seriesSource.turnaround()||e===`${this._seriesSource.turnaround()}_${t}`}}},984217:(e,t,i)=>{"use strict";function s(e){const t=new Map;return e.plots.forEach(((e,i)=>{t.set(e.id,(e=>e[i+1]))})),t}function n(e,t){return null==e[t]}i.d(t,{studyEmptyPlotValuePredicate:()=>n,studyPlotFunctionMap:()=>s})},757402:(e,t,i)=>{"use strict";i.d(t,{StudyStatusType:()=>h,convertStudyStatusToString:()=>c,createStudyError:()=>f,studyErrorStatusStackTrace:()=>g,studyStatusFeature:()=>_,studyStatusSolutionId:()=>p,studyStatusTitle:()=>m});var s=i(444372),n=i(342707),r=i(585627);const o=s.t(null,void 0,i(150910));function a(e){const t=e.toLowerCase()
;return t.includes("the data vendor doesn't provide volume data for this symbol.")||t.includes("no volume is provided by the data vendor")}const l=new Map([["This script is invite-only",r.solutionIds.PUBLIC_INVITE_ONLY_SCRIPTS]]),d=new Map([["Volume Profile indicator available only on our upgraded plans","volumeProfile"]]),u=s.t(null,void 0,i(662011));var h;function c(e,t){if(e.type===h.Loading)return t?u:"loading...";if(e.type===h.Error){const i=e.errorDescription,s=t?(0,n.triesTranslateError)(i.error):i.error;if(i.ctx){const e={};return Object.entries(i.ctx).forEach((([t,i])=>{e[t]=i.toString()})),s.format(e)}return s}return""}function p(e){if(e.type===h.Error)return e.errorDescription.solution_id?e.errorDescription.solution_id:function(e){for(const t of Array.from(l.keys()))if(e.includes(t))return l.get(t)}(e.errorDescription.error)}function m(e){var t;if(e.type===h.Error)return a(e.errorDescription.error)?o:(0,n.triesTranslateError)(null!==(t=e.errorDescription.title)&&void 0!==t?t:"Runtime error")}function _(e){const{errorDescription:{error:t}}=e;for(const[e,i]of d)if(t.startsWith(e))return i}function g(e){if(void 0===e)return;const t=[];for(const i of e){const e={functionOrScopeName:i.n,lineNumber:i.p};"id"in i&&(e.id=i.id),"v"in i&&(e.versionScript=i.v),t.push(e)}return t}function f(e,t){return"BISTMIXED"===t&&a(e.error)&&(e.error="VOLUME_BIST_MIXED",e.solution_id=r.solutionIds.BIST_MIXED_SUBSCRIPTION,e.title=o),{type:h.Error,errorDescription:e}}!function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(h||(h={}))},157504:(e,t,i)=>{"use strict";i.d(t,{areEqualSymbols:()=>r,compareSymbolParams:()=>d,symbolParams:()=>l,symbolSameAsCurrent:()=>a});i(764829);var s=i(975179),n=i(378975);function r(e,t){return void 0===e?void 0===t:void 0!==t&&e.toUpperCase()===t.toUpperCase()}function o(e,t){return e.some((e=>r(t,e)))}function a(e,t){if(null===t)return!1;if(t){if(r(t.full_name,e)||r(t.pro_name,e))return!0;if(r(t.ticker,e))return!0;if(t.aliases&&o(t.aliases,e))return!0;if(t.alternatives&&o(t.alternatives,e))return!0;if(0===e.indexOf("FRA:")&&r(t.pro_name,e.replace("FRA:","FWB:")))return!0}return!1}function l(e){return{symbol:e.symbol(),currency:e.currency(),unit:e.unit(),interval:e.interval(),style:e.style()}}function d(e,t,i){const{symbol:r,currency:o,unit:a,style:l,interval:d}=t,u=void 0!==r&&!e.symbolSameAsResolved(r);let h,c;const p=e.symbolInfo();null!==p?(h=void 0!==o&&!function(e,t){return null===e&&!(0,s.isConvertedToOtherCurrency)(t)||e===(0,s.symbolCurrency)(t)}(o,p),c=void 0!==a&&!function(e,t,i){return null===e&&!(0,s.isConvertedToOtherUnit)(t,i)||e===(0,s.symbolUnit)(t,i)}(a,p,i)):(h=void 0!==o&&o!==e.currency(),c=void 0!==a&&a!==e.unit());return{symbolChanged:u,intervalChanged:void 0!==d&&!n.Interval.isEqual(e.interval(),d),currencyChanged:h,unitChanged:c,styleChanged:void 0!==l&&l!==e.style(),styleChangeRequiresRestart:void 0!==l&&(0,s.styleChangeRequiresRestart)(l,e.style())}}},83810:(e,t,i)=>{"use strict";i.d(t,{TimeAxisView:()=>o})
;var s=i(432059),n=i(631088);class r{constructor(){this._data=null}setData(e){this._data=e}draw(e,t,i){if(null===this._data||!this._data.visible||0===this._data.text.length)return;const s=this._data;e.font=i.font;const r=Math.round(i.widthCache.measureText(e,s.text));if(r<=0)return;e.save();const o=i.paddingHorizontal,a=r+2*o,l=a/2;let d=s.coordinate,u=Math.floor(d-l)+.5;if(s.alwaysInViewPort){const e=s.width;u<0?(d+=Math.abs(0-u),u=Math.floor(d-l)+.5):u+a>e&&(d-=Math.abs(e-(u+a)),u=Math.floor(d-l)+.5)}const h=u+a,c=Math.ceil(0+i.borderSize+i.offsetSize+i.paddingTop+i.fontSize+i.paddingBottom),{horizontalPixelRatio:p,verticalPixelRatio:m}=t;e.fillStyle=s.background;const _=Math.round(u*p),g=Math.round(0*m),f=Math.round(h*p),v=Math.round(c*m),y=Math.round(2*p);e.beginPath(),e.moveTo(_,g),e.lineTo(_,v-y),e.arcTo(_,v,_+y,v,y),e.lineTo(f-y,v),e.arcTo(f,v,f,v-y,y),e.lineTo(f,g),e.fill();const w=0+i.borderSize+i.offsetSize+i.paddingTop+i.fontSize/2;e.textAlign="left",e.textBaseline="middle",e.fillStyle=s.color;const b=i.widthCache.yMidCorrection(e,"Apr0");e.translate((u+o)*p,(w+b)*m),(0,n.drawScaled)(e,p,m,(()=>e.fillText(s.text,0,0))),e.restore()}}class o{constructor(e){this._renderer=new r,this._rendererData={background:"",color:"",coordinate:0,text:"",visible:!1,width:0,alwaysInViewPort:!0},this._invalidated=!0,this._model=e,this._renderer.setData(this._rendererData)}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}coordinate(){return this._rendererData.coordinate}_getAlwaysInViewPort(){return!0}_getText(e){const t=this._model.timeScale().indexToUserTime(e);return null!==t?this._model.dateTimeFormatter().format(t):""}_updateImpl(){const e=this._rendererData;if(e.visible=!1,this._model.timeScale().isEmpty()||!this._isVisible())return;const t=this._getIndex();null!==t&&Number.isFinite(t)&&(e.visible=!0,e.width=this._model.timeScale().width(),e.background=this._getBgColor(),e.color=(0,s.colorFromBackground)(e.background),e.coordinate=this._model.timeScale().indexToCoordinate(t),e.alwaysInViewPort=this._getAlwaysInViewPort(),e.text=this._getText(t),this._invalidated=!1)}}},501571:(e,t,i)=>{"use strict";i.d(t,{INVALID_TIME_POINT_INDEX:()=>s,UNPLOTTABLE_TIME_POINT_INDEX:()=>n});const s=-2e6,n=-1e6},169115:(e,t,i)=>{"use strict";window.TradingView=window.TradingView||{},i(778785).setClasses(),i(49817),i(128327).install(),i(638456),i(124829),i(466281),i(668159),i(817099),i(934440),i(829075),i(125226),i(49437),i(716004),i(84804),i(62802)},841264:(e,t,i)=>{"use strict";i(728566),i(169115);var s=i(650151),n=i(62802),r=i.n(n),o=i(764829);o.enabled("use_localstorage_for_settings")&&r().sync(void 0);var a=i(444372),l=i(211183),d=i(527904),u=i(616465),h=i(326988),c=i(345297),p=i(583912),m=i(268552),_=i.n(m),g=i(934440),f=i.n(g),v=i(625545),y=i(975179),w=i(378975),b=i(395394);function S(){return Promise.all([i.e(11638),i.e(86401),i.e(45702)]).then(i.bind(i,325949))}var x=i(375397);class P{constructor(e,t){this._visibility=new x.WatchedValue(!1),
this._dialogPromise=null,this._dialog=null,this._chartWidgetCollection=e,this._options=t}visible(){return this._visibility.readonly()}show(e,t,i){var s,n,r;const o=Array.isArray(e)?e:[],a=Array.isArray(e)?void 0:e;null===this._dialog&&this._requestDialog(null!=o?o:[],t,i,a),null===(s=this._dialog)||void 0===s||s.open(null!=o?o:[],null===(r=null===(n=this._options)||void 0===n?void 0:n.indicatorsPreloader)||void 0===r?void 0:r.getIndicatorPromises(),t,i,a)}hide(){var e;null===(e=this._dialog)||void 0===e||e.hide()}getDialog(){return this._dialog}resetAllPages(){var e;null===(e=this._dialog)||void 0===e||e.resetAllStudies()}_requestDialog(e,t,s,n){var r;if(null===this._dialogPromise){let o;o=(null===(r=this._options)||void 0===r?void 0:r.onWidget)?Promise.all([i.e(69491),i.e(75816),i.e(93703),i.e(46445),i.e(62093),i.e(44524),i.e(2520),i.e(21356),i.e(49481),i.e(53953),i.e(22164),i.e(59258),i.e(82421),i.e(67158),i.e(75826),i.e(72197),i.e(45621),i.e(98734),i.e(24125),i.e(93523),i.e(87393),i.e(32736),i.e(17762),i.e(39967),i.e(86314),i.e(49745),i.e(40796),i.e(98858),i.e(11858),i.e(11792),i.e(82321),i.e(87473),i.e(73026),i.e(8458),i.e(36391),i.e(6456)]).then(i.bind(i,162938)).then((e=>new e.IndicatorsLibraryContainer(this._chartWidgetCollection,this._options))):Promise.all([i.e(69491),i.e(75816),i.e(93703),i.e(46445),i.e(62093),i.e(44524),i.e(2520),i.e(21356),i.e(49481),i.e(53953),i.e(22164),i.e(59258),i.e(82421),i.e(67158),i.e(75826),i.e(72197),i.e(45621),i.e(98734),i.e(24125),i.e(93523),i.e(87393),i.e(32736),i.e(17762),i.e(39967),i.e(86314),i.e(49745),i.e(40796),i.e(98858),i.e(11858),i.e(11792),i.e(82321),i.e(87473),i.e(73026),i.e(8458),i.e(36391),i.e(6456)]).then(i.bind(i,21801)).then((e=>new e.IndicatorsContainer(this._chartWidgetCollection))),this._dialogPromise=o.then((i=>{var r,o;this._dialog=i,this._dialog.visible().subscribe((e=>{this._visibility.setValue(e)})),this._dialog.open(e,null===(o=null===(r=this._options)||void 0===r?void 0:r.indicatorsPreloader)||void 0===o?void 0:o.getIndicatorPromises(),t,s,n)}))}return this._dialogPromise}}var I=i(872220),T=i(518594),C=i(331633),E=i(778785),A=i(563360),L=i(468302);const D={8:[A.timeFrames.ytd,A.timeFrames["12m"],A.timeFrames["60m"],A.timeFrames.all],3:[A.timeFrames["1d"],A.timeFrames["5d"],A.timeFrames["1m"],A.timeFrames["3m"],A.timeFrames["6m"],A.timeFrames.ytd,A.timeFrames["12m"],A.timeFrames["60m"],A.timeFrames.all]};function M(e,t){return null!==e?(D[3]||[]).filter((t=>null===(0,L.getResolutionUnsupportedReason)(e,t.targetResolution))):(9===t&&(t=3),6===t&&(t=8),D[t]||[])}function V(e,t,i){const s={name:e,frameElementId:t,data:i};window.parent.postMessage(s,"*")}function k(e,t){function i(i){i.data&&i.data.name&&i.data.name===e&&t(i.data.data)}return window.addEventListener("message",i,!1),()=>{window.removeEventListener("message",i,!1)}}var R,N;function B(e){
return"seekingalpha"===e||"smartlab-custom"===e?Promise.all([i.e(37578),i.e(93703),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(22164),i.e(46489),i.e(74600),i.e(75826),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(32175),i.e(44066),i.e(17175),i.e(39963),i.e(32736),i.e(84353),i.e(65891),i.e(19478),i.e(55206),i.e(16164),i.e(69504),i.e(47534),i.e(46190),i.e(55428),i.e(779),i.e(40796),i.e(90283),i.e(55276),i.e(80532),i.e(82321),i.e(24961),i.e(44826),i.e(61677),i.e(8133)]).then(i.bind(i,208133)):"cme"===e?Promise.all([i.e(30007),i.e(93703),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(22164),i.e(46489),i.e(74600),i.e(75826),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(32175),i.e(44066),i.e(17175),i.e(39963),i.e(32736),i.e(84353),i.e(65891),i.e(19478),i.e(55206),i.e(16164),i.e(69504),i.e(47534),i.e(46190),i.e(55428),i.e(779),i.e(40796),i.e(90283),i.e(55276),i.e(82321),i.e(24961),i.e(44826),i.e(61677),i.e(3397)]).then(i.bind(i,103397)):Promise.all([i.e(71747),i.e(93703),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(22164),i.e(46489),i.e(74600),i.e(75826),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(32175),i.e(44066),i.e(17175),i.e(39963),i.e(32736),i.e(84353),i.e(65891),i.e(19478),i.e(55206),i.e(16164),i.e(69504),i.e(47534),i.e(46190),i.e(55428),i.e(779),i.e(40796),i.e(90283),i.e(55276),i.e(82321),i.e(24961),i.e(44826),i.e(61677),i.e(46615)]).then(i.bind(i,746615))}!function(e){let t;!function(e){e.SetSymbol="set-symbol",e.SetInterval="set-interval"}(t=e.Names||(e.Names={}))}(R||(R={})),function(e){let t;!function(e){e.SymbolClick="tv-widget-symbol-click",e.WidgetLoad="tv-widget-load",e.WidgetReady="tv-widget-ready",e.ResizeIframe="tv-widget-resize-iframe",e.NoData="tv-widget-no-data"}(t=e.Names||(e.Names={}))}(N||(N={}));var O=i(419283),F=i(627620),z=i(638456),W=i(470316);const H=["LineToolTrendLine","LineToolRay","LineToolInfoLine","LineToolExtended","LineToolRegressionTrend","LineToolRotatedRectangle","LineToolParallelChannel","LineToolFlatBottom","LineToolDisjointAngle","LineToolPitchfork","LineToolSchiffPitchfork","LineToolSchiffPitchfork2","LineToolInsidePitchfork","LineToolVertLine","LineToolCrossLine","LineToolHorzLine","LineToolHorzRay","LineToolTrendAngle"];function U(e,t=!1,r=!1){if(!o.enabled("popup_hints"))return;const l=e.getContainer();let d=null,u=null,h=null;function c(e,t){if(u)u.show(e,m.bind(null,t));else{const s=O.tool.value();Promise.all([i.e(62093),i.e(32690),i.e(82321),i.e(26166)]).then(i.bind(i,410837)).then((i=>{u=new i.ChartEventHintRenderer(l),s===O.tool.value()&&u.show(e,m.bind(null,t))}))}}function p(e){return!Boolean(n.getBool(e))}function m(e){n.setValue(e,!0,{forceFlush:!0}),(0,s.ensureNotNull)(u).destroy(),null!==h&&h(),u=null}O.tool.subscribe((function(){const t=O.tool.value(),s=z.CheckMobile.any();if(null==d||d.hide(),r&&s&&function(e){return H.includes(e)}(t))return void async function(t){{const s=()=>(0,O.resetToCursor)(!0);if(d)d.show(t,s);else{
const{DrawingHintsRenderer:n}=await Promise.all([i.e(71731),i.e(22164),i.e(96795),i.e(82321),i.e(35858)]).then(i.bind(i,953745));d=new n(e),t===O.tool.value()&&d.show(t,s)}}}(t);if(!p("hint.touchPainting"))return;const n=(0,F.isLineToolDrawWithoutPoints)(t);!(0,F.isStudyLineToolName)(t)||"LineToolRegressionTrend"===t||n||s?(0,F.isLineToolName)(t)&&!(0,F.isLineDrawnWithPressedButton)(t)&&!n&&s?c(a.t(null,void 0,i(360663)),"hint.touchPainting"):u&&u.hide():c(a.t(null,void 0,i(414985)),"hint.touchPainting")})),O.createdLineTool.subscribe(null,(function(){const e=O.tool.value();"LineToolPath"===e&&p("hint.finishBuildPathByDblClick")?c(a.t(null,void 0,i(275296)),"hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&p("hint.finishBuildPolylineByDblClick")&&c(a.t(null,void 0,i(317409)),"hint.finishBuildPolylineByDblClick")})),O.finishedLineTool.subscribe(null,(function(){if(u){const e=O.tool.value();"LineToolPath"===e?m("hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&m("hint.finishBuildPolylineByDblClick")}})),e.layoutSizesChanged().subscribe((function(){if(!p("hint.startResizingChartInLayout"))return;c(z.CheckMobile.any()?a.t(null,void 0,i(436539)):a.t(null,void 0,i(9430)),"hint.startResizingChartInLayout")})),t||z.CheckMobile.any()||!p("hint.startFocusedZoom")||(h=function(e,t){let i=!1;const s=n=>{n?(i&&t(n),e.onZoom().unsubscribe(null,s)):i||(t(n),i=!0)};return e.onZoom().subscribe(null,s),()=>e.onZoom().unsubscribe(null,s)}(e,(function(e){if(!p("hint.startFocusedZoom"))return;if(e)u&&(h=null,m("hint.startFocusedZoom"));else{const e=W.isMacKeyboard?"":"Ctrl";c(a.t(null,void 0,i(681712)).format({key:e}),"hint.startFocusedZoom")}})))}var K=i(251954);function G(e,t){const n=a.t(null,void 0,i(337367)).format({emoji:""}),r=a.t(null,void 0,i(569804)).format({emoji:""}),o=a.t(null,void 0,i(506655)).format({emoji:""});K.on("onServerScreenshotCopiedToClipboard",(()=>u(n)),null),K.on("onClientScreenshotCopiedToClipboard",(()=>u(r)),null),K.on("onServerScreenshotEmbedCodeCopiedToClipboard",(()=>u(o)),null);let l=null;const d=e.getContainer();function u(e){l?l.show(e):Promise.all([i.e(44524),i.e(3062),i.e(76821),i.e(82321),i.e(30092)]).then(i.bind(i,360126)).then((i=>{l||(l=new i.ChartScreenshotHintRenderer((0,s.ensureNotNull)(d),{bottomPadding:t.seriesControlBarEnabled}),l.show(e))}))}}var j=i(261309),X=i(564894);class q{constructor(e=[]){this._list={id:"DEFAULT_SINGLE_WATCHLIST",type:"custom",name:a.t(null,void 0,i(512504)),description:null,symbols:[...e],shared:!1,persistedState:null}}getCustomWatchLists(){return Promise.resolve([this._list])}getSymbols(e){return Promise.resolve(this._list.symbols)}createWatchList(e){throw new Error("not implemented")}putWatchList(e){throw new Error("not implemented")}removeWatchList(e){throw new Error("not implemented")}renameWatchList(e,t){return Promise.resolve(null)}replaceSymbols(e,t){return this._list.symbols=[...t],Promise.resolve(this._list.symbols)}addSymbols(e,t){return this._list.symbols.push(...t),Promise.resolve(this._list.symbols)}removeSymbols(e,t){
return this._list.symbols=this._list.symbols.filter((e=>!t.includes(e))),Promise.resolve(this._list.symbols)}setActive(e){return Promise.resolve(this._list)}getActive(){return Promise.resolve(this._list)}changeDescription(e,t){throw new Error("not implemented")}getCustomWatchlist(e){throw new Error("not implemented")}renameSeparator(e,t,i){return Promise.resolve(null)}}var $=i(79342),J=i(942634);const Y=new J.Delegate,Z=new J.Delegate,Q=new J.Delegate,ee=new J.Delegate,te=new J.Delegate;class ie{constructor(e=[],t=n){if(this._lists={},this._activeListSettingsKey="widgetbar.widget.watchlist",o.enabled("trading_terminal")&&(this._activeListSettingsKey+="terminal"),this._settings=t,this._settings.onSync.subscribe(this,this._updateLists),this._updateLists(),0===Object.keys(this._lists).length){const t=this._createList({title:this._pickTitle(),symbols:[...e]});this.setActive({id:t.id,type:"custom"})}}destroy(){this._settings.onSync.unsubscribeAll(this)}getCustomWatchLists(){this._updateLists();const e=[];return Object.keys(this._lists).forEach((t=>{const i=this._getList(t);i&&e.push(this._toSymbolList(i))})),Promise.resolve(e)}createWatchList(e){const t=this._createList({id:e.id,title:e.name||this._pickTitle(),symbols:e.symbols||[]});return Q.fire(t.id,[...t.symbols]),Promise.resolve(this._toSymbolList(t))}putWatchList(e){this._updateLists();const t=this._getList(e.id),i=null==t?void 0:t.title,s=e.name;return this.saveList({id:e.id,symbols:e.symbols,title:e.name}),void 0!==i&&i!==s&&te.fire(e.id,i,s),null!==t?Y.fire(e.id):Q.fire(e.id,e.symbols),Promise.resolve(e)}removeWatchList(e){const{id:t}=e;return this._settings.remove(`savedwatch.${t}`,{forceFlush:!0}),delete this._lists[t],ee.fire(t),Promise.resolve()}renameWatchList(e,t){this._updateLists();const{name:i}=e;return e.name=t,this.saveList({id:e.id,symbols:e.symbols,title:t}),te.fire(e.id,i,t),Promise.resolve(null)}replaceSymbols(e,t){const i=this._getList(e.id);return null===i||(i.symbols=[...t],this.saveList(i),Y.fire(e.id)),Promise.resolve(null)}addSymbols(e,t){const i=this._getList(e.id);return null===i?Promise.resolve([]):(i.symbols.push(...t),this.saveList(i),Y.fire(e.id),Promise.resolve([...i.symbols]))}removeSymbols(e,t){const i=this._getList(e.id);return null===i?Promise.resolve([]):(i.symbols=i.symbols.filter((e=>!t.includes(e))),this.saveList(i),Y.fire(e.id),Promise.resolve([...i.symbols]))}setActive(e){return this._settings.setValue(this._activeListSettingsKey,e.id),Z.fire(),Promise.resolve(null)}getActive(){const e=this._getActive();return Promise.resolve(this._toSymbolList(e))}changeDescription(e,t){throw new Error("not implemented")}renameSeparator(e,t,i){this._updateLists();const s=this._getList(e);if(null===s)return Promise.resolve(null);const n=s.symbols.findIndex((e=>e===t));return s.symbols[n]=i,this.saveList(s),Y.fire(e),Promise.resolve(null)}saveList(e){const t={symbols:e.symbols,title:String(e.title)};this._settings.setJSON(`savedwatch.${e.id}`,t,{forceFlush:!0}),this._lists[e.id]=t}getCustomWatchlist(e){throw new Error("not implemented")}
_createList(e){var t;const i={id:null!==(t=e.id)&&void 0!==t?t:(0,$.randomHash)(),symbols:e.symbols,title:e.title};return this.saveList(i),i}_getList(e){if(this._updateLists(),this._lists.hasOwnProperty(e)){const t=this._lists[e];return{id:e,symbols:t.symbols.slice(),title:t.title}}return null}_toSymbolList(e){return{type:"custom",id:e.id,name:e.title,description:null,symbols:e.symbols,shared:!1,persistedState:null}}_updateLists(){this._lists={};this._settings.keys().forEach((e=>{const t=/^savedwatch\.(.*)$/.exec(e);if(!t)return;const i=t[1],s=this._settings.getJSON(e,null);s&&(s.symbols||(s.symbols=[]),this._lists[i]=s)}))}_getActive(){const e=this._settings.getValue(this._activeListSettingsKey),[t,i]=Object.entries(this._lists)[0],s={id:t,...i};return void 0!==e&&this._getList(e)||s}_pickTitle(){this._updateLists();const e=Object.keys(this._lists).map((e=>this._lists[e].title));for(let t=1;;t++){const s=a.t(null,void 0,i(512504))+(t>1?` (${t})`:"");if(-1===e.indexOf(s))return s}}}var se=i(581996);class ne{constructor(e){this._document=e,this.isFullscreen=new x.WatchedValue;const t=()=>{const e=["fullscreenElement","webkitFullscreenElement","mozFullscreenElement","mozFullScreenElement","msFullscreenElement"];for(let t=0;t<e.length;t++){const i=e[t];if(i in this._document){this.isFullscreen.setValue(!!this._document[i]);break}}};t();for(const i of["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"])e.addEventListener(i,t,!1)}enter(){const e=this._document.documentElement;for(const t of["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen"])if("function"==typeof e[t]){e[t]();break}this.isFullscreen.setValue(!0)}exit(){const e=this._document;for(const t of["exitFullscreen","mozCancelFullScreen","mozExitFullscreen","webkitExitFullscreen","msExitFullscreen"])if("function"==typeof e[t]){e[t]();break}this.isFullscreen.setValue(!1)}}class re{constructor(e){this.isFullscreen=new x.WatchedValue,this._handleExit=e=>{27!==(0,W.hashFromEvent)(e)||e.defaultPrevented||(e.preventDefault(),this.exit())},this._element=e}enter(){this.isFullscreen.setValue(!0),K.emit("onInternalFullscreenShow"),this._element.addEventListener("keydown",this._handleExit)}exit(){this.isFullscreen.setValue(!1),K.emit("onInternalFullscreenHide"),this._element.removeEventListener("keydown",this._handleExit)}}var oe=i(554433),ae=i(314802);function le(e,t){let i=0;for(const{min:s,max:n}of t){if(e<s||n<s)continue;const t=Math.min(e,n);if(i=Math.max(i,t),e===i)break}return i}function de(e){const t=[];if(void 0===e)return[];Array.isArray(e)||(e=[e]);for(const i of e){let e,s;isFinite(i)?e=s=Number(i):(e=+i.min,s=+i.max),(e<0||isNaN(e))&&(e=0),isNaN(s)&&(s=1/0),e<=s&&s>0&&t.push({min:e,max:s})}return t.sort(((e,t)=>e.min-t.min||e.max-t.max)),t}function ue(e,t){if(e.length!==t.length)return!1;for(let i=e.length;i--;){if(e[i].min!==t[i].min)return!1;if(e[i].max!==t[i].max)return!1}return!0}const he=o.enabled("no_min_chart_width"),ce=o.enabled("bypass_chart_height_check");function pe(e){
const t=o.enabled("side_toolbar_in_fullscreen_mode"),i=o.enabled("header_in_fullscreen_mode");return"center"===e||"left"===e&&t||"top"===e&&i}const me=[...M(null,3)];me.splice(7,0,A.timeFrames["24m"]);var _e=i(971417),ge=i(201871),fe=i(459423);const ve={whitelabel:!0,permissionOverrides:!0};var ye=i(125226),we=i(768261),be=i(439563);var Se,xe,Pe,Ie,Te;i(563349);const Ce=(0,ye.isFeatureEnabled)("disable-calendar-advanced-chart-widget"),Ee=window.initData,Ae=window.initData.widgetDefaults,Le=function(e,t=[],i){return function(e,t,i,s=[],n){const r=i.slice(1),o=decodeURIComponent(r);let a={};try{""!==o&&(a=JSON.parse(o),void 0!==n&&n(e,a),Object.keys(a).forEach((e=>{(ve[e]||s.includes(e))&&delete a[e]})))}catch(e){a={},console.warn("Hash params parsing error! Hash params ignored.")}const l=t.slice(1),d=t.includes("%")?decodeURIComponent(l):t,u=new URLSearchParams(d);let h={};try{u.forEach(((e,t)=>{s.includes(t)||(h[t]=e)})),void 0!==n&&n(e,h)}catch(e){h={},console.warn("Search query params parsing error! Search query params ignored.")}return Object.assign({},e,a,h)}(e,location.search,location.hash,t,i)}(Ae);try{!async function(e){var t;Math.random()>.005||null===(t=await(0,be.getEmbedWidgetTracker)())||void 0===t||t.trackWidgetLoadMetaInfo(e)}({widget_id:"advanced-chart",symbols:JSON.stringify([Le.symbol]),customer:Le.customer})}catch(e){}Ce&&(Le.calendar=!1);const De=void 0!==Le.extended_hours?at(Le.extended_hours)?"extended":"regular":void 0!==Ae.def_extended_hours?at(Ae.def_extended_hours)?"extended":"regular":Ae.def_session_id;const Me=Ae.customer,Ve=Ae.customerReadableName,ke=Le.range||Ae.def_range,Re=at(null!==(Se=Le.withdateranges)&&void 0!==Se?Se:Ae.def_withdateranges),Ne=at(null!==(xe=Le.save_image)&&void 0!==xe?xe:Ee.def_save_image,!0);let Be;(void 0===Le.allow_symbol_change?at(Ae.def_hide_symbol_edit):!at(Le.allow_symbol_change))&&(o.setEnabled("header_symbol_search",!1),o.setEnabled("disable_legend_inplace_symbol_change",!0)),o.setEnabled("header_screenshot",Boolean(Ne)),"bovespa"===Me&&(o.disable("header_settings"),Be=[{symbol:"IBOV",title:"Bovespa Index"},{symbol:"IBXX",title:"Brazil 100 Index"},{symbol:"IBXL",title:"Brazil 50 Index"},{symbol:"IBRA",title:"Brazil Broad-Based Index"},{symbol:"IGCX",title:"Special Corporate Governance Stock Index"},{symbol:"ITAG",title:"Special Tag-Along Stock Index"},{symbol:"IGNM",title:"Novo Mercado Corporate Governance Equity Index"}]),window.pro=new h.Pro(window.shopConf);let Oe=Le.symbol||Ae.def_symbol||window.DEFAULT_SYMBOL;"cme"===Le.symbology&&(Oe=(e=>{var t;const i=new(_().SymbolToken)(e);if(!i.root())return e;const s=c.CMEToTVSymbologyAdapter.convertSymbolDataToTV(i.root(),i.exchange(),null!==(t=Le.venue)&&void 0!==t?t:"");return"ok"!==s.status?e:(s.data.symbol&&i.root(s.data.symbol),s.data.exchange&&i.exchange(s.data.exchange),i.toString())})(Oe));const Fe=f()(parent),ze=[];let We,He=[];if(Le.watchlist&&(He=(Array.isArray(Le.watchlist)?Le.watchlist:Le.watchlist.split(/\x1f/)).map((e=>e.trim())).filter(Boolean)),He.length||Le.editablewatchlist){const e={
type:"watchlist",properties:{list:He}};Le.editablewatchlist?(e.readonly=!1,e.data={hideTitleButton:!0},e.settingsKey="onwidget.watchlist",e.unAuthEditable=!0,function(e){const t=new ie(e);(0,X.registerService)(j.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE,t)}(He)):function(e){const t=new q(e);(0,X.registerService)(j.SYMBOL_LIST_REPOSITORY_BACKEND_SERVICE,t)}(He),ze.push(e)}at(Le.details)&&ze.push({type:"detail"}),void 0!==Le.widgetbar_width&&(We=+Le.widgetbar_width),(!We||!isFinite(We)||We<200)&&(We=200);const Ue=ze.length?[{name:"base",title:a.t(null,void 0,i(708675)),icon:"base",widgets:ze.map((e=>e))}]:[];Le.hotlist&&Ue.push({name:"hotlist",title:a.t(null,void 0,i(840095)),icon:"hotlists",widgets:[{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:{default:window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE.en},groupByLocale:{default:"percent_change_loosers"}}}]}),Le.calendar&&Ue.push({name:"calendar",title:a.t(null,void 0,i(839643)),icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{}}]});const Ke=new class{constructor(e,t){this._updateDocumentHeight=e=>{"visual"===this._viewportType&&this._window.document.documentElement.style.setProperty("height",`${e}px`,"important")},this._window=e,this._fullscreenApi=t?new re(e.document.body):new ne(e.document),this._viewportType=z.CheckMobile.iOS()&&!(0,ae.isOnMobileAppPage)("any")&&this._window.visualViewport?"visual":"quirks","visual"===this._viewportType?this._viewport=(0,s.ensure)(this._window.visualViewport):this._viewport=this._window;const i=this._layoutSizeSensor=this._window.document.createElement("div");i.id="layout-size-sensor",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.right="0",i.style.bottom="0",i.style.pointerEvents="none",i.style.visibility="hidden",this._initFullscreen()}allocate(){this.free();const e=this._window.document,t=e.createElement("div");t.classList.add("js-rootresizer__contents"),t.style.position="relative",t.style.width="100%",t.style.height="100%",e.body.insertAdjacentElement("afterbegin",t),e.body.insertAdjacentElement("afterbegin",this._layoutSizeSensor),this._visibilityApi=new oe.VisibilityApi(this._window.document);const i={alive:new x.WatchedValue(!0),fullscreenable:new x.WatchedValue(!0),container:new x.WatchedValue(t),width:new x.WatchedValue,height:new x.WatchedValue,availWidth:new x.WatchedValue,availHeight:new x.WatchedValue,visible:this._visibilityApi.isVisible,fullscreen:this._fullscreenApi.isFullscreen,remove:()=>{i.alive.setValue(!1)},attach:()=>{i.alive.setValue(!1),this._window.close()},requestFullscreen:()=>{this._requestFullscreen()},exitFullscreen:()=>{this._exitFullscreen()}};return i.alive.subscribe((e=>{e||i!==this._area||this.free()})),this._area=i,this._resizeHandler=()=>{
const e=this._width(i)||800,t=this._height(i)||600;i.availHeight.setValue(t),i.availWidth.setValue(e),i.height.setValue(t),i.width.setValue(e)},this._area.height.subscribe(this._updateDocumentHeight,{callWithLast:!0}),this._resizeHandler(),this._viewport.addEventListener("resize",this._resizeHandler),new se.ResizerDetacherState(i).bridge()}free(){if(this._resizeHandler&&(this._viewport.removeEventListener("resize",this._resizeHandler),this._resizeHandler=void 0),this._visibilityApi&&(this._visibilityApi.destroy(),this._visibilityApi=void 0),this._area){const e=this._area;this._area=void 0,e.height.unsubscribe(this._updateDocumentHeight),e.alive.setValue(!1);const t=e.container.value(),i=null==t?void 0:t.parentElement;i&&(i.removeChild(t),i.removeChild(this._layoutSizeSensor))}}_height(e){if("visual"===this._viewportType)return this._layoutSizeSensor.clientHeight;return e.container.value().clientHeight}_width(e){return e.container.value().clientWidth}_requestFullscreen(){this._fullscreenApi.enter()}_exitFullscreen(){this._fullscreenApi.exit()}_initFullscreen(){this._fullscreenApi.isFullscreen.subscribe((e=>{this._resizeHandler&&this._resizeHandler()}))}}(window),Ge=new class{constructor(e){this._processVisibility=e=>{const t=e.container.value();return this.affectsLayout(e.name)?(t&&t.classList.toggle("js-hidden",!1),!0):(t&&t.classList.toggle("js-hidden",!0),!1)},this._setWidth=(e,t,i)=>{let s=i;this._fullscreenArea!==e.name&&(e.availWidth.setValue(i),e.canNegotiate.width&&(s=le(i,e.negotiations.width))),t||(s=0);const n=e.container.value();return n&&t&&(n.style.width=s+"px"),e.width.setValue(s),s},this._setHeight=(e,t,i)=>{let s=i;this._fullscreenArea!==e.name&&(e.availHeight.setValue(i),e.canNegotiate.height&&(s=le(i,e.negotiations.height))),t||(s=0);const n=e.container.value();return n&&t&&(n.style.height=s+"px"),e.height.setValue(s),s};const t=e.container.value();if(!t)throw new Error("bridge.container.value() must be an element");this._container=t,this._availableAreas=["left","tradingpanel","right","top","bottom","center","topleft","extratop"],this._areas={},this._bridge=e,this._width=e.width,this._height=e.height,this._width.subscribe((()=>this.recalculate())),this._height.subscribe((()=>this.recalculate())),this._bridge.visible.subscribe((()=>this._updateVisibility())),this._bridge.fullscreen.subscribe((()=>this._onParentFullscreenChange())),this.recalculate()}allocate(e){const t=e&&e.areaName;if(-1===this._availableAreas.indexOf(t))throw new Error("unknown options.areaName");this.free(t);const i=this._createDOM(t),s={name:t,canNegotiate:{width:"left"===t||"right"===t||"tradingpanel"===t||"topleft"===t,height:"top"===t||"bottom"===t||"topleft"===t||"extratop"===t},negotiations:{width:[],height:[]},remove:()=>{for(const e in this._areas)this._areas[e]===s&&this.free(e)},negotiateWidth:e=>{if(!s.canNegotiate.width)return;const t=de(e);ue(s.negotiations.width,t)||(s.negotiations.width=t,this.recalculate())},negotiateHeight:e=>{if(!s.canNegotiate.height)return;const t=de(e)
;ue(s.negotiations.height,t)||(s.negotiations.height=t,this.recalculate())},requestFullscreen:()=>{this._fullscreenArea||("right"!==t&&"center"!==t||(this._fullscreenArea=t),"center"===t&&this._bridge.requestFullscreen(),this._updateFullscreen())},exitFullscreen:()=>{t===this._fullscreenArea&&(this._fullscreenArea=void 0,"center"===t&&this._bridge.exitFullscreen(),this._updateFullscreen())},width:new x.WatchedValue,height:new x.WatchedValue,availWidth:new x.WatchedValue,availHeight:new x.WatchedValue,alive:new x.WatchedValue(!0),container:new x.WatchedValue(i),visible:new x.WatchedValue(!0),fullscreen:new x.WatchedValue(!1),fullscreenable:new x.WatchedValue("right"===t||"center"===t),rdState:new se.ResizerDetacherState};return s.rdState.pushOwner(s),this._areas[t]=s,s.rdState.owner.subscribe((e=>{const i=s.container.value();if(e!==s)i&&(i.innerHTML="",i.parentElement&&i.parentElement.removeChild(i));else{let e=null;for(let i=this._availableAreas.indexOf(t);i--;){const t=this._availableAreas[i];if(this.affectsLayout(t)){e=this._areas[t].container.value();break}}i&&(e&&i.parentElement?i.insertAdjacentElement("afterend",e):this._container.appendChild(i))}this.recalculate()}),{callWithLast:!0}),s.rdState.bridge()}free(e){const t=this._areas[e];if(!t)return;this._areas[e]=void 0;const i=t.container.value();i&&i.parentElement&&i.parentElement.removeChild(i),t.alive.setValue(!1)}recalculate(){const e={};this._recalcSingleRunToken=e;const t=this._areas.topleft,i=this._areas.left,s=this._areas.tradingpanel,n=this._areas.right,r=this._areas.top,o=this._areas.bottom,a=this._areas.center,l=this._areas.extratop,d=this._width.value(),u=this._height.value();let h=0,c=0,p=0,m=0,_=0,g=0,f=0,v=0;if(e===this._recalcSingleRunToken&&l){const e=this._processVisibility(l);v=this._setHeight(l,e,u),this._setWidth(l,e,d)}if(e===this._recalcSingleRunToken&&t){const e=this._processVisibility(t);f=this._setHeight(t,e,u),g=this._setWidth(t,e,d);const i=t.container.value();e&&i&&(i.style.top=v+"px")}let y=0;if(e===this._recalcSingleRunToken&&r){const e=this._processVisibility(r),t=r.container.value();e&&t&&(t.style.left=g+"px",t.style.top=v+"px");const i=d-g;this._setWidth(r,e,i),h=this._setHeight(r,e,u),h&&(y=1)}if(e===this._recalcSingleRunToken&&i){const e=this._processVisibility(i),t=Math.max(f,h);p=this._setWidth(i,e,d),p&&(p+=4),p&&1===y&&(y=4);const s=i.container.value();e&&s&&(s.style.top=t+v+y+"px"),this._setHeight(i,e,u-t-v)}if(e===this._recalcSingleRunToken&&s){const e=this._processVisibility(s);let t=d-p;he||(t-=300),_=this._setWidth(s,e,t),_&&1===y&&(y=4),this._setHeight(s,e,u-v-h-y)}if(e===this._recalcSingleRunToken&&n){const e=this._processVisibility(n);let t=d-p-_;he||(t-=300),m=this._setWidth(n,e,t),m&&1===y&&(y=4),this._setHeight(n,e,u-v-h-y);const i=n.container.value();e&&i&&(i.style.top=h+v+y+"px")}const w=_+m;let b=0,S=d-p-_-m-(w?4:0);const x=Boolean(_||!w);if(!m&&_&&(S+=4),e===this._recalcSingleRunToken&&o){const e=this._processVisibility(o),t=o.container.value();e&&t&&(t.style.left=p+"px",
t.classList.toggle("no-border-top-left-radius",!p),t.classList.toggle("no-border-top-right-radius",x)),this._setWidth(o,e,S);const i=u-v;b=Math.min(300,i-0),c=this._setHeight(o,e,i)+4}const P=Boolean(h&&(p||w));if(this._container.classList.toggle("layout-with-border-radius",P),e===this._recalcSingleRunToken&&a){const e=this._processVisibility(a),t=a.container.value();e&&t&&(t.style.left=p+"px",t.style.top=h+v+y+"px",t.classList.toggle("no-border-bottom-left-radius",!c||!p),t.classList.toggle("no-border-bottom-right-radius",x||!c),t.classList.toggle("no-border-top-left-radius",Boolean(!p&&w)),t.classList.toggle("no-border-top-right-radius",x)),this._setWidth(a,e,S);const i=u-h-c-v-y;this._setHeight(a,e,Math.max(i,b))}if(e===this._recalcSingleRunToken&&s&&this.affectsLayout("tradingpanel")){const e=s.container.value();e&&(e.style.right=_&&m?`${m+4}px`:`${m}px`,e.style.top=v+h+y+"px",e.style.borderTopRightRadius=P&&m?"4px":"0px")}e===this._recalcSingleRunToken&&this._updateVisibility()}affectsLayout(e){const t=this._areas[e];if(!t)return!1;if(t.rdState.owner.value()!==t)return!1;if(this._fullscreenArea&&this._fullscreenArea!==e)return pe(e);if(this._width.value()<=567||this._height.value()<=445&&!ce){if(!["center","top","left","topleft","extratop"].includes(e))return!1}return!0}_updateVisibility(){const e=this._bridge.visible.value();for(let t=0;t<this._availableAreas.length;t++){const i=this._availableAreas[t],s=this._areas[i];s&&(e&&this.affectsLayout(i)?s.visible.setValue(!0):s.visible.setValue(!1))}}_onParentFullscreenChange(){this._bridge.fullscreen.value()||(this._fullscreenArea=void 0,this._updateFullscreen())}_updateFullscreen(){const e=void 0!==this._fullscreenArea;for(let t=0;t<this._availableAreas.length;t++){const i=this._availableAreas[t],s=this._areas[i];if(!s)continue;if(i===this._fullscreenArea){s.fullscreen.setValue(!0);continue}s.fullscreen.setValue(!1);const n=s.container.value();n&&n.classList.toggle("js-hidden",e&&!pe(i))}this._updateVisibility(),this.recalculate()}_createDOM(e){const t=document.createElement("div");return t.classList.add("layout__area--"+e),t.style.position="absolute","tradingpanel"===e&&(t.style.borderTopRightRadius="4px"),"bottom"===e?t.style.bottom="0":t.style.top="0","right"===e||"tradingpanel"===e?t.style.right="0":t.style.left="0",t}}(Ke.allocate()),je=at(Le.hide_top_toolbar)?null:Ge.allocate({areaName:"top"}),Xe=void 0===Le.hide_side_toolbar||+Le.hide_side_toolbar?null:Ge.allocate({areaName:"left"}),qe=Ge.allocate({areaName:"center"}),$e=Ue.length?Ge.allocate({areaName:"right"}):null;if((0,fe.setSupportPortalProblemsHost)(null!==(Pe=Le.support_host)&&void 0!==Pe?Pe:""),ke){const e=(Je=ke,me.find((e=>e.value.value===Je)));e&&(Le.range=ke,Le.interval=e.targetResolution)}var Je;let Ye,Ze;Ye=void 0===Le.interval?void 0===Le.style?null!==(Ie=Ae.def_interval)&&void 0!==Ie?Ie:"1":(0,b.getDefaultResolution)((0,y.isRangeStyle)(parseInt(Le.style))):Le.interval,Ze=void 0===Le.style?void 0===Le.interval?null!==(Te=Ae.def_style)&&void 0!==Te?Te:1:(0,
y.getDefaultStyle)(w.Interval.isRange(Le.interval)):parseInt(Le.style);const Qe=window.chartWidgetCollection=new d.ChartWidgetCollection({resizerBridge:qe,padding:5,edge:Number(Le.padding)||0,publishedChartsEnabled:!1,saveChartEnabled:!1,widgetOptions:{onWidget:!0,useUserChartPreferences:!at(Le.doNotStoreSettings,!1),addToWatchlistEnabled:!1,propertyPagesEnabled:!1,chartEventsEnabled:!Ce,newsNotificationsEnabled:!1,esdEnabled:o.enabled("esdonwidget"),sourceStatusesWidget:{errorSolution:!1},marketStatusWidgetEnabled:!0,chartWarningWidget:{subscriptionFullInfo:!1},widgetCustomer:Me,customerReadableName:Ve,hideIdeas:!0,controlBarEnabled:!0,addVolume:!at(Le.hide_volume),muteSessionErrors:!o.enabled("referral_program_for_widget_owners"),defSymbol:Oe,defInterval:Ye,defStyle:Ze,defSessionId:De,timezone:Le.timezone||Ae.def_timezone,defTimeframe:ke,isDrawingToolbarVisible:I.isDrawingToolbarVisible,watermarkEnabled:!0,paneContextMenuEnabled:!1,compareSymbols:Be,timeScaleWidget:{contextMenuEnabled:!1,timezoneMenuEnabled:!1},timeScale:{preserveBarSpacing:!0,lockVisibleTimeRangeOnResize:!1},legendWidgetEnabled:!at(Le.hide_legend),legendWidget:{contextMenu:{settings:!1,fundamentals:!1,showOpenMarketStatus:!0}},goToDateEnabled:!1,handleScroll:{vertTouchDrag:at(Le.verttouchdrag),horzTouchDrag:at(Le.horztouchdrag,!0)},handleScale:{mouseWheel:"investopedia"!==Me&&"eurex"!==Me},currencyConversionEnabled:!0,unitConversionEnabled:!0},seriesControlBarEnabled:!!Re,seriesControlBar:{timeFramesWidgetEnabled:!0,timeFramesWidget:{goToDateEnabled:!1,availableTimeFrames:M},timeWidgetEnabled:!0,timeWidget:{timezoneMenuEnabled:!1},adjustForDividendsButtonEnabled:!0,sessionIdButtonEnabled:Boolean(De),backAdjustmentButtonEnabled:!1,settlementAsCloseButtonEnabled:!1,percentageScaleButtonEnabled:!1,logScaleButtonEnabled:!1,autoScaleButtonEnabled:!1,fullscreenButtonEnabled:!0,mobileChangeLayoutEnabled:!1},mobileForceChartMaximizeEnabled:!1});let et=!1;Qe.onAboutToBeDestroyed.subscribe(null,(()=>{et=!0}),!0),Le.studies_overrides&&Qe.applyStudiesOverrides(JSON.parse(Le.studies_overrides)),Promise.all([i.e(12931),i.e(26258),i.e(24377),i.e(81395),i.e(97762),i.e(30187)]).then(i.bind(i,776503)).then((e=>{e.addBrandingSource(Qe)}));const tt=Qe.activeChartWidget.value();let it;if(window.chartWidget=tt,Qe.readOnly()||(window.studyMarket=new P(Qe,{onWidget:!0})),p.linking.bindToChartWidgetCollection(Qe),V(N.Names.WidgetLoad,Le.frameElementId||null,void 0),Le.theme){const e=Le.theme.toLowerCase(),t=T.themes[e];if(t&&((0,C.setTheme)(e),!t.noChartTheme)){const e=Le.theme&&Le.theme.toLowerCase(),t=T.getStdTheme(e);t&&t.content&&(it=t.content,Le.style&&(it.mainSourceProperties.style=parseInt(Le.style)),(0,l.applyDefaultsOverrides)(it,{mainSeriesProperties:"mainSourceProperties"},!0))}}let st=!1,nt=!1;function rt(e){return(0,_e.isPineIdString)(e)?{type:"pine",pineId:e}:{type:"java",studyId:e}}function ot(){document.querySelectorAll(".loading-indicator").forEach((e=>{e instanceof HTMLElement&&(e.style.display="none")}))}function at(e,t=!1){
return!1===e||!0===e?e:"1"===e||1===e||"true"===e||"0"!==e&&0!==e&&"false"!==e&&t}tt.withModel(null,(function(){const e=tt.model().mainSeries();tt.applyOverrides({"mainSeriesProperties.showCountdown":!1}),it&&tt.model().model().restoreTheme(it,!1),Le.backgroundColor&&tt.applyOverrides({"paneProperties.background":Le.backgroundColor,"paneProperties.backgroundType":ge.ColorType.Solid}),Le.gridColor&&tt.applyOverrides({"paneProperties.vertGridProperties.color":Le.gridColor,"paneProperties.horzGridProperties.color":Le.gridColor}),async function(e){if(!e)return;try{const t="string"==typeof e?JSON.parse(decodeURIComponent(e)):e;if(!Array.isArray(t)||0===t.length)return;const i=tt.model().model().mainSeries();for(let e=0;e<t.length;e++){const s=t[e];if(s.symbol&&s.position&&we.CompareOption[s.position])switch(s.position){case"SameScale":tt.addCompareAsOverlay(s.symbol,!1,i.isYield());break;case"NewPriceScale":tt.addOverlayStudy(s.symbol,!0);break;case"NewPane":tt.addOverlayStudy(s.symbol,!1)}}}catch(e){return}}(Le.compareSymbols),e.dataEvents().symbolResolved().subscribe(e,(()=>{!function(e,t){if(!t)return;const i=e.model().model();try{JSON.parse(decodeURIComponent(t)).forEach((e=>{const t=i.createStudyInserter(rt(e.id));t.setForceOverlay(e.overlay),t.insert((()=>Promise.resolve({inputs:e.inputs,parentSources:[]})))}))}catch(e){((Array.isArray(t)?t:t.split(/\x1f/))||[]).forEach((e=>{i.createStudyInserter(rt(e)).insert()}))}}(window.chartWidget,Le.studies)}),!0),e.dataEvents().completed().subscribe(this,(()=>{it&&ot(),U&&!st&&(U(Qe,!0),st=!0),G&&!nt&&(G(Qe,{seriesControlBarEnabled:!!Re}),nt=!0)})),e.dataEvents().symbolError().subscribe(null,(()=>{V(N.Names.NoData,Le.frameElementId||null,void 0)}))})),Xe&&(async()=>{
const[e,t,{DrawingToolbar:s},{default:n}]=await Promise.all([Promise.all([i.e(72698),i.e(93703),i.e(46445),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(46489),i.e(74600),i.e(75826),i.e(29800),i.e(23141),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(7001),i.e(71329),i.e(44066),i.e(17175),i.e(61135),i.e(32736),i.e(84353),i.e(82440),i.e(89255),i.e(19478),i.e(69504),i.e(47534),i.e(78687),i.e(48694),i.e(90283),i.e(41917),i.e(86339),i.e(1198),i.e(37153),i.e(46287),i.e(82321),i.e(87473),i.e(5483),i.e(7517),i.e(44826),i.e(82312),i.e(91890),i.e(73558)]).then(i.t.bind(i,50959,19)),Promise.all([i.e(72698),i.e(93703),i.e(46445),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(46489),i.e(74600),i.e(75826),i.e(29800),i.e(23141),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(7001),i.e(71329),i.e(44066),i.e(17175),i.e(61135),i.e(32736),i.e(84353),i.e(82440),i.e(89255),i.e(19478),i.e(69504),i.e(47534),i.e(78687),i.e(48694),i.e(90283),i.e(41917),i.e(86339),i.e(1198),i.e(37153),i.e(46287),i.e(82321),i.e(87473),i.e(5483),i.e(7517),i.e(44826),i.e(82312),i.e(91890),i.e(73558)]).then(i.t.bind(i,632227,19)),Promise.all([i.e(72698),i.e(93703),i.e(46445),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(46489),i.e(74600),i.e(75826),i.e(29800),i.e(23141),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(7001),i.e(71329),i.e(44066),i.e(17175),i.e(61135),i.e(32736),i.e(84353),i.e(82440),i.e(89255),i.e(19478),i.e(69504),i.e(47534),i.e(78687),i.e(48694),i.e(90283),i.e(41917),i.e(86339),i.e(1198),i.e(37153),i.e(46287),i.e(82321),i.e(87473),i.e(5483),i.e(7517),i.e(44826),i.e(82312),i.e(91890),i.e(73558)]).then(i.bind(i,449611)),Promise.all([i.e(72698),i.e(93703),i.e(46445),i.e(62093),i.e(2520),i.e(49481),i.e(53953),i.e(62564),i.e(46489),i.e(74600),i.e(75826),i.e(29800),i.e(23141),i.e(97384),i.e(72197),i.e(49325),i.e(43362),i.e(7001),i.e(71329),i.e(44066),i.e(17175),i.e(61135),i.e(32736),i.e(84353),i.e(82440),i.e(89255),i.e(19478),i.e(69504),i.e(47534),i.e(78687),i.e(48694),i.e(90283),i.e(41917),i.e(86339),i.e(1198),i.e(37153),i.e(46287),i.e(82321),i.e(87473),i.e(5483),i.e(7517),i.e(44826),i.e(82312),i.e(91890),i.e(73558)]).then(i.t.bind(i,490317,23))]);et||(t.render(e.createElement(s,{chartWidgetCollection:Qe,resizerBridge:Xe,screenshotButton:"cme"===Me}),Xe.container.value()),window.lineToolPropertiesToolbar=new n(Qe))})(),je&&(async()=>{const[e,t,s,{HeaderToolbar:n}]=await Promise.all([B(Me),Promise.all([i.e(42576),i.e(4896),i.e(37153),i.e(88411),i.e(82321),i.e(79022)]).then(i.t.bind(i,50959,19)),Promise.all([i.e(42576),i.e(4896),i.e(37153),i.e(88411),i.e(82321),i.e(79022)]).then(i.t.bind(i,632227,19)),Promise.all([i.e(42576),i.e(4896),i.e(37153),i.e(88411),i.e(82321),i.e(79022)]).then(i.bind(i,898899))]),r=await e.getToolSet(),o=E.mobiletouch?["full"]:void 0;s.render(t.createElement(n,{tools:r,chartApiInstance:window.ChartApiInstance,availableTimeFrames:M,chartWidgetCollection:Qe,ideas:!1,resizerBridge:je,popupButton:at(Le.show_popup_button),studyMarket:window.studyMarket,windowMessageService:Fe,isFundamental:!1,
allowedModes:o}),je.container.value())})(),$e&&(async()=>{const[{WidgetBar:e},{configuration:t}]=await Promise.all([Promise.all([i.e(30494),i.e(93703),i.e(62093),i.e(44524),i.e(2520),i.e(49481),i.e(62564),i.e(97384),i.e(61135),i.e(46879),i.e(29266),i.e(19478),i.e(49478),i.e(41917),i.e(47386),i.e(36299),i.e(86339),i.e(86542),i.e(9359),i.e(82321),i.e(50030),i.e(67087),i.e(14816),i.e(54876)]).then(i.bind(i,733740)),Promise.all([i.e(30494),i.e(93703),i.e(62093),i.e(44524),i.e(2520),i.e(49481),i.e(62564),i.e(97384),i.e(61135),i.e(46879),i.e(29266),i.e(19478),i.e(49478),i.e(41917),i.e(47386),i.e(36299),i.e(86339),i.e(86542),i.e(9359),i.e(82321),i.e(50030),i.e(67087),i.e(14816),i.e(54876)]).then(i.bind(i,667232))]);Ue.forEach((e=>{var t;e.widgets=null===(t=e.widgets)||void 0===t?void 0:t.filter((e=>!(void 0!==e.isEnabled&&!e.isEnabled)))}));window.widgetbar=new e({resizerBridge:$e,affectsLayout:()=>Ge.affectsLayout("right"),readonly:!0,state:{width:We,pages:Ue},showCloseButton:!0,configuration:()=>t({chartApiInstance:window.ChartApiInstance})})})(),tt.onDisconnected().subscribe(null,(e=>{var t;ot(),e&&(t=()=>{window.ChartApiInstance.disconnect(),setTimeout((()=>{window.ChartApiInstance.connect(),tt.reconnect()}),500)},S().then((e=>e.showCriticalErrorMessage(t))))})),tt.onReconnectBailout().subscribe(null,(()=>{var e;e=()=>{setTimeout((()=>{window.ChartApiInstance.connect()}),0)},S().then((t=>t.showDisconnectedMessage(e)))})),document.querySelectorAll(".tv-content").forEach((e=>{e.addEventListener("contextmenu",(e=>{e.target instanceof Element&&e.target.matches("input, textarea")||e.preventDefault()}))})),Le.whotrades&&o.setEnabled("whotrades_auth_only",!0),document.querySelectorAll(".loading-indicator").forEach((e=>{e.remove()})),(()=>{let e;const t=t=>{void 0!==e&&(0,v.getQuoteSessionInstance)("simple").unsubscribe("widgetQuoteListener",e),e=t,(0,v.getQuoteSessionInstance)("simple").subscribe("widgetQuoteListener",t,(e=>{const t=e.values,i=["change","change_percent","last_price","original_name","short_name","exchange","description","volume"],s={};for(let e=0;e<i.length;e++){const n=i[e];if(!t.hasOwnProperty(n))return;s[n]=t[n]}s.volume=1e100===t.volume?void 0:t.volume,Fe.post(parent,"quoteUpdate",s)}))};tt.withModel(null,(()=>{const e=tt.model().mainSeries();e.properties().childs().symbol.subscribe(e,(e=>{t(e.value())}))})),Fe.on("quoteSubscribe",(()=>{const e=tt.model().mainSeries().properties().childs().symbol.value();t(e)})),Fe.on("imageURL",((e,t)=>{var i;(0,u.takeChartSnapshot)(Qe,(e=>{t(e)}),(()=>{t("")}),{wl:at(null===(i=Ae.logo)||void 0===i?void 0:i.whitelabel),cme:Ae.cme_widget})})),Fe.on("symbolInfo",((e,t)=>{const i=(0,s.ensureNotNull)(tt.model().mainSeries().symbolInfo()),n=tt.model().mainSeries().properties().childs().interval.value();t({name:i.name,exchange:i.exchange,description:i.description,type:i.type,interval:n})})),Fe.on("widgetReady",((e,t)=>{tt.withModel(null,(()=>{let e;tt.model().mainSeries().symbolInfo()?t():(e=()=>{t(),tt.model().mainSeries().dataEvents().symbolResolved().unsubscribe(null,e)},
tt.model().mainSeries().dataEvents().symbolResolved().subscribe(null,e))}))})),k(R.Names.SetSymbol,(e=>{e&&e.symbol&&Qe.setSymbol(e.symbol)})),k(R.Names.SetInterval,(e=>{e&&e.interval&&Qe.setResolution(e.interval)}))})(),window.applyStudiesOverrides=e=>{e&&window.chartWidgetCollection.applyStudiesOverrides(e)}},771702:(e,t,i)=>{"use strict";i.d(t,{canPlaceAlertOnResolution:()=>r});var s=i(378975),n=i(778016);function r(e,t){const i=s.Interval.isSeconds(e),r=t?null==t?void 0:t.alertsOnSeconds:(0,n.enabled)("ALERTS_ON_SECONDS");return!i||r}},447935:(e,t,i)=>{"use strict";i.d(t,{getChartAlertsFacade:()=>a,getChartAlertsFacadeIfCreatedBefore:()=>l});var s=i(383851),n=i(653801);let r,o;async function a(){return r||(r=async function(){const[e,{getAlertsCollection:t},r,o]=await Promise.all([Promise.all([i.e(58910),i.e(50030),i.e(4452),i.e(44572),i.e(1867),i.e(86561),i.e(83912),i.e(93255),i.e(36679)]).then(i.bind(i,939967)),Promise.all([i.e(35706),i.e(50030),i.e(44572),i.e(1867),i.e(86561),i.e(14141)]).then(i.bind(i,686561)),(0,n.getChartSourceIdsGetter)(),(0,s.getAlertsFiresFocusHandler)()]);return new e.ChartAlertsFacade(t(),o,r)}()),o||(o=await r),o}function l(){return null!=o?o:null}},843698:(e,t,i)=>{"use strict";var s;i.d(t,{AlertEditorAbortReason:()=>s}),function(e){e.AlertIsInvalid="alert-is-invalid",e.AlertsMaintenance="alerts-maintenance",e.ChartModelNotFound="chart-model-not-found",e.IsAlreadyPresent="is-already-present",e.MainSeriesIsATR="main-series-is-atr",e.MainSeriesIsPercentageLTP="main-series-is-percentage-ltp",e.MainSeriesIsInReplay="main-series-is-in-replay",e.MainSeriesIsOffline="main-series-is-offline",e.SourceIsDangerous="source-is-dangerous",e.SymbolInfoTimeout="symbol-info-timeout",e.SymbolIsInvalid="symbol-is-invalid",e.SymbolCurrencyConverted="symbol-currency-converted",e.SymbolUnitConverted="symbol-unit-converted",e.SymbolCurrencyAndUnitConverted="symbol-currency-and-unit-converted",e.SymbolIsEconomics="symbol-is-economics",e.UnsupportedResolution="unsupported-resolution",e.ManualAbort="manual-abort",e.MisleadingPriceScale="misleading-price-scale",e.ResolutionIsTicks="resolution-is-ticks"}(s||(s={}))},716004:(e,t,i)=>{e=i.nmd(e),TradingView.cleanButAmpersand=function(e,t){var i=t?["&amp;"]:["&"];return TradingView.clean(e,t,i)},TradingView.strip_tags=function(e){return e&&e.replace?e.replace(/(<([^>]+)>)/gi,""):e},TradingView.encodeSpread=function(e){return encodeURIComponent(e)},TradingView.clean=function(e,t,i){var s=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#039;"],["'","&#39;"]],n=e;if(!e||!e.replace)return n;for(var r=0;r<s.length;r++){var o=s[r][0],a=s[r][1];i&&i.indexOf&&-1!==i.indexOf(t?a:o)||(n=t?n.replace(new RegExp(a,"g"),o):n.replace(new RegExp(o,"g"),a))}return n},e&&e.exports&&(e.exports={clean:TradingView.clean,cleanButAmpersand:TradingView.cleanButAmpersand,stripTags:TradingView.strip_tags})},432059:(e,t,i)=>{"use strict";i.r(t),i.d(t,{alphaToTransparency:()=>o,applyAlpha:()=>r,applyTransparency:()=>l,colorFromBackground:()=>c,colorToInteger:()=>f,
generateColor:()=>n,getLuminance:()=>u,gradientColorAtPercent:()=>p,isColorDark:()=>m,isHexColor:()=>h,resetTransparency:()=>d,rgbaFromInteger:()=>_,rgbaToInteger:()=>g,transparencyToAlpha:()=>a});var s=i(724377);function n(e,t,i){if(t=t||0,!h(e))return i?(0,s.rgbaToString)((0,s.rgba)((0,s.parseRgb)(e),(0,s.normalizeAlphaComponent)(a(t)))):e;const[n,r,o]=(0,s.parseRgb)(e),l=(0,s.normalizeAlphaComponent)(a(t));return(0,s.rgbaToString)([n,r,o,l])}function r(e,t,i){const n=(0,s.tryParseRgba)(e);if(null===n)throw new Error(`Invalid color: ${e}`);const[r,o,a,l]=n,d=(0,s.normalizeAlphaComponent)(t*(i?l:1));return(0,s.rgbaToString)((0,s.rgba)([r,o,a],d))}function o(e){return 100*(1-e)}function a(e){if(e<0||e>100)throw new Error("invalid transparency");return 1-e/100}function l(e,t){if("transparent"===e)return e;const i=(0,s.parseRgba)(e),n=i[3];return(0,s.rgbaToString)((0,s.rgba)(i[0],i[1],i[2],a(t)*n))}function d(e){return"transparent"===e?e:h(e)?e.slice(0,7):(0,s.rgbaToString)((0,s.rgba)((0,s.parseRgb)(e),(0,s.normalizeAlphaComponent)(1)))}function u(e){const t=(0,s.parseRgb)(e).map((e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)));return Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function h(e){return 0===e.indexOf("#")}function c(e){return"black"===(0,s.rgbToBlackWhiteString)((0,s.parseRgb)(e),150)?"#ffffff":"#000000"}function p(e,t,i){const[n,r,o,a]=(0,s.parseRgba)(e),[l,d,u,h]=(0,s.parseRgba)(t),c=(0,s.rgba)(Math.round(n+i*(l-n)),Math.round(r+i*(d-r)),Math.round(o+i*(u-o)),a+i*(h-a));return(0,s.rgbaToString)(c)}function m(e){return u(d(e))<.5}function _(e){const t=(e=Math.round(e))%256;e-=t;const i=(e/=256)%256;e-=i;const s=(e/=256)%256;e-=s;return`rgba(${t},${i},${s},${(e/=256)/255})`}function g(e){const t=Math.round(255*e[3]);return e[0]+256*e[1]+65536*e[2]+16777216*t}function f(e){const t=(0,s.tryParseRgba)(e);return null===t?0:g(t)}},338619:(e,t,i)=>{"use strict";i.r(t),i.d(t,{LOGLEVEL:()=>s.LOGLEVEL,getLogHistory:()=>s.getLogHistory,getLogLevel:()=>s.getLogLevel,getLogger:()=>s.getLogger,getRawLogHistory:()=>s.getRawLogHistory,isHighRateEnabled:()=>s.isHighRateEnabled,loggingOff:()=>s.loggingOff,loggingOn:()=>s.loggingOn,serializeLogHistoryEntry:()=>s.serializeLogHistoryEntry,setLogLevel:()=>s.setLogLevel});var s=i(692558)},881025:(e,t,i)=>{"use strict";i.r(t),i.d(t,{detectAutoDirection:()=>v,forceLTRStr:()=>u,forceLTRStrSsr:()=>h,forceRTLStr:()=>p,getLTRScrollLeft:()=>m,getLTRScrollLeftOffset:()=>_,isRtl:()=>n,startWithLTR:()=>d,stripLTRMarks:()=>l,stripLTRStrSsr:()=>c});var s=i(64531);const n=()=>"rtl"===window.document.dir,r="",o="",a=new RegExp("|||","g");function l(e){return""!==e&&n()&&null!=e?e.replace(a,""):e}function d(e){return""!==e&&n()&&null!=e?""+e:e}function u(e){return""!==e&&n()&&null!=e?r+e+o:e}function h(e){return r+e+o}function c(e){return e.startsWith(r)&&e.endsWith(o)?e.slice(1,-1):e}function p(e){return""!==e&&n()&&null!=e?""+e+o:e}function m(e){return(0,s.getNormalizedScrollLeft)(e,"rtl")}function _(e,t){const i=(0,s.detectScrollType)()
;if("indeterminate"===i)return 0;switch(i){case"negative":t=e.clientWidth-e.scrollWidth+t;break;case"reverse":t=e.scrollWidth-e.clientWidth-t}return t}const g=/[^\u0000-\u0040\u005B-\u0060\u007B-\u00BF\u00D7\u00F7\u02B9-\u02FF\u2000-\u200E\u2010-\u2029\u202C\u202F-\u2BFF]/,f=/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/;function v(e){const t=g.exec(e);return t?f.test(t[0])?"rtl":"ltr":""}},590508:(e,t,i)=>{"use strict";i.r(t),i.d(t,{createGoProDialog:()=>u,isUpgradableFeature:()=>d,onGoProDialog:()=>a});var s=i(638456);const n=new Set,r=[],o=new Promise((e=>{window.addEventListener("load",(()=>{setTimeout((()=>{e()}),3e3)})),setTimeout((()=>{e()}),3e3)}));function a(e,t){r.push(e),t&&t.forEach((e=>{n.add(e)}))}const l=["sessionLock","sessionLogout","checkingNSE"];function d(e){return!1===l.includes(e)}async function u(e){var t;if(await o,r.forEach((t=>{t(e.feature)})),n.has(e.feature))return;if((0,s.isSymphonyEmbed)()&&d(e.feature)){const t=await Promise.all([i.e(96439),i.e(46445),i.e(73399),i.e(43311),i.e(49978),i.e(44581)]).then(i.bind(i,193510));e.actionsOverride=t.generateSymphonyActions({feature:e.feature,upgradeMessage:e.upgradeMessage,additional:e.customParams}),e.hideLimitTable=!0}const a=await Promise.all([i.e(37570),i.e(69297),i.e(75816),i.e(46445),i.e(22164),i.e(65857),i.e(36010),i.e(33253),i.e(491),i.e(88778),i.e(34693),i.e(43311),i.e(35955),i.e(20431),i.e(25790),i.e(82321),i.e(24229),i.e(29147),i.e(45113),i.e(5246)]).then(i.bind(i,936819));await(null===(t=window.pro)||void 0===t?void 0:t.ensureValidShopConf()),a.renderGoproDialog(e)}window.TradingView.createGoProDialog=u},39510:(e,t,i)=>{"use strict";i.d(t,{showGoProAlertsOnSecondsDialog:()=>n});var s=i(590508);i(659863);function n(){(0,s.createGoProDialog)({feature:"alertsOnSeconds"})}},296638:(e,t,i)=>{"use strict";i.d(t,{AggregateError:()=>f,ApiError:()=>g,accumulateErrors:()=>r,checkPhoneCode:()=>d,fetchPost:()=>o,firstLoginData:()=>a,firstLoginDataUrl:()=>n,recoverPassword:()=>y,recoverPasswordUrl:()=>v,recoveryPassword:()=>u,resendLink:()=>l,signin:()=>p,signinUrl:()=>h,signup:()=>_,signupUrl:()=>m,socialAuth:()=>b});var s=i(702598);const n="/accounts/first_login_data/";function r(e,t){return Object.entries(e).map((e=>new g(e[1].join("\n"),t,e[0])))}function o(e,t){return(0,s.fetch)(e,{method:"POST",credentials:"include",mode:"same-origin",body:t})}function a(e){return o(n,e).then((e=>e.ok?e.json():e.json().then((t=>{throw new f(r(t.errors,e.status))}))))}function l(){return o("/api/v1/users/anon/change-email/resend/").then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function d(e){return o("/api/v1/recover_password/check_phone_code/",e).then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function u(e){return o("/api/v1/recover_password/",e).then((e=>e))}const h="/accounts/signin/";function c(e){return e.json().then((t=>{if("error"in t&&""!==t.error||"code"in t||!e.ok)throw new g(t.error||t.detail,e.status,t.code,t.confirm_auth_data,t.two_factor_types,function(e){if(e.signature)return{
signature:e.signature,email:e.email||"",phone:e.phone||"",socials:[]};return}(t));return t}))}function p(e){return o(h,e).then(c)}const m="/accounts/signup/";function _(e){return o(m,e).then((e=>e.json().then((t=>{if("errors"in t&&""!==t.errors)throw new f(r(t.errors,e.status))}))))}class g extends Error{constructor(e,t,i,s,n,r){super(e),this.type=i,this.status=t,this.secondFactorTypes=n,this.socialConfirmData=s,this.resetPasswordData=r}}class f extends Error{constructor(e){super(e.map((e=>e.message)).join("\n")),this.errors=[],this.errors=e}}const v="/api/v1/recover_password/search/";function y(e){return o(v,e).then(c)}const w={headers:{Accept:"application/json"}};function b(e){const t=new URL(window.origin+"/accounts/complete/android-jwt/");return Object.entries(e).forEach((([e,i])=>i&&t.searchParams.append(e,i))),(0,s.fetch)(t.href,w).then(c)}},345297:e=>{"use strict";var t={},i={XCBT:"CBOT",XNYM:"NYMEX",XCME:"CME",XCEC:"COMEX"};t.convertSymbolDataToTV=function(e,t,s){return s=2===s||"floor"===s||"pit"===s?"PIT":"GBX",t&&i[t]?{status:"ok",data:{symbol:e,exchange:i[t]+"_"+s}}:{status:"error",data:"Exchange `"+t+"` is not supported"}},e.exports=t},467332:(e,t,i)=>{"use strict";i.d(t,{getTimeFrames:()=>r});var s=i(444372),n=i(855016);function r(){return{"1d":{text:s.t(null,void 0,i(207075)),value:{value:"1D",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1"),description:(0,n.daysStringLiteral)(1)},"5d":{text:s.t(null,void 0,i(558628)),value:{value:"5D",type:"period-back"},targetResolution:(0,n.stringAsResolution)("5"),description:(0,n.daysStringLiteral)(5)},"1w":{text:s.t(null,void 0,i(189696)),value:{value:"7D",type:"period-back"},targetResolution:(0,n.stringAsResolution)("15"),description:(0,n.weeksStringLiteral)(1)},"1m":{text:s.t(null,void 0,i(333493)),value:{value:"1M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("30"),description:(0,n.monthsStringLiteral)(1)},"3m":{text:s.t(null,void 0,i(318717)),value:{value:"3M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("60"),description:(0,n.monthsStringLiteral)(3)},"6m":{text:s.t(null,void 0,i(869411)),value:{value:"6M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("120"),description:(0,n.monthsStringLiteral)(6)},"12m":{text:s.t(null,void 0,i(186322)),value:{value:"12M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1D"),description:(0,n.yearsStringLiteral)(1)},"24m":{text:s.t(null,void 0,i(745391)),value:{value:"24M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1W"),description:(0,n.yearsStringLiteral)(2)},"36m":{text:s.t(null,void 0,i(189992)),value:{value:"36M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1W"),description:(0,n.yearsStringLiteral)(3)},"60m":{text:s.t(null,void 0,i(772834)),value:{value:"60M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1W"),description:(0,n.yearsStringLiteral)(5)},"120m":{text:s.t(null,void 0,i(27969)),value:{value:"120M",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1M"),
description:(0,n.yearsStringLiteral)(10)},ytd:{text:s.t(null,void 0,i(168881)),value:{value:"YTD",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1D"),description:s.t(null,void 0,i(251478))},all:{text:s.t(null,void 0,i(580066)),value:{value:"ALL",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1M")},lastsession:{text:s.t(null,void 0,i(207075)),value:{value:"LASTSESSION",type:"period-back"},targetResolution:(0,n.stringAsResolution)("1"),description:(0,n.daysStringLiteral)(1)}}}},855016:(e,t,i)=>{"use strict";i.d(t,{daysStringLiteral:()=>o,hoursStringLiteral:()=>r,minutesStringLiteral:()=>n,monthsStringLiteral:()=>l,stringAsResolution:()=>u,weeksStringLiteral:()=>a,yearsStringLiteral:()=>d});var s=i(444372);const n=e=>s.t(null,{plural:"{str} minutes",count:e,replace:{str:`${e}`}},i(805926)),r=e=>s.t(null,{plural:"{str} hours",count:e,replace:{str:`${e}`}},i(664963)),o=e=>s.t(null,{plural:"{str} days",count:e,replace:{str:`${e}`}},i(862368)),a=e=>s.t(null,{plural:"{str} weeks",count:e,replace:{str:`${e}`}},i(149306)),l=e=>s.t(null,{plural:"{str} months",count:e,replace:{str:`${e}`}},i(520062)),d=e=>s.t(null,{plural:"{str} years",count:e,replace:{str:`${e}`}},i(791549)),u=e=>e},563360:(e,t,i)=>{"use strict";i.d(t,{timeFrames:()=>s});const s=(0,i(467332).getTimeFrames)()},484593:(e,t,i)=>{"use strict";function s(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var i=t.space||"";"number"==typeof i&&(i=Array(i+1).join(" "));var s,o="boolean"==typeof t.cycles&&t.cycles,a=t.replacer||function(e,t){return t},l=t.cmp&&(s=t.cmp,function(e){return function(t,i){var n={key:t,value:e[t]},r={key:i,value:e[i]};return s(n,r)}}),d=[];return function e(t,s,u,h){var c=i?"\n"+new Array(h+1).join(i):"",p=i?": ":":";if(u&&u.toJSON&&"function"==typeof u.toJSON&&(u=u.toJSON()),void 0!==(u=a.call(t,s,u))){if("object"!=typeof u||null===u)return JSON.stringify(u);if(n(u)){for(var m=[],_=0;_<u.length;_++){var g=e(u,_,u[_],h+1)||JSON.stringify(null);m.push(c+i+g)}return"["+m.join(",")+c+"]"}if(-1!==d.indexOf(u)){if(o)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}d.push(u);var f=r(u).sort(l&&l(u));for(m=[],_=0;_<f.length;_++){var v=e(u,s=f[_],u[s],h+1);if(v){var y=JSON.stringify(s)+p+v;m.push(c+i+y)}}return d.splice(d.indexOf(u),1),"{"+m.join(",")+c+"}"}}({"":e},"",e,0)}i.d(t,{sortedStringify:()=>s});var n=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},r=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},i=[];for(var s in e)t.call(e,s)&&i.push(s);return i}},433524:(e,t,i)=>{"use strict";i.r(t),i.d(t,{capitalizeFirstLetterInWord:()=>m,decodeHTMLEntities:()=>d,encodeHTMLEntities:()=>u,getFirstSegmentOrCodePointString:()=>_,htmlEscape:()=>h,removeSpaces:()=>p,removeTags:()=>c});const s=/[<"'&>]/g,n=e=>`&#${e.charCodeAt(0)};`,r={"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&amp;":"&","&#60;":"<","&#62;":">","&#34;":'"',"&#39;":"'","&#039;":"'","&#38;":"&"
},o=Object.assign({},...Object.entries(r).map((([e,t])=>({[t]:e})))),a=new RegExp(Object.keys(r).join("|"),"g"),l=new RegExp(Object.keys(o).join("|"),"g");function d(e){return e.replace(a,(e=>r[e]||e))}function u(e){return e.replace(l,(e=>o[e]||e))}function h(e){return e.replace(s,n)}function c(e=""){return e.replace(/(<([^>]+)>)/gi,"")}function p(e=""){return e.replace(/\s+/g,"")}function m(e=""){return e.replace(/\b\w/g,(e=>e.toUpperCase()))}function _(e){var t;const i=Intl.Segmenter;if(i){const s=new i(void 0,{granularity:"grapheme"}),[{segment:n}={segment:null}]=s.segment(e);return null!==(t=null==n?void 0:n.toUpperCase())&&void 0!==t?t:null}{const t=e.codePointAt(0);return t?String.fromCodePoint(t).toUpperCase():null}}},586240:e=>{"use strict";e.exports=JSON.parse('{"size-header-height":"64px","size-sticky-symbol-header-height":"64px","size-dialog-fixed-header-height":"72px","media-phone":"all and (max-width: 767px)","media-phone-vertical":"all and (max-width: 479px)","media-mf-phone-vertical":"all and (min-width: 320px)","media-mf-phone-landscape":"all and (min-width: 568px)","media-mf-tablet-vertical":"all and (min-width: 768px)","media-mf-tablet-landscape":"all and (min-width: 1024px)","media-mf-laptop":"all and (min-width: 1280px)","media-mf-desktop-medium":"all and (min-width: 1440px)","media-mf-desktop-large":"all and (min-width: 1920px)"}')}},e=>{e.O(0,[8107],(()=>{[35706,50030,44572,1867,86561,14141].map(e.E)}),5);e.O(0,[56316,9315,67648,88488,92115,67661,77476,88778,76978,95972,66389,79774,4126,47793,81395,1652,37939,82512,24918,32787,91317,68159,50875,97525,67814,77916,65414,10887,44572,92013,88509,89052,10640,97762,89507,17619,95014,89545,19024,42445,46985,26860,73904,11190,61139,91604,76349,40615,47782,33336],(()=>{return t=841264,e(e.s=t);var t}));e.O()}]);