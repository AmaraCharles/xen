(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[89545],{585627:(e,t,i)=>{"use strict";i.d(t,{solutionIds:()=>s})
;const s=JSON.parse('{"EXTENDED_HOURS":43000502023,"PRE_MARKET":43000502023,"POST_MARKET":43000502023,"SPREAD_CHARTS":43000502298,"ALERTS":43000520149,"ALERT_ON_STRATEGY":43000481368,"ALERT_WEBHOOK":43000529348,"ALERT_DESCRIPTION_PLACEHOLDER":43000531021,"ALERT_RECEIVE_NOTIFICATIONS_OH_PHONE":43000474389,"ALERT_USE_ALTERNATIVE_EMAIL":43000474394,"ALERT_WEBHOOK_CREDENTIALS":43000722015,"ALERT_KEEP_TOASTS_VISIBLE":43000737982,"VOLUME_PROFILE":43000502040,"VOLUME_PROFILE_INDICATOR":43000557450,"RENKO":43000502284,"KAGI":43000502272,"LINE_BREAK":43000502273,"PNF":43000502276,"FINANCIAL_DATA":43000543506,"BROKER_RATING":43000542490,"CRYPTO_MARKET_CAP":43000540941,"CRYPTO_PAYMENT":43000485536,"ALERT_ON_SPREAD":43000478406,"ALERT_ON_LOG_SCALE":43000690942,"ALERT_ON_CUSTOM_SCRIPT":43000478415,"ALERT_FUNCTION":43000597494,"SMS_VERIFICATION":43000553429,"MAGNET_MODE":43000537270,"PRIVACY_SETTINGS":43000548335,"PUBLICATION_TYPE":43000609497,"SCRIPT_ACCESS":43000482573,"FREE_USER_FAQS":43000590947,"STRATEGY_UNREALISTIC_RESULTS":43000481029,"STRATEGY_FUTURE_DATA":43000614705,"HOW_TO_USE_PAPER":43000516466,"HOW_TO_USE_CQG":43000516372,"HOW_TO_USE_OANDA":43000516375,"HOW_TO_USE_FOREXCOM":43000516374,"FAVORITE_IDEA":43000555216,"AUTHORS_INSTRUCTIONS_PUBCLICATION":43000549951,"AUTHORS_INSTRUCTIONS_EDIT":43000614618,"SCRIPT_INSTRUCTIONS":43000482573,"BAR_REPLAY_UNAVAILABILITY":43000475470,"WHAT_IS_CBOE_BZX_EXCHANGE":43000473924,"GOPRO_UPGRADE_DESCRIPTION":43000473324,"GOPRO_DOWNGRADE_DESCRIPTION":43000485437,"GOPRO_RENEW_ANNUAL_MONTHLY_DESCRIPTION":43000644491,"FINANCIALS_OWNERSHIP":43000699479,"FINANCIALS_VALUATION_SUMMARY":43000699484,"FINANCIALS_VALUATION_RATIOS":43000699495,"FINANCIALS_GROWTH_AND_PROFITABILITY":43000699485,"FINANCIALS_REVENUE_TO_PROFIT_CONVERSION":43000699496,"FINANCIALS_REVENUE_BREAKDOWN_BY_SOURCE":43000699487,"FINANCIALS_REVENUE_BREAKDOWN_BY_COUNTRY":43000699497,"FINANCIALS_REVENUE_ESTIMATES":43000699489,"FINANCIALS_EARNINGS_ESTIMATES":43000699498,"FINANCIALS_DIVIDEND_SUMMARY":43000699500,"FINANCIALS_DIVIDEND_HISTORY":43000699501,"FINANCIALS_DEBT_LEVEL":43000699502,"FINANCIALS_POSITION":43000699503,"FIRE_CONTROL_SOLUTION":43000690939,"BROKERAGE_REVIEWS":43000591351,"CHANGE_SUBSCRIPTION":43000635806,"PINE_LIBRARY_INFO":43000638371,"HOW_DO_I_UPDATE_DESKTOP_APP":43000647779,"TECHNICAL_RATINGS":43000614331,"BACKTESTING_WIDGET":43000562362,"BACKTESTING_NO_DATA":43000478450,"BACKEND_CONNECTIONS":43000694474,"DEEP_BACKTESTING_WIDGET":43000670566,"DEEP_BACKTESTING":43000666199,"DEEP_BACKTESTING_AVAILABLE_DATA":43000668210,"BETA_BROKERS":43000673434,"VIDEO_UPLOAD_FAILED":43000666607,"VIDEO_DEVICE_ACCESS":43000677209,"PUBLIC_INVITE_ONLY_SCRIPTS":43000614617,"PRIVATE_INVITE_ONLY_SCRIPTS":43000614617,"HOW_DOES_BRACKETS_MANAGEMENT_WORK":43000631987,"HOW_TO_SEE_THE_DEEPEST_HIST_DATA":43000687053,"I_CANT_SEE_ALL_HIST_DATA_ON_RES_LOWER_THAN_DAY":43000480679,"IDEAS_ON_CHART":43000694285,"GET_A_REFUND":43000485430,"USE_SETTLEMENT_AS_CLOSE_ON_DAILY_INTREVAL":43000685268,"ADJUST_FOR_CONTRACT_CHANGES":43000685266,"SWITCHING_CONTINUOUS_FUTURES_CONTRACTS":43000689313,"ADJUST_DATA_FOR_DIVIDENDS":43000590597,"WHY_IS_MY_ACCOUNT_BANNED":43000674726,"HOW_TO_PUBLISH_A_VIDEO_IDEA":43000476752,"TELL_ME_MORE_ABOUT_THE_COMMUNITY_SCRIPTS":43000558522,"HOW_TO_POST_AWESOME_IDEAS_AND_GET_LOTS_OF_LIKES":43000603748,"ABOUT_EXPERT_PLAN":43000677382,"CONNECTIONS_LIMIT_EXCEEDED":43000693877,"ACCOUNT_RECOVERY":43000619597,"HOW_TO_SYNC_CHARTS_ON_LAYOUT":43000629992,"HOW_TO_SEE_BUILTIN_INDICATOR_SOURCE":43000481659,"MULTI_CHART_MODE":43000629990,"QUICK_SEARCH":43000659671,"WHATS_AN_INDICATOR":43000543626,"CHART_TYPES":43000703407,"DRAWING_TOOLS":43000703396,"CUSTOM_INTERVALS":43000543883,"CUSTOM_RANGE_BARS":43000474007,"CANDLESTICK_PATTERNS":43000584462,"MULTI_TIMEFRAME_CHARTS":43000502591,"BAR_REPLAY":43000712747,"PINE_SCRIPT":43000561836,"SCREENER_OVERVIEW":43000635796,"AUTO_CHART_PATTERNS":43000690464,"HOW_TO_PROTECT_YOUR_ACCOUNT":43000582277,"PLUS_BUTTON":43000645256,"PLAN_UPGRADED_BUT_DATA_STILL_DELAYED":43000471705,"WHY_TAX_HAS_BEEN_ADDED_TO_MY_BILL":43000684741,"COMPARE_SYMBOLS_TOOL":43000543053,"SAVED_CHART":43000692404,"CUSTOM_INDICATOR":43000543048,"BIST_MIXED_SUBSCRIPTION":43000609137,"WHY_RENKO_NOT_WORK":43000711502,"ALERTS_SEPARATION_BY_TYPE":43000696403,"HOW_TO_SET_UP_ALERTS":43000595315,"PINE_SCRIPT_STRATEGIES":43000562362,"ECONOMIC_CALENDAR":43000707391,"SCRIPT_PUBLISHING_RULES":43000590599,"DIFFERENCE_BETWEEN_PRO_AND_NONPRO_PLANS":43000677382,"HOW_TO_USE_MINDS":43000690226,"HOW_TO_USE_TRADINGVIEW_CHAT":43000604448,"PAPER_COMPETITION":43000593579,"PAPER_COMPETITION_ACCOUNT":43000721315,"PAPER_COMPETITION_PRIZE":43000721317,"PAPER_COMPETITION_FREE_ACCOUNT":43000721310,"PUBLISHING_AND_UPDATING_IDEAS":43000591338,"USING_MINDS":43000696301,"PUBLISH_VIDEO_IDEA":43000476752,"TAROT_DECK":43000724020,"VAT_NUMBER_GUIDE":43000721910,"AVAILABLE_COMPETITION_INSTRUMENTS":43000721311,"PINE_PERFORMANCE_PROFILER":43000725216,"PINE_LOGS_INFO":43000710876,"INDICATORS":43000474048,"CHART_DATA_EXPORT":43000537255,"TIME_PRICE_OPPORTUNITIES":43000725590,"TICK_INTERVALS":43000709225,"VOLUME_FOOTPRINT":43000726164,"VOLUME_CANDLES":43000724995,"HEIKIN_ASHI":43000619436,"HLC_AREA":43000709062,"BASELINE":43000690232,"HIGH_LOW":43000677196,"COLUMNS":43000673912}')
},342707:(e,t,i)=>{"use strict";i.d(t,{formatStudyError:()=>n,triesTranslateError:()=>r});var s=i(444372);function r(e){return o.get(e)||e}function n(e){return e.format({boldHighlightStart:"<b>",boldHighlightEnd:"</b>"})}const o=new Map([["You cannot see this pivot timeframe on this resolution",s.t(null,void 0,i(525059))],["The data vendor doesn't provide volume data for this symbol.",s.t(null,void 0,i(81657))],['Histogram is too large, please increase "Row Size" input.',s.t(null,void 0,i(872819))],["Histogram is too large, please reduce 'Row Size' input.",s.t(null,void 0,i(566751))],['Histogram is too large, please increase "Ticks Per Row" input.',s.t(null,void 0,i(594966))],["This script is invite-only. To request access, please contact its author.",s.t(null,void 0,i(276989))],["Volume Profile indicator available only on our upgraded plans.",s.t(null,void 0,i(139903))],["VOLUME_BIST_MIXED",s.t(null,void 0,i(469156))],["Runtime error",s.t(null,void 0,i(660630))],["Access error",s.t(null,void 0,i(377401))],["User-defined error",s.t(null,void 0,i(708580))],["Compilation error",s.t(null,void 0,i(212086))]])},306060:(e,t,i)=>{"use strict";i.d(t,{Version:()=>r});var s=i(650151);class r{constructor(e,t){this._major=e,this._minor=t}major(){return this._major}minor(){return this._minor}isZero(){return 0===this._major&&0===this._minor}toString(){return this._major+"."+this._minor}compareTo(e){return this._major<e._major?-1:this._major>e._major?1:this._minor<e._minor?-1:this._minor>e._minor?1:0}isLess(e){return this.compareTo(e)<0}isLessOrEqual(e){return this.compareTo(e)<=0}isEqual(e){return 0===this.compareTo(e)}isGreater(e){return this.compareTo(e)>0}isGreaterOrEqual(e){return this.compareTo(e)>=0}static parse(e){if(e instanceof r)return new r(e.major(),e.minor());if("number"==typeof e)return(0,s.assert)(Math.floor(e)===e,"Version should not be a float number"),new r(e,0);if("string"==typeof e){const t=e.split(".");if(1===t.length){const i=parseInt(t[0],10);return(0,s.assert)(!isNaN(i),"Bad version string: "+e),new r(i,0)}if(2===t.length){const i=parseInt(t[0],10);(0,s.assert)(!isNaN(i),"Bad version string: "+e);const n=parseInt(t[1],10);return(0,s.assert)(!isNaN(n),"Bad version string: "+e),new r(i,n)}throw new Error("Bad version string (one dot expected): "+e)}throw new Error("Bad version: "+e)}}r.ZERO=new r(0,0)},198930:(e,t,i)=>{"use strict";i.d(t,{isLineToolState:()=>o,isMainSeriesState:()=>r,isStudyLineToolState:()=>a,isStudyState:()=>n});var s=i(627620);function r(e){return"MainSeries"===e.type}function n(e){return Boolean(e.type)&&e.type.toLowerCase().startsWith("study")}function o(e){return Boolean(e.type)&&(0,s.isLineToolName)(e.type)}function a(e){return Boolean(e.type)&&(0,s.isStudyLineToolName)(e.type)}},475892:(e,t,i)=>{"use strict";i.d(t,{PriceDataSource:()=>a,isPriceDataSource:()=>o});var s=i(903424),r=i(942634),n=i(487945);function o(e){return e instanceof a}class a extends s.DataSource{constructor(e,t){super(t),this._formatterChanged=new r.Delegate,this._priceStepChanged=new r.Delegate,
this._currencyChanged=new r.Delegate,this._unitChanged=new r.Delegate,this._priceRangeReadyChanged=new r.Delegate,this._priceStep=null,this._priceRangeReady=!0,this._model=e}base(){return 0}model(){return this._model}currencyChanged(){return this._currencyChanged}isCurrencySource(){return!0}isDisplayedInLegend(){return!0}unitChanged(){return this._unitChanged}isUnitSource(){return!0}priceRange(e,t,i){return null}isDraggable(){return!0}priceLineColor(e){return e}formatterChanged(){return this._formatterChanged}priceStep(e){return this._priceStep}priceStepChanged(){return this._priceStepChanged}isIncludedInAutoScale(){return!0}correctScaleMargins(e){return e}priceRangeReady(){return this._priceRangeReady}priceRangeReadyChanged(){return this._priceRangeReadyChanged}disablePriceRangeReady(){const e=this.priceScale();null===e||e.isAutoScale()||e.mainSource()!==this||(this._priceRangeReady=!1,e.recalculatePriceRangeOnce()),this._priceRangeReadyChanged.fire(!1)}statusView(){return null}legendView(){return null}marketStatusModel(){return null}dataUpdatedModeModel(){return null}dataProblemModel(){return null}canHasAlertOnLineTools(){return!0}_enablePriceRangeReady(){this._priceRangeReady=!0,this._priceRangeReadyChanged.fire(!0)}_onSourceCurrencyChanged(){(0,n.isActingAsSymbolSource)(this)||this._currencyChanged.fire()}_onSourceUnitChanged(){(0,n.isActingAsSymbolSource)(this)||this._unitChanged.fire()}_onSourcePriceRangeReadyChanged(e){(0,n.isActingAsSymbolSource)(this)||e||this.disablePriceRangeReady()}}},923451:(e,t,i)=>{"use strict";i.d(t,{iterateAndPatchObjectsByMap:()=>_,patchPropertiesAsync:()=>p,processLegacy:()=>f});var s=i(650151),r=i(338619),n=i(79200),o=i(955273),a=i(345848),u=i(603774),l=i(453995),d=i(486393);const c=(0,r.getLogger)("Pine.ScriptLib");function p(e,t,i,s){return c.logNormal("patchPropertiesAsync"),new Promise(((o,u)=>{if(!t.TVScriptMetaInfoExprs)return void o(e);const c=t.TVScriptMetaInfoExprs.tree,p=t.TVScriptMetaInfoExprs.patchMap;(function(e,t){(0,a.trackEvent)("Pine","ScriptLib.evalMetaInfoExprs");const i=d.Deferred(),s={username:window.user&&window.user.username,source:e,inputs:JSON.stringify(t||{})};return(0,l._pineFacadeAjax)("POST","/eval_pine_ex/",s).done(((e,t)=>{e.error?i.reject((0,l._readableError)(e.error,t)):e.success?i.resolve(e.result):i.reject((0,l.safetyGetReason)(e))})).fail((e=>{(0,l._anyRequestAsyncFail)(i,e)})),i.promise()})(c,i).done((i=>{var a;if(!i)return void o(e);const u=e.childs().inputs.childs().text.value(),l=i.rootValues;_([e,t.defaults,t],p,((e,t,i)=>{const r=l[i],n=e[0],o=e[1],a=e[2];(void 0===s||void 0!==s[i]&&s[i]!==r)&&(o.hasOwnProperty(t)?n[t].setValue(r):a[t]=r)})),void 0!==s&&Object.keys(l).forEach((e=>{void 0!==s[e]&&(s[e]=l[e])}));const d=e.childs().inputs.childs().text.value();u&&!d&&(null===(a=(0,n.getPersistentLogger)())||void 0===a||a.addPersistentLogEntry(`Detected invalid meta info evaluation expression result: IL code input value is empty, id: ${t.fullId}`,r.LOGLEVEL.ERROR,"PineMetaInfoValidation")),o(e)})).fail((e=>{u(e)}))}))}function _(e,t,i){
const r=Object.keys(t);for(let n=0;n<r.length;n++){const o=r[n],a=t[o],u=o.split(".");"defaults"===u[0]&&u.splice(0,1),(0,s.assert)(u.length>1,"Unexpectedly short json path");let l=[...e];for(let e=0;e<u.length-1;++e){const t=u[e];l=l.map((e=>e?e[t]:null))}i(l,u[u.length-1],a)}}function f(e,t){(0,a.trackEvent)("Pine","ScriptLib.processLegacy");const i=(0,o.createDeferredPromise)(),s=window.user&&window.user.username,r="/process_legacy/"+encodeURIComponent(e)+"/?user_name="+encodeURIComponent(s),n=t?{source:t}:{};return(0,l._pineFacadeAjax)("POST",r,n).done((e=>{e.error?i.reject((0,l._readableError)(e.error)):e.success?((0,u.logPineMetaInfoIssues)("ScriptLib.processLegacy",e.result.metaInfo),i.resolve(e.result.metaInfo)):i.reject((0,l.safetyGetReason)(e))})).fail((e=>{(0,l._anyRequestAsyncFail)(i,e)})),i.promise}},453995:(e,t,i)=>{"use strict";var s=i(486393),r=i(345848).trackEvent,n=i(338619).getLogger("Pine.ScriptLib"),o=i(175203).telemetry,a={fast:["delete","get","is_auth_to_get","is_auth_to_write","parse_title","rename","lib_list"],medium:["list","eval_pine_ex","translate_light"],slow:["process_legacy","publish","save","translate","translate_source","gen_alert"]},u=/[l|L]ines? (\d*)/;function l(e){if("object"==typeof e.reason)return e.reason;if(e.reason2)return e.reason2;const t={errors:[],warnings:[]},i=e.result&&e.result.metaInfo;if(i&&void 0!==i.warnings&&i.warnings.forEach((e=>t.warnings.push({message:e}))),e.reason){(Array.isArray(e.reason)?e.reason:e.reason.split("\n")).forEach((e=>{const i=e.match(u),s=i&&i.length&&Number(i[1]),r={message:e};if("number"==typeof s){r.start={line:s,column:0};const e=r.message.split(": ");e.shift(),r.message=e.join(": ")}t.errors.push(r)}))}return t}var d={getPineFacadeUrl:function(){return window.PINE_URL},PINE_FACADE_URL:function(){return window.PINE_URL}};d.safetyGetReason=l,d._pineFacadeAjax=function(e,t,i,r){n.logNormal("Requesting pine facade scripts, url: "+t);var u=function(e,t){for(var i=Object.keys(a),s=0;s<i.length;s++){var r=a[i[s]].filter((function(t){return-1!==e.indexOf(t)}));if(Boolean(r.length))return i[s]}return!1}(t),l=Date.now(),c=r?void 0:{withCredentials:!0};return s.ajax({url:d.PINE_FACADE_URL()+t,type:e,data:i||{},dataType:"json",xhrFields:c}).done((function(){var e=Date.now()-l;o.sendReport("pine",u+"_group_time_frame",{value:e}),o.sendReport("pine",u+"_group_ok"),n.logNormal("Requesting pine facade scripts finished, url: "+t)})).fail((function(){var e=Date.now()-l;o.sendReport("pine",u+"_group_time_frame",{value:e}),o.sendReport("pine",u+"_group_error"),n.logError("Requesting pine facade scripts failed, url: "+t)}))},d._generateAlertAsyncDone=function(e,t){if(t.error)e.reject(d._readableError(t.error));else if(t.success)e.resolve(t.result.metaInfo,t.result.IL,t.result.inputs||null,t.result.gen_alert_data||null);else{var i=t.result?t.result.metaInfo:null;e.reject(l(t),i)}},d._readableError=function(e,t){return t},d._anyRequestAsyncFail=function(e,t){try{const i=l(JSON.parse(t.responseText));if(i)return e.reject(i)}catch(e){}
0===d.PINE_FACADE_URL().indexOf("http")&&n.logError(t.responseText),e.reject(d._readableError(t.status,t.statusText))},d.getPineSourceCode=function(e,t,i){r("Pine","ScriptLib.getPineSourceCode");var n=s.Deferred(),o="?no_4xx="+!!i,a="/get/"+encodeURIComponent(e)+"/"+t+o;return d._pineFacadeAjax("GET",a).done((function(e,t,i){!1===e.success?n.reject(l(e)):n.resolve(e)})).fail((function(e,t,i){d._anyRequestAsyncFail(n,e)})),n.promise()},d.generateAlert=function(e){r("Pine","ScriptLib.generateAlert");var t=s.Deferred(),i=window.user&&window.user.username,n="/gen_alert/?user_name="+encodeURIComponent(i),a={alert_info:e},u=Date.now();return d._pineFacadeAjax("POST",n,a).done((function(e,i,s){o.sendReport("alerts","compilation_ok"),d._generateAlertAsyncDone(t,e)})).fail((function(e,i,s){o.sendReport("alerts","compilation_error"),d._anyRequestAsyncFail(t,e)})).always((function(){var e=Date.now()-u;o.sendReport("alerts","compilation_time_frame",{value:e})})),t.promise()},d.scriptUpdater=function(){return window.scriptUpdater()},d.requestUserPublishedScripts=function(e,t){if(r("Pine","ScriptLib.requestUserPublishedScripts"),window.is_authenticated){if(t||!d._userPublishedScriptsDfd){d._userPublishedScriptsDfd=s.Deferred();var i=d._userPublishedScriptsDfd;d._pineFacadeAjax("GET","/list?filter=published").done((function(e,t,s){i.resolve(e)})).fail((function(e){d._anyRequestAsyncFail(i,e)}))}i=d._userPublishedScriptsDfd}else i=s.Deferred().resolve([]);return"function"==typeof e&&i.done(e),i.promise()},d.requestInfoForScripts=function(e){return Promise.all([d._pineFacadeAjax("GET","/list?filter=saved"),d._pineFacadeAjax("GET","/list?filter=addon",void 0,!0)]).then((function(t){var i=t[0],s=t[1];return i.concat(s).filter((function(t){return e.includes(t.scriptIdPart)}))}))},d.requestBuiltinAndUserScripts=function(){r("Pine","ScriptLib.requestBuiltinAndUserScripts"),n.logNormal("Request built-in and user scripts");var e,t=window.user&&window.user.username,i={},s=new Promise((function(t,s){e=t,i.reject=s}));return Promise.all([d._pineFacadeAjax("GET","/list?filter=saved&user_name="+encodeURIComponent(t),void 0,!1),d._pineFacadeAjax("GET","/list?filter=standard",void 0,!0)]).then((function(t){n.logNormal("Request built-in and user scripts finished");var i=t[0],s=t[1];e(i.concat(s))})).catch((function(e){n.logWarn("Request built-in and user scripts finished with fail"),d._anyRequestAsyncFail(i,e)})),s},d.requestScriptInfo=function(e){r("Pine","ScriptLib.requestBuiltinAndUserScripts"),n.logNormal("Request public/user script info");var t=s.Deferred();return d._pineFacadeAjax("GET","/get_script_info/?pine_id="+encodeURIComponent(e)).done((function(e){n.logNormal("Request public/user script info finished"),t.resolve(e)})).fail((function(e){n.logWarn("Request public/user script info finished with fail"),d._anyRequestAsyncFail(t,e)})),t.promise()},d.requestCandlestickScripts=function(){var e;r("Pine","ScriptLib.requestCandlestickScripts"),n.logNormal("Request candlestick scripts");var t={},i=new Promise((function(i,s){e=i,t.reject=s}))
;return d._pineFacadeAjax("GET","/list?filter=candlestick",void 0,!0).done((function(t){n.logNormal("Request candlestick scripts finished"),e(t)})).fail((function(e){n.logWarn("Request candlestick scripts finished with fail"),d._anyRequestAsyncFail(t,e)})),i};var c={time:-1/0,request:null};d.requestFundamentalScripts=function(){if(c.time+6e5>Date.now()&&null!==c.request)return n.logNormal("Return fundamentals from cache"),c.request;n.logNormal("Request fundamental scripts");var e=d._pineFacadeAjax("GET","/list?filter=fundamental",void 0,!1);return e.then((function(e){n.logNormal("Request fundamental scripts finished")})),e.fail((function(e){n.logWarn("Request fundamental scripts finished with fail, resetting cache"),c.request=null})),c.time=Date.now(),c.request=Promise.resolve(e.promise()),c.request},d.publishNew=function(e,t){r("Pine","ScriptLib.publishNew");var i=s.Deferred(),n=window.user&&window.user.username,o="/publish/new/?access="+encodeURIComponent(t)+"&user_name="+encodeURIComponent(n),a={source:e};return d._pineFacadeAjax("POST",o,a).done((function(e,t,s){e.success?i.resolve(e):i.reject(l(e))})).fail((function(e,t,s){d._anyRequestAsyncFail(i,e)})),i.promise()},d.publishNext=function(e,t){n.logNormal("ScriptLib.publishNext","pine"),r("Pine","ScriptLib.publishNext");var i=s.Deferred(),o=window.user&&window.user.username,a="/publish/next/"+encodeURIComponent(t)+"?user_name="+encodeURIComponent(o),u={source:e};return d._pineFacadeAjax("POST",a,u).done((function(e,t,s){e.success||i.reject(l(e)),i.resolve(e)})).fail((function(e,t,s){d._anyRequestAsyncFail(i,e)})),i.promise()},d.lightTranslate=function(e,t){return n.logNormal("ScriptLib.lightTranslate","pine"),r("Pine","ScriptLib.lightTranslate"),new Promise((function(i,s){var r=window.user&&window.user.username,n=`/translate_light/?user_name=${encodeURIComponent(r)}`;t&&(n+=`&pine_id=${encodeURIComponent(t)}`);var o={source:e};d._pineFacadeAjax("POST",n,o).done((function(e,t,r){if(e.success)i(e.result);else{var n=e.result&&l(e.result)||l(e);s(n)}})).fail((function(e,t,i){d._anyRequestAsyncFail({reject:s},e)}))}))},d.getLibList=function(e,t,i){return n.logNormal("ScriptLib.getLibList","pine"),r("Pine","ScriptLib.getLibList"),new Promise((function(s,r){var n="/lib_list?lib_id_prefix="+encodeURIComponent(e);t&&(n+="&ignore_cache=true"),i&&(n+="&ignore_case=true"),d._pineFacadeAjax("GET",n).done((function(e,t,i){s(e)})).fail((function(e,t,i){d._anyRequestAsyncFail({reject:r},e)}))}))},d.getExistingLibraryInfo=async function(e){try{const t=await d.getLibList(e+"/last",!0,!0);if(!t.length)return null;const i=t[0];return{scriptIdPart:i.scriptIdPart,chartId:i.chartId,version:i.version}}catch(e){return null}},e.exports=d},901110:(e,t,i)=>{"use strict";i.d(t,{StatusProviderBase:()=>s});class s{size(){return"13px"}bold(){return!1}}},32904:(e,t,i)=>{"use strict";i.d(t,{StatusView:()=>s});class s{constructor(e){this._text="",this._color="",this._size="13px",this._bold=!1,this._statusProvider=e}text(){return this._text}getSplitTitle(){return[this._text]}bold(){
return this._bold}size(){return this._size}}},874546:(e,t,i)=>{"use strict";i.d(t,{migrateMetaInfoAndPropState:()=>d});var s=i(650151),r=i(637761),n=i(124829);const o=["PennantCP@tv-basicstudies","WedgeCP@tv-basicstudies"],a=["DoubleTopCP@tv-basicstudies","BullishFlagCP@tv-basicstudies","HeadAndShouldersCP@tv-basicstudies","TripleTopCP@tv-basicstudies"];class u{targetMetaInfoVersion(){return 53}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=53,void 0!==t.defaults&&void 0!==t.defaults.inputs&&(o.includes(t.id)||a.includes(t.id)&&Number(t.version)<156)){const e=t.defaults.inputs["Invert Pattern"];i.id=this._getNewIdStudies(t.id,e)}}migratePropState(e){}_getNewIdStudies(e,t){return e.startsWith("WedgeCP")?t?"WedgeFallingCP@tv-basicstudies":"WedgeRisingCP@tv-basicstudies":e.startsWith("PennantCP")?t?"PennantBearishCP@tv-basicstudies":"PennantBullishCP@tv-basicstudies":e.startsWith("DoubleTopCP")&&t?"DoubleBottomCP@tv-basicstudies":e.startsWith("BullishFlagCP")&&t?"BearishFlagCP@tv-basicstudies":e.startsWith("HeadAndShouldersCP")&&t?"HeadAndShouldersInverseCP@tv-basicstudies":e.startsWith("TripleTopCP")&&t?"TripleBottomCP@tv-basicstudies":e}}const l=[new class{targetMetaInfoVersion(){return 47}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=47,!t.defaults||void 0===t.defaults.precision)return void(i.format={type:"inherit"});const s=t.defaults&&t.defaults.precision,r=(0,n.isNumber)(s)?s:parseInt(s);0===r?i.format={type:"volume"}:isFinite(r)?i.format={type:"price",precision:r}:i.format={type:"inherit"},delete t.defaults.precision}migratePropState(e){}},new class{targetMetaInfoVersion(){return 50}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=50,void 0===t.defaults||void 0===t.defaults.ohlcPlots||void 0===t.ohlcPlots)return;const r=t.ohlcPlots,n=t.defaults.ohlcPlots,o=(0,s.ensureDefined)((0,s.ensureDefined)(i.defaults).ohlcPlots);for(const e of Object.keys(n)){const t=n[e];if("ohlc_candles"===t.plottype){let i=!1;const s=r[e];void 0!==s&&(i=!!s.drawBorder,delete s.drawBorder),o[e]={borderColor:"#000000",drawBorder:i,...t}}}}migratePropState(e){}},new class{targetMetaInfoVersion(){return 53}migrateMetaInfo(e){const t=e,i=e;if(i._metainfoVersion=53,void 0!==t.defaults){if(void 0!==t.defaults.ohlcPlots&&void 0!==t.ohlcPlots){const e=Object.keys(t.ohlcPlots),r=t.defaults.ohlcPlots,n=(0,s.ensureDefined)((0,s.ensureDefined)(i.defaults).ohlcPlots);for(const t of e){const e=r[t];if(void 0===e||void 0===e.visible)continue;const i=e.visible?15:0;delete e.visible,n[t]={display:i,...e}}}if(void 0!==t.defaults.styles&&void 0!==t.plots){const e=t.plots.map((e=>e.id)),r=t.defaults.styles,n=(0,s.ensureDefined)((0,s.ensureDefined)(i.defaults).styles);for(const t of e){const e=r[t];if(void 0===e||void 0===e.visible)continue;const i=e.visible?15:0;delete e.visible,n[t]={display:i,...e}}}}}migratePropState(e){if(e.ohlcPlots)for(const t of Object.keys(e.ohlcPlots)){const i=(0,s.ensureDefined)(e.ohlcPlots[t]);void 0!==i.visible&&(i.display=i.visible?15:0,delete i.visible)}if(e.styles)for(const t of Object.keys(e.styles)){
const i=(0,s.ensureDefined)(e.styles[t]);void 0!==i.visible&&(i.display=i.visible?15:0,delete i.visible)}}}];function d(e,t){const i=r.StudyMetaInfo.versionOf(e),n=e;void 0===n._serverMetaInfoVersion&&(n._serverMetaInfoVersion=i);const o=["PennantCP@tv-basicstudies","WedgeCP@tv-basicstudies"].includes(e.id);l.forEach((r=>{(i<0||i>=r.targetMetaInfoVersion())&&!o||(r.migrateMetaInfo(e),void 0!==t&&r.migratePropState(t),(0,s.assert)(e._metainfoVersion===r.targetMetaInfoVersion()))}))}l.push(new u),l.sort((function(e,t){return e.targetMetaInfoVersion()-t.targetMetaInfoVersion()}))},879938:(e,t,i)=>{"use strict";function s(e,t="shift",i){return{studyConstructorAsyncGetter:e,colorRotationMode:t,colorRotationComparator:i}}i.d(t,{addStudyInfoToMap:()=>n,createStudyInfo:()=>s,getStudyClassName:()=>a,getStudyInfoByName:()=>o});const r=new Map;function n(e,t){r.set(e,t)}function o(e){return r.get(e)}function a(e){for(const[t,i]of r.entries())if(i.studyConstructor===e)return t;return null}},296842:(e,t,i)=>{"use strict";i.d(t,{fundamentalsPrefix:()=>s,isFundamentalStudyMetaInfo:()=>r,studyNameByMetaInfo:()=>n});const s="study_Internal$STD;Fund_";function r(e){return n(e)===s}function n(e){const t="study_"+(e.classId||e.shortId);return t.startsWith(s)?s:t}},170411:(e,t,i)=>{"use strict";i.d(t,{StudyStatusProviderBase:()=>u});var s=i(901110),r=i(757402),n=i(287741);const o={NONE:"Default"},a=!0;class u extends s.StatusProviderBase{constructor(e){super(),this._source=e}getSplitTitle(){return this._source.titleInParts(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}: ${this.sourceStatusText()}`:`${this._source.title(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)} ${this.sourceStatusText()}`:this._source.title(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}sourceStatusText(){return(0,r.convertStudyStatusToString)(this._source.status(),!0)}errorStatus(){if(!this._source.isActualInterval()||this._source.isSymbolInvalid())return null;const e=this._source.status();return e.type===r.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:(0,r.studyStatusSolutionId)(e),title:(0,r.studyStatusTitle)(e),studyFeature:(0,r.studyStatusFeature)(e),stackTrace:(0,r.studyErrorStatusStackTrace)(e.errorDescription.stack_trace),editorError:e.errorDescription.editorError}:null}}},323719:(e,t,i)=>{"use strict";i.d(t,{StudyStatusView:()=>r});var s=i(32904);class r extends s.StatusView{constructor(e){super(e.statusProvider())}getSplitTitle(){return this._statusProvider.getSplitTitle()}update(){this._text=this._statusProvider.text()}}},872842:(e,t,i)=>{"use strict";i.d(t,{StudyStub:()=>A,isStudyStubDescriptor:()=>P});var s=i(650279),r=i(130551),n=i(650151),o=i(120984),a=i(375397),u=i(643322),l=i(322825),d=i(219849),c=i(323719),p=i(475892),_=i(735211),f=i(942634),h=i(658843),S=i(170411),y=i(287741);class I extends S.StudyStatusProviderBase{text(){
return this._source.isActualInterval()?`${this._source.title(y.TitleDisplayTarget.StatusLine)} ${this.sourceStatusText()}`:this._source.title(y.TitleDisplayTarget.StatusLine)}}var g=i(757402),v=i(198930),T=i(850723);class E{getItems(){return[]}getValues(e){return[]}}const m=new f.Delegate;class A extends p.PriceDataSource{constructor(e,t,i,s,r=null){super(e),this._priceStep=.01,this._origState=null,this._descriptor=null,this._status={type:g.StudyStatusType.Undefined},this._statusChanged=new f.Delegate,this._descriptorChanged=new f.Delegate,this._formatter=new _.PriceFormatter({priceScale:100}),this._showPineVersionInStatusLine=new a.WatchedValue(!1).spawn(),this._pineSourceCodeModel=null,(0,T.isStudyDescriptor)(t)?this._descriptor=t:this._origState=t,this._title=i,this._alwaysShowInLegend=void 0!==s,this._isOverlay=s,this._studyMetaInfo=r;this._properties=new h.Property({visible:!0}),this._statusView=new c.StudyStatusView(this),r&&(0,l.isCountedUserScript)(r)&&(this._showPineVersionInStatusLine=(0,u.combine)((()=>(0,l.userScriptVersionsCount)(r.scriptIdPart)>1),(0,l.userScriptsOnLayout)().weakReference()),this._showPineVersionInStatusLine.subscribe((()=>e.updateSource(this))))}destroy(){var e,t,i;null===(t=null===(e=this._pineSourceCodeModel)||void 0===e?void 0:e.get())||void 0===t||t.destroy(),null===(i=this._pineSourceCodeModel)||void 0===i||i.destroy(),this._showPineVersionInStatusLine.destroy(),super.destroy()}barColorer(){return null}properties(){return this._properties}statusView(){return this._statusView}legendView(){return null}state(e){return this._origState}getDescriptor(){return null===this._descriptor?null:{descriptor:this._descriptor,title:this._title,isOverlay:this._isOverlay,id:this.id(),status:this._status}}updateDescriptor(e){(0,s.default)(this._descriptor,e)||(this._descriptor=e,this._descriptorChanged.fire())}onDescriptorChanged(){return this._descriptorChanged}metaInfo(){return this._studyMetaInfo}setMetaInfo(e){this._studyMetaInfo=e}setStatus(e){const t=this.isDisplayedInLegend();if(this._status=e,this._statusChanged.fire(),this.isDisplayedInLegend()!==t){const e=this._model.paneForSource(this);if(e){const t=this._model.panes().indexOf(e),i=d.InvalidationMask.invalidateLegendWidgetLayout(t);this.model().invalidate(i)}}}formatter(){return this._formatter}name(){return this._title}title(){return this.titleInParts().join(" ")}titleInParts(){var e;const t=[this._title];return this._showPineVersionInStatusLine.value()&&t.push((0,n.ensureDefined)(null===(e=this._studyMetaInfo)||void 0===e?void 0:e.pine).version),t}isFailed(){return this._status.type===g.StudyStatusType.Error}isLoading(){return this._status.type===g.StudyStatusType.Loading}isDisplayedInLegend(){return this._alwaysShowInLegend||this.isFailed()}setFailed(e){this.setStatus({type:g.StudyStatusType.Error,errorDescription:{error:e}}),this._model.updateSource(this)}isSymbolInvalid(){return!1}isActualInterval(){return!0}onIsActualIntervalChange(){return m}start(){}status(){return this._status}onStatusChanged(){return this._statusChanged}
firstValue(){return null}currency(){return null}sessionId(){return this._model.mainSeries().sessionId()}sessionIdChanged(){return this._model.mainSeries().sessionIdChanged()}unit(){return null}symbolSource(){return this._model.mainSeries()}barsProvider(){return this._model.mainSeries()}legendValuesProvider(){return new E}statusProvider(e){return new I(this)}isRemovedByStudyTemplates(){return null!==this._origState&&(0,v.isStudyState)(this._origState)}pineSourceCodeModel(){return null!==this._descriptor&&"pine"===this._descriptor.type?(this._pineSourceCodeModel||(this._pineSourceCodeModel=new o.AsyncResourceWrapper(Promise.all([i.e(98410),i.e(58722),i.e(87),i.e(13399),i.e(89199)]).then(i.bind(i,437334)).then((e=>this._isDestroyed?null:new e.PineStubSourceCodeModel(this))))),this._pineSourceCodeModel.promise()):Promise.resolve(null)}}function P(e){return(0,r.isObject)(e)&&"descriptor"in e&&(0,T.isStudyDescriptor)(e.descriptor)}},406137:(e,t,i)=>{"use strict";i.d(t,{applyOverridesToStudyDefaults:()=>c});var s=i(650151),r=i(748947),n=i(338619);const o={line:r.LineStudyPlotStyle.Line,histogram:r.LineStudyPlotStyle.Histogram,cross:r.LineStudyPlotStyle.Cross,area:r.LineStudyPlotStyle.Area,columns:r.LineStudyPlotStyle.Columns,circles:r.LineStudyPlotStyle.Circles,line_with_breaks:r.LineStudyPlotStyle.LineWithBreaks,area_with_breaks:r.LineStudyPlotStyle.AreaWithBreaks,step_line:r.LineStudyPlotStyle.StepLine,step_line_with_breaks:r.LineStudyPlotStyle.StepLineWithBreaks,step_line_with_diamonds:r.LineStudyPlotStyle.StepLineWithDiamonds},a=(0,n.getLogger)("Chart.Model.StudyPropertiesOverrider");var u,l;function d(e,t,i,s){const r=i.split(".");if(0===r.length||0===r[0].length)return;const n=function(e){const t=e.split(":");return{name:t[0],type:2===t.length?t[1]:null}}(r[0]),o=n.name,d=n.type,c=null!==d,p=!c||"band"===d,_=!c||"area"===d,f=!c||"input"===d,h=!c||"plot"===d?l.getPlotIdByTitle(e,o):null,S=p?l.getBandIndexByName(e,o):null,y=_?l.getFilledAreaIdByTitle(e,o):null,I=f?l.getInputByName(e,o):null,g=t.hasOwnProperty(o);if((null!==h?1:0)+(null!==S?1:0)+(null!==y?1:0)+(null!==I?1:0)+(g?1:0)>1)return void a.logWarn(`Study '${e.description}' has ambiguous identifier '${o}'`);const v=r[1];if(null!==h){if(1===r.length)return void a.logWarn(`Path of sub-property of '${o}' plot for study '${e.description}' must be not empty`);const i=r.slice(1);u.applyPlotProperty(e,t,h,i,s)}else if(null!==I)u.applyInputValue(t,I,s);else if(null!==S){if(void 0===v)return void a.logWarn(`Property name of '${o}' band for study '${e.description}' must be set`);u.applyBandProperty(t,S,v,s)}else if(null!==y){if(void 0===v)return void a.logWarn(`Property name of '${o}' area for study '${e.description}' must be set`);u.applyFilledAreaProperty(t,y,v,s)}else g?u.setRootProperty(t,r,s):a.logWarn(`Study '${e.description}' has no plot or input '${o}'`)}function c(e,t,i){for(const s in e){if(!e.hasOwnProperty(s))continue;const r=s.indexOf(".");if(-1===r)continue;const n=s.substring(0,r),o=l.getMetaInfoByDescription(t,n);if(null===o){
a.logWarn(`There is no such study ${n}`);continue}const u=i(o);null!==u?d(o,u,s.substring(r+1),e[s]):a.logWarn(`Cannot apply overrides for study ${n}`)}}!function(e){e.applyPlotProperty=function(e,t,i,n,u){if(void 0===t.styles)return void a.logWarn("Study does not have styles");const l=n[0];if("color"===l){const o=function(e,t,i){if(void 0===e.plots)return null;for(const s of e.plots){if(!(0,r.isPaletteColorerPlot)(s)||void 0===t.palettes)continue;const e=t.palettes[s.palette];if(s.target===i&&void 0!==e)return e}return null}(e,t,i);return void function(e,t,i,r,n){var o;void 0!==e.styles?null===t&&!isNaN(r)&&r>0?a.logWarn(`Study plot does not have color #${r}`):((0===r||isNaN(r))&&((0,s.ensureDefined)(e.styles[i]).color=String(n),r=0),null!==t&&((0,s.ensureDefined)(null===(o=t.colors)||void 0===o?void 0:o[r]).color=String(n))):a.logWarn("Study does not have styles")}(t,o,i,n.length>1?parseInt(n[1]):NaN,u)}const d=t.styles[i];if(void 0!==d&&d.hasOwnProperty(l)){if("plottype"===l){const e=o[String(u)];if(void 0===e)return void a.logWarn(`Unsupported plot type for plot: ${u}`);u=e}d[l]=u}else a.logWarn(`Study plot does not have property '${l}'`)},e.applyBandProperty=function(e,t,i,s){if(void 0===e.bands)return void a.logWarn("Study does not have bands");const r=e.bands[t];if(void 0!==r&&r.hasOwnProperty(i)){if("plottype"===i){const e=o[String(s)];if(void 0===e)return void a.logWarn(`Unsupported plot type for band: ${s}`);s=e}r[i]=s}else a.logWarn(`Study band does not have property '${i}'`)},e.applyFilledAreaProperty=function(e,t,i,s){if(void 0===e.filledAreasStyle)return void a.logWarn("Study does not have areas");const r=e.filledAreasStyle[t];void 0!==r&&r.hasOwnProperty(i)?r[i]=s:a.logWarn(`Study area does not have property '${i}'`)},e.applyInputValue=function(e,t,i){void 0!==e.inputs&&e.inputs.hasOwnProperty(t)?e.inputs[t]=i:a.logWarn(`Study does not have input '${t}'`)},e.setRootProperty=function(e,t,i){if(0===t.length)return;let s=e;for(const e of t.slice(0,-1)){if(null==s||!s.hasOwnProperty(e))break;s=s[e]}const r=t[t.length-1];null!=s&&s.hasOwnProperty(r)?s[r]=i:a.logWarn(`Study does not have property ${t.join(".")}`)}}(u||(u={})),function(e){e.getInputByName=function(e,t){if(void 0===e.inputs)return null;t=t.toLowerCase();for(const i of e.inputs)if(i.name.toLowerCase()===t)return i.id;return null},e.getPlotIdByTitle=function(e,t){if(void 0===e.styles)return null;t=t.toLowerCase();for(const i in e.styles){const s=e.styles[i];if((void 0!==s&&void 0!==s.title?s.title:i).toLowerCase()===t)return i}return null},e.getFilledAreaIdByTitle=function(e,t){if(void 0===e.filledAreas)return null;t=t.toLowerCase();for(const i of e.filledAreas)if(i.title.toLowerCase()===t)return i.id;return null},e.getBandIndexByName=function(e,t){if(void 0===e.bands)return null;t=t.toLowerCase();for(let i=0;i<e.bands.length;++i)if(e.bands[i].name.toLowerCase()===t)return i;return null},e.getMetaInfoByDescription=function(e,t){t=t.toLowerCase();for(const i of e)if(i.description.toLowerCase()===t||i.shortDescription.toLowerCase()===t)return i
;return null}}(l||(l={}))},382318:(e,t,i)=>{"use strict";var s=i(306060).Version,r=i(338619).getLogger("Chart.StudyMigration");function n(e){this._studyId=e,this._maxToVers=s.ZERO,this._maxFromVers=s.ZERO,this._migrs=[]}n.prototype.addMigration=function(e,t,i){var r=s.parse(e),n=s.parse(t);r.isGreater(this._maxFromVers)&&(this._maxFromVers=r),n.isGreater(this._maxToVers)&&(this._maxToVers=n),this._migrs.push({fromVers:r,toVers:n,rules:i})},n.prototype.updateInputs=function(e,t,i){if(!i)return i;for(var s=TradingView.clone(i),n=e;n.isLess(t);){var o=this._findMigration(n);if(null==o)break;if(r.logNormal("Migrating study inputs from "+o.fromVers+" to "+o.toVers+" version, studyId: "+this._studyId+", migration: "+JSON.stringify(o)+", inputs: "+JSON.stringify(i)),s=this._applyMigration(s,o),!n.isLess(o.toVers))throw new Error("Problems in study migration process... Possible infinite cycle has been detected and stopped.");n=o.toVers}return n>e&&r.logNormal("Study inputs migration is done, studyId: "+this._studyId+", inputs: "+JSON.stringify(s)),s},n.prototype._findMigration=function(e){for(var t=-1,i=this._maxFromVers,s=0;s<this._migrs.length;s++){var r=this._migrs[s];r.fromVers.isLess(e)||r.fromVers.isLessOrEqual(i)&&(i=r.fromVers,t=s)}return t<0?null:this._migrs[t]},n.prototype._applyMigration=function(e,t){for(var i=e,s=0;s<t.rules.length;s++){var r=t.rules[s];i=this._getApplyRuleFun(r.type)(i,r)}return i},n.prototype._getApplyRuleFun=function(e){if("inputRemoved"===e)return n._applyInputRemovedRule;if("inputChangedType"===e)return n._applyInputChangedTypeRule;if("inputChangedMinMax"===e)return n._applyInputChangedMinMaxRule;if("inputChangedOptions"===e)return n._applyInputChangedOptionsRule;throw new Error("Unknown migration rule type: "+e)},n._applyInputRemovedRule=function(e,t){if(!(t.inputId in e))return e;if("removeVal"!==t.action)throw new Error("Unexpected rule.action="+t.action+" in rule.type="+t.type);var i=e[t.inputId];return delete e[t.inputId],r.logNormal("Input "+t.inputId+"="+i+" removed"),e},n._applyInputChangedTypeRule=function(e,t){var i=e[t.inputId];if("resetToDefVal"===t.action)return e[t.inputId]=t.defVal,r.logNormal("Input "+t.inputId+"="+i+" reset to default value "+t.defVal),e;if("convertVal"===t.action){if(null==i)return e;if("float"===t.inputTypeFrom&&"integer"===t.inputType)return e[t.inputId]=Math.round(e[t.inputId]),r.logNormal("Input "+t.inputId+"="+i+" converted to value "+e[t.inputId]),e;if("integer"===t.inputTypeFrom&&"float"===t.inputType)return e;if("text"===t.inputTypeFrom&&"source"===t.inputType)return n._isValidSource(i,t.options)||(e[t.inputId]=t.defVal),e;throw new Error("Cannot convertVal from "+t.inputTypeFrom+" to "+t.inputType)}throw new Error("Unknown action "+t.action+" for rule with type "+t.type)},n._isValidSource=function(e,t){return e.indexOf("$")>=0||t.indexOf(e)>=0},n._applyInputChangedMinMaxRule=function(e,t){if("adjustValIfNeeded"!==t.action)throw new Error("Unknown action "+t.action+" for rule with type "+t.type);var i=e[t.inputId]
;return i<t.minVal?e[t.inputId]=t.minVal:i>t.maxVal&&(e[t.inputId]=t.maxVal),r.logNormal("Input "+t.inputId+"="+i+" adjusted to value "+e[t.inputId]),e},n._applyInputChangedOptionsRule=function(e,t){if(!(["text"].indexOf(t.inputType)>=0&&"resetToDefValIfNeeded"===t.action))throw new Error("Unexpected rule.inputType="+t.inputType+" in rule.action="+t.action);var i=e[t.inputId];return t.options.indexOf(i)<0&&(e[t.inputId]=t.defVal,r.logNormal("Input "+t.inputId+"="+i+" reset to default value "+t.defVal)),e},e.exports=n},500323:(e,t,i)=>{"use strict";i.d(t,{StudyVersioning:()=>g});var s=i(998034),r=i(650151),n=i(637761),o=i(382318),a=i.n(o),u=i(338619),l=i(306060),d=i(874546),c=i(870408),p=i(444372);var _=i(923451),f=i(971417),h=i(66974),S=i(124829);const y=(0,u.getLogger)("Chart.Study.Versioning"),I=1e12;class g{constructor(e,t){if(this._migrations={},!e)throw new Error("No studies metainfo");if(this._studiesMetainfo=e,!t)throw new Error("No studies migrations");this._studiesMigrations=t;for(let e=0;e<this._studiesMigrations.length;e++){const t=this._studiesMigrations[e],i=t.versFrom,s=t.versTo;for(let e=0;e<t.studyMigrations.length;e++){const r=t.studyMigrations[e],n=r.studyId;if(0===r.rules.length){y.logError("Study Migration should have at least one convertion rule");continue}const o=n in this._migrations?this._migrations[n]:new(a())(n);o.addMigration(i,s,r.rules),this._migrations[n]=o}}this._clientMigrations=[(e,t)=>{if(0===this._studiesMetainfo.length||!e.isTVScript||e.version>=22)return t;const i={};let s=0,r=0,n=t[r];for(;void 0!==n;){const e=t[n.id];n.isFake&&(n.id="in_"+s++),i[r]=n,i[n.id]=e,r++,n=t[r]}return i}]}updateMetaInfoAsync(e){const t=n.StudyMetaInfo.versionOf(e);if(e.isTVScript&&!e.pine&&t<43){(0,r.assert)((0,S.isExistent)(e.scriptIdPart),"scriptIdPart is missing, study "+JSON.stringify(e));const t=e.scriptIdPart;return{sync:!1,result:new Promise(((i,s)=>{(0,_.processLegacy)(t,e.TVScriptSourceCode).then((t=>{e.removeDefaults();const s=new n.StudyMetaInfo(t);s.createDefaults();const r=s.state();(0,d.migrateMetaInfoAndPropState)(r),i(new n.StudyMetaInfo(r))})).catch((e=>{s(e)}))}))}}if(e.isTVScript&&e.pine){if((e._serverMetaInfoVersion||t)<52){return{sync:!1,result:(0,c.translateScriptAsync2)(e.scriptIdPart,e.pine.version).then((t=>{e.removeDefaults();const i=new n.StudyMetaInfo(t.metaInfo);i.createDefaults();const s=i.state();return(0,d.migrateMetaInfoAndPropState)(s),new n.StudyMetaInfo(s)}))}}return e.createDefaults(),{sync:!0,result:e}}{let t=null;const i=this._studiesMetainfo;for(let s=0;s<i.length;s++)if(i[s].id===e.id){t=i[s];break}return{sync:!0,result:t?new n.StudyMetaInfo(t.state()):null}}}updateStudyState(e,t,i){if(null==e||null==t||null==i)return e;e=(0,S.clone)(e),this.updateStudyInputsIfNeeded(e,t.version,i);for(const i of this._clientMigrations){const s=i.call(this,t,e.inputs);Object.keys(s).length===Object.keys(e.inputs).length?e.inputs=s:y.logWarn("StudyVersioning._clientMigrations application returned bad result. Skipping it...")}const s=n.StudyMetaInfo.versionOf(t)
;if(t.isTVScript&&t.TVScriptSourceCode&&s>=12&&s<=26){const s={};for(let e=0;e<t.plots.length;++e){const r=t.plots[e],n=i.plots[e];s[r.id]=n.id}const r=Object.keys(e.styles);for(let t=0;t<r.length;++t){const i=r[t],n=e.styles[i];delete e.styles[i];const o=s[i];e.styles[o]=n}const n=Object.keys(e.plots);for(let t=0;t<n.length;++t){const i=n[t],r=e.plots[i].id;e.plots[i].id=s[r]}}return e}updateStudyInputsIfNeeded(e,t,i){if(!(i.isTVScript||!!i.pine)&&t!==i.version){const s=i&&i.defaults.inputs;e.inputs=this.updateStudyInputs(i.id,t,i.version,e.inputs,s)}}updateStudyInputs(e,t,i,s,r){let n=(0,S.clone)(s);if(e in this._migrations){const s=l.Version.parse(t);let r;if("last"===i){const t=this.lastVersionOfStudy(e);r=l.Version.parse(t)}else r=l.Version.parse(i);n=this._migrations[e].updateInputs(s,r,n)}if(null==r)return n;for(const e in r)e in n||(n[e]=r[e]);for(const i in n)if(!(i in r)){const s=n[i];y.logWarn(`Extra input detected, studyId='${e}', versionFrom='${t}', inputId='${i}', inputValue='${s}', removing it and continue...`),delete n[i]}return n}lastVersionOfStudy(e){return(0,r.ensureDefined)(this._studiesMetainfo.find((t=>t.id===e))).version}updateMetaInfo(e){if(!e)return e;(0,r.assert)(e instanceof n.StudyMetaInfo),(0,r.assert)(!e.isTVScript,"This method should update only built-in java indicators metaInfo. For Pine indicators use updateMetaInfoAsync");const t=this._studiesMetainfo.find((t=>e.id===t.id));return t?new n.StudyMetaInfo(t.state()):null}static patchPointsBasedStudyState(e){return this._fixInputsMaxValue(e.state,e.metaInfo),"LineToolRegressionTrend"===e.type&&(e=function(e){const t={palettes:{},inputs:[{defval:2,id:"upper diviation",max:500,min:-500,name:p.t(null,void 0,i(591900)),type:"integer"},{defval:-2,id:"lower diviation",max:500,min:-500,name:p.t(null,void 0,i(831736)),type:"integer"},{defval:!0,id:"use upper diviation",name:p.t(null,void 0,i(784451)),type:"bool"},{defval:!0,id:"use lower diviation",name:p.t(null,void 0,i(449299)),type:"bool"},{defval:0,id:"first bar time",max:253370764800,min:0,name:p.t(null,void 0,i(780509)),type:"time"},{defval:0,id:"last bar time",max:253370764800,min:0,name:p.t(null,void 0,i(59933)),type:"time"},{defval:"close",id:"source",name:p.t(null,void 0,i(997751)),options:["open","high","low","close","hl2","hlc3","ohlc4"],type:"text"}],plots:[],graphics:{},defaults:{inputs:{"first bar time":0,"last bar time":0,"lower diviation":-2,source:"close","upper diviation":2,"use lower diviation":!0,"use upper diviation":!0}},_metainfoVersion:6,description:"Regression Trend",id:"RegressionTrend@tv-basicstudies",is_price_study:!0,shortDescription:"Reg Trend",shortId:"RegressionTrend",version:"2",fullId:"RegressionTrend@tv-basicstudies-2",name:"RegressionTrend@tv-basicstudies"};return e.metaInfo||(e.metaInfo=t),e}(e)),e}static patchStudyData(e,t,i,s){if(!(0,h.isProd)())return{data:t,nsData:i,indexes:null!=s?s:void 0};const r=(0,S.clone)(t),o=(0,S.clone)(i),a=(0,S.clone)(s)
;"VbPVisible@tv-volumebyprice"===e.id&&e.version&&+e.version<=4&&this._patchOldVolumeProfiles(0,null==r?void 0:r.graphics),"VbPSessions@tv-volumebyprice"===e.id&&e.version&&+e.version<=4&&this._patchOldVolumeProfiles(0,null==r?void 0:r.graphics);const u=n.StudyMetaInfo.versionOf(e);if(r&&e.isTVScript&&e.TVScriptSourceCode&&u>=12&&u<=26){const e=r.columns,t=[];r.columns=t;for(let i=0;i<e.length;++i){const e="plot_"+i;t.push(e)}}return{data:r,nsData:o,indexes:null!=a?a:void 0}}static patchPointsBasedStudyData(e,t){if(!(0,h.isProd)())return t;if(!e||!t)return t;const i=(0,S.clone)(t);return"VbPFixed@tv-volumebyprice"===e.id&&e.version&&+e.version<=4&&this._patchOldVolumeProfiles(0,i),i}static patchPropsStateAndMetaInfo(e,t,i){var r,o;let a=t.state();"Script$BOOKER"!==t.productId||a.alerts||delete e.alerts,this._fixInputsOrder(e,a),this._fixInputsMaxValue(e,a);const u=this.splitInputs(e.inputs);e.inputs=u.obj;const l=n.StudyMetaInfo.versionOf(t);l<42&&a.isChildStudy&&(e.isChildStudy=a.isChildStudy);if(t.isTVScript&&t.version<60&&("Script$TV_EARNINGS@tv-scripting"!==t.id&&"Script$TV_DIVIDENDS@tv-scripting"!==t.id&&"Script$TV_SPLITS@tv-scripting"!==t.id||delete a.TVScriptSourceCode),"Volume"!==t.id&&"Volume@tv-basicstudies"!==t.id||0!==t.inputs.length||(a.inputs=[{id:"length",type:"integer",defval:20,min:1,max:1e3}],a.plots.push({id:"vol_ma",type:"line"})),"Volume@tv-basicstudies"===t.id&&t.version&&t.version<=46&&void 0===e.styles.vol.transparency&&(e.styles.vol.transparency=e.transparency||87),"PivotPointsStandard@tv-basicstudies"===t.id&&(0===a.inputs.length?(e.inputs={kind:"Traditional",showHistoricalPivots:!0},a.inputs=[{defval:"Traditional",id:"kind",type:"text",options:["Traditional","Fibonacci","Woodie","Classic","DeMark","Camarilla"]},{id:"showHistoricalPivots",type:"bool",defval:!0}]):1===a.inputs.length&&(e.inputs={kind:"Traditional"},a.inputs=[{defval:"Traditional",id:"kind",type:"text",options:["Traditional","Fibonacci","Woodie","Classic","DeMark","Camarilla"]},{id:"showHistoricalPivots",type:"bool",defval:!0}]),void 0===e._hardCodedDefaultsVersion)){e._hardCodedDefaultsVersion=1;const t=e.color;delete e.color,e.levelsStyle={colors:{P:t,"S1/R1":t,"S2/R2":t,"S3/R3":t,"S4/R4":t,"S5/R5":t}}}"CMF"===t.shortId&&2===a.inputs.length&&(e.inputs={length:e.inputs["length fast"]},a.inputs=a.inputs.splice(0,1),a.inputs[0].id="length"),a.defaults&&void 0===a.defaults.precision&&l<46&&(-1!==["Volume@tv-basicstudies","VbPVisible@tv-volumebyprice","VbPSessions@tv-volumebyprice"].indexOf(t.id)?a.defaults.precision=0:a.defaults.precision=4);let c=t.id;if(t.version<60){const e=["TV_DIVIDENDS","TV_SPLITS","TV_EARNINGS"],i="Script".length;for(let s=0;s<e.length;s++)t.id.startsWith("Script$"+e[s]+"@tv-scripting")&&(a.fullId="ESD"+a.fullId.substring(i),a.id="ESD"+a.id.substring(i),a.name&&(a.name="ESD"+a.name.substring(i)),a.shortId="ESD"+a.shortId.substring(i),a.productId="ESD"+a.productId.substring(i),c="ESD"+t.id.substring(i))}const p={"ESD$TV_EARNINGS@tv-scripting":{fullId:"Earnings@tv-basicstudies-129!",
id:"Earnings@tv-basicstudies",name:"Earnings@tv-basicstudies",shortId:"Earnings",productId:"tv-basicstudies"},"ESD$TV_SPLITS@tv-scripting":{fullId:"Splits@tv-basicstudies-129!",id:"Splits@tv-basicstudies",name:"Splits@tv-basicstudies",shortId:"Splits",productId:"tv-basicstudies"},"ESD$TV_DIVIDENDS@tv-scripting":{fullId:"Dividends@tv-basicstudies-129!",id:"Dividends@tv-basicstudies",name:"Dividends@tv-basicstudies",shortId:"Dividends",productId:"tv-basicstudies"}};if(c in p&&Object.assign(a,p[c]),l<43){const i={"StrategyScript$STD;Consecutive%1Ups/Downs%1Strategy":{pineId:"STD;Consecutive%1Ups%1Downs%1Strategy",className:"StrategyScript"},Script$EDGR_NET_INCOME_FROM_CONTINUING_OPERATIONS_APPLICABLE_TO_COMMON_V2:{pineId:"Script$EDGR_NET_INCOME_FROM_CONTINUING_OPS_APPLICABLE_TO_COMMON_V2",className:"Script"}};if(t.shortId in i){const n=i[t.shortId].className+"$"+i[t.shortId].pineId,o={scriptIdPart:i[t.shortId].pineId,fullId:a.fullId.replace(a.shortId,n),id:a.id.replace(a.shortId,n),name:null===(r=a.name)||void 0===r?void 0:r.replace(a.shortId,n),shortId:n};(0,s.default)(a,o),(0,s.default)(e,o)}const n=(0,f.extractPineId)(t.fullId),u=n&&n.match(/^(USER)(_\d+)(;)(.*)$/);if(u){const t=u[0],i=u[1]+u[3]+u[2]+u[4],r={scriptIdPart:i,fullId:a.fullId.replace(t,i),id:a.id.replace(t,i),name:null===(o=a.name)||void 0===o?void 0:o.replace(t,i),shortId:a.shortId.replace(t,i)};(0,s.default)(a,r),(0,s.default)(e,r)}}if("MA"===t.id){const t={id:"MAExp",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgExp",type:"line"}],palettes:{}},i={id:"MASimple",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgSimple",type:"line"}],palettes:{}},s={id:"MAVolumeWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgVolumeWeighted",type:"line"}],palettes:{}},r={id:"MAWeighted",properties:[{id:"is_price_study",type:"bool",value:"true"}],inputs:[{id:"length",type:"integer",defval:20,min:1,max:500},{id:"source",type:"text",defval:"close",options:["open","high","low","close"]}],plots:[{id:"MovAvgWeighted",type:"line"}],palettes:{}};switch(e.inputs.type){case"exp":a=t;break;case"simple":a=i;break;case"weighted":a=r;break;case"volume weighted":a=s}e.styles[a.plots[0].id]=e.styles.MovAvg,delete e.styles.MovAvg,delete e.inputs.type}return i.oldShowStudyLastValueProperty&&(e.oldShowLastValue=e.showLastValue),delete e.showLastValue,delete e.showStudyArguments,(0,d.migrateMetaInfoAndPropState)(a,e),{propsState:e,metaInfo:a}}static splitInputs(e){const t={},i={};for(const[s,r]of Object.entries(e))(0,S.isNumber)(parseInt(s,10))?t[s]=r:i[s]=r;return{arr:t,obj:i}}
static verifyInputsMaxValue(e){if(e.inputs)for(const t of e.inputs)"integer"===t.type&&t.max&&t.max>I&&y.logWarn("Bad integer input max value in metaInfo id="+e.id+" title="+e.description)}static mergeInputsObjPart(e,t){const i=this.splitInputs(t);(0,s.default)(e,i.obj)}static _fixInputsOrder(e,t){const i=this._getOrderedInputIds(t),r=this.splitInputs(e.inputs),n=r.arr,o=r.obj,a=(0,s.default)({},o);for(let e=0;e<i.length;++e){const t=i[e],s=this._findInputKeyById(n,t);null!==s&&(a[e]=n[s])}e.inputs=a}static _fixInputsMaxValue(e,t){if((0,S.isAbsent)(t))return;const i=I;if(t.inputs)for(const e of t.inputs)"integer"===e.type&&e.max&&e.max>i&&(e.max=i);if(!e||!e.inputs)return;const r=this.splitInputs(e.inputs),n=r.arr;for(const[,e]of Object.entries(n))"integer"===e.type&&e.max&&e.max>i&&(e.max=i);e.inputs=(0,s.default)(r.obj,r.arr)}static _findInputKeyById(e,t){let i=null;for(const s in e)if((0,S.isNumber)(parseInt(s,10))&&e[s].id===t){i=s;break}return i}static _getOrderedInputIds(e){const t=[];for(const i of e.inputs)t.push(i.id);return t}static _patchOldVolumeProfiles(e,t){if(!(null==t?void 0:t.hhists))return;const i=t.hhists[e].data,s=[];for(const[,e]of Object.entries(i))s.push(e);t.hhists[0].data=s}}},322825:(e,t,i)=>{"use strict";i.d(t,{addUserScriptOnLayout:()=>u,isCountedUserScript:()=>c,removeUserScriptFromLayout:()=>l,userScriptVersionsCount:()=>a,userScriptsOnLayout:()=>d});var s=i(971417),r=i(566238),n=i(306060);const o=new r.WatchedObject([]);function a(e){return new Set(o.value().filter((t=>t.id===e)).map((e=>e.version))).size}function u(e,t){o.setValue([...o.value(),{id:e,version:t}])}function l(e,t){const i=o.value().findIndex((i=>i.id===e&&i.version===t));-1!==i&&o.value().splice(i,1),o.setValue(o.value(),!0)}function d(){return o.readonly()}function c(e){return!!e.pine&&n.Version.parse(e.pine.version).major()>=1&&(0,s.isCustomPineId)(e.scriptIdPart)}},625611:(e,t,i)=>{"use strict";i.d(t,{StudyMetaInfoBase:()=>I,replayStrategyStudyId:()=>y});var s=i(283873),r=i(650151),n=i(748947),o=i(218049),a=i(124829),u=i(211183),l=i(633339),d=i(187700);const c=new Set(["CorrelationCoefficient@tv-basicstudies","Correlation - Log@tv-basicstudies-1"]),p=new Set([]),_=new Set(["line"]),f=new Map([["AnchoredVWAP@tv-basicstudies","linetoolanchoredvwap"],["RegressionTrend@tv-basicstudies","linetoolregressiontrend"],["VbPAnchored@tv-basicstudies","linetoolanchoredvp"]]),h=/^([^\$]+)\$\d+$/,S=["bool","color","time","text_area"],y="ReplayStrategy@tv-scripting";class I{constructor(e,t=!1){(0,a.merge)(this,{palettes:{},inputs:[],plots:[],graphics:{},defaults:{}}),(0,a.merge)(this,e);const i=e.fullId||e.id;(0,a.merge)(this,I.parseIdString(i)),this._updateInputDisplayDefaults(),this.useVersionFromMetaInfo=t}state(){const e={};for(const[t,i]of Object.entries(this))"useVersionFromMetaInfo"!==t&&this.hasOwnProperty(t)&&(e[t]=i,"id"===t&&(e[t]+="-"+this.version));return e}createDefaults(){if(this.defaults){const e=(0,a.clone)(this.defaults);e.precision="default";const t=I.getStudyPropertyRootName(this);(0,u.createDefaults)(t,e)}}
removeDefaults(){(0,u.removeDefaults)(I.getStudyPropertyRootName(this))}isPlotForceOverlay(e){var t,i,s,r,o;const a=null===(t=this.styles)||void 0===t?void 0:t[e],u=this.plots.find((t=>t.id===e));return!!(null==a?void 0:a.forceOverlay)||u&&(0,n.isOhlcPlot)(u)&&(null===(s=null===(i=this.ohlcPlots)||void 0===i?void 0:i[u.target])||void 0===s?void 0:s.forceOverlay)||!!(null===(o=null===(r=this.ohlcPlots)||void 0===r?void 0:r[e])||void 0===o?void 0:o.forceOverlay)}hasForceOverlayPlots(){var e;return this.plots.some((e=>this.isPlotForceOverlay(e.id)))||Object.values(null!==(e=this.ohlcPlots)&&void 0!==e?e:{}).some((e=>!!(null==e?void 0:e.forceOverlay)))}static getSourceIdsByInputs(e,t){if(!Array.isArray(e)||!t)return[];const i=[];for(const r of e)if(I.isSourceInput(r)&&(0,s.default)(t[r.id])){const e=t[r.id];e.includes("$")&&i.push(e.split("$")[0])}return i}static isSourceInput(e){return Boolean(e.id&&(("source"===e.id||"src"===e.id)&&("text"===e.type||"source"===e.type)||"source"===e.type))}static getSourceInputIds(e){const t=[];for(const i of e.inputs)I.isSourceInput(i)&&t.push(i.id);return t}static setChildStudyMetaInfoPropertiesSourceId(e,t,i){for(const s of e.inputs){if(!I.isSourceInput(s))continue;const e=i.childs().inputs&&i.childs().inputs.childs()[s.id];if(e){const i=e.value(),s=h.exec(i);if(2===(null==s?void 0:s.length)){if("{pid}"===s[1]){const s=i.replace(/^[^\$]+/,t);e.setValue(s)}}}}}static patchSoSInputs(e,t){const i=e=>{const i=h.exec(e);if(2===(null==i?void 0:i.length)){const s=i[1],n=`${(0,r.ensureNotNull)(t(s))}`;return e.replace(/^[^\$]+/,n)}return e};for(const t in e)if(/in_[\d+]/.test(t)||"source"===t){const r=e[t];(0,s.default)(r)?e[t]=i(r):(0,o.isExtendedInput)(r)&&(0,o.isExtendedInputSource)(r)&&(r.v=i(r.v))}}static canBeChild(e){if((0,s.default)(e))return!0;if(!e)return!1;if(e.extra&&!I.isAllowedSourceInputsCount(e.extra.sourceInputsCount)||!0===e.canNotBeChild||!1===e.canBeChild||c.has(e.id))return!1;let t=0;for(const i of e.inputs)I.isSourceInput(i)&&(t+=1);return I.isAllowedSourceInputsCount(t)}static isAllowedSourceInputsCount(e){return e>0||1===e}static canHaveChildren(e){if(e){if(e.isTVScriptStrategy||e.TVScriptSourceCode&&(0,d.isStrategy)(e.TVScriptSourceCode))return!1;if(e.id&&!p.has(e.id)&&Array.isArray(e.plots))for(const t of e.plots)if(_.has(t.type))return!0}return!1}static getChildSourceInputTitles(e,t,i){var s;const r={};if(t.plots&&t.plots.length&&e.options&&e.options.length)for(const n of e.options){const e=n?+n.split("$")[1]:NaN,o=isFinite(e)&&t.plots[e];o&&_.has(o.type)&&(r[n]=t.styles&&t.styles[o.id]&&(null===(s=t.styles[o.id])||void 0===s?void 0:s.title)||o.id,i&&(r[n]=i+": "+r[n]))}return r}static canPlotBeSourceOfChildStudy(e){return _.has(e)}static getStudyPropertyRootName(e){const t=f.get(e.id);if(void 0!==t)return t;let i="study_"+e.id;return e.pine&&e.pine.version&&(i+="_"+e.pine.version.replace(".","_")),i}static getStudyPropertyRootNameById(e){const t=f.get(e);return void 0!==t?t:"study_"+e}static isScriptStrategy(e){
if(e.extra&&e.extra.kind)return"strategy"===e.extra.kind;if(!0===e.isTVScriptStrategy)return!0;const t=e.TVScriptSourceCode||e.scriptSource;return!!t&&(0,d.isStrategy)(t)}static isReplayStrategy(e){return e.id===y}static parseIdString(e){return(0,l.parseIdString)(e)}_updateInputDisplayDefaults(){this.inputs.filter((e=>void 0===e.display)).forEach((e=>{S.includes(e.type)?e.display=o.InputDisplayFlags.None:e.display=o.InputDisplayFlags.All}))}}},187700:(e,t,i)=>{var s;e=i.nmd(e),"undefined"!=typeof window&&(s=window.TVScript=window.TVScript||{}),(s=s||{}).Access={},s.Access.ACCESS_OPEN_NO_AUTH="open_no_auth",s.Access.ACCESS_CLOSED_NO_AUTH="closed_no_auth",s.Access.ACCESS_CLOSED_NEEDS_AUTH="closed_needs_auth",s.Access.MAP_ID_TO_NAME={1:s.Access.ACCESS_OPEN_NO_AUTH,2:s.Access.ACCESS_CLOSED_NO_AUTH,3:s.Access.ACCESS_CLOSED_NEEDS_AUTH},s.Access.MAP_NAME_TO_ID={},Object.keys(s.Access.MAP_ID_TO_NAME).forEach((function(e){s.Access.MAP_NAME_TO_ID[s.Access.MAP_ID_TO_NAME[e]]=e})),s.PinePrefix={},s.PinePrefix.USER="USER;",s.PinePrefix.PUB="PUB;",s.PinePrefix.STD="STD;",s.PinePrefix.TV="TV_",s.PinePrefix.EDGR="EDGR_",s.PineType={},s.PineType.UserSaved="PineType_UserSaved",s.PineType.UserPublished="PineType_UserPublished",s.PineType.BuiltIn="PineType_BuiltIn",s.PineType.Addon="PineType_Addon",s.Type=s.Type||function(){},s.Type.VOID="void",s.Type.INTEGER="integer",s.Type.FLOAT="float",s.Type.STRING="string",s.Type.BOOL="bool",s.Type.COLOR="color",s.Type.SERIES="series",s.Type.PLOT="plot",s.Type.HLINE="hline",s.Type.BARCOLOR="barcolor",s.Type.BGCOLOR="bgcolor",s.Type.PLOTSHAPES="plotshape",s.Type.PLOTCHARS="plotchar",s.Type.PLOTARROWS="plotarrow",s.Type.NA="na",s.Type.ARRAY="array",s.TranslatorDefaultVersion=1,s.TranslatorReferenceVersioningIntroduced=4,s.TranslatorLastVersion=5,s.pineType=function(e){return e.startsWith(s.PinePrefix.USER)?s.PineType.UserSaved:e.startsWith(s.PinePrefix.PUB)?s.PineType.UserPublished:e.startsWith(s.PinePrefix.STD)||e.startsWith(s.PinePrefix.TV)||e.startsWith(s.PinePrefix.EDGR)?s.PineType.BuiltIn:s.PineType.Addon},s.patchILTemplate=function(e,t,i){var r=i||{};return s._patchTemplate(/<(in_\d+)>/g,e,t,r)},s.decorateQuotes=function(e){if(!e)return e;var t=/([^\\']+?)(')[^']*?/g,i="$1\\$2",s=e;return"'"==s.charAt(0)&&"'"==s.charAt(s.length-1)?"'"+(s=s.substr(1,s.length-2)).replace(t,i)+"'":s.replace(t,i)},s.patchInputs=function(e,t){var i={};for(var s in e)if(e.hasOwnProperty(s)){var r,n=e[s];r=n.isFake?{v:t[n.id],f:!0,t:n.type}:t[n.id],i[n.id]=r}return i},s._patchTemplate=function(e,t,i,r){var n=r||{};return t.replace(e,(function(e,t){for(var r=(t in n?n[t]:i.defaults.inputs[t]),o=0;o<i.inputs.length;++o)if(i.inputs[o].id===t)if("bool"===i.inputs[o].type)r=r?"1.0":"0.0";else if(["text","symbol","resolution","session"].indexOf(i.inputs[o].type)>=0)r="'"+s.decorateQuotes(r)+"'";else if("source"===i.inputs[o].type){var a=r.split("$");a[0]="'"+a[0]+"'",r="source("+a.join(",")+")"}return r}))},s.isStrategy=function(e){return/^\s*strategy\s*\(/m.test(e)}
;var r=/^\s*\/\/\s*?@version\s*?=\s*?(\S*?)\s*?$/gm,n=/^[0-9]+$/;s.extractVersion=function(e){r.lastIndex=0;var t=r.exec(e);if(null===t)return 1;var i=t[1],o=n.test(i)?Number(i):NaN;return isNaN(o)?1:Math.max(s.TranslatorDefaultVersion,Math.min(o,s.TranslatorLastVersion))},s.canUpgradeVersion=function(e){return e>=3&&e<s.TranslatorLastVersion},s.canDowngradeVersion=function(e){return e>=4&&e<=s.TranslatorLastVersion},e&&e.exports&&(e.exports=s)},120984:(e,t,i)=>{"use strict";i.d(t,{AsyncResourceWrapper:()=>s});class s{constructor(e,t){this._destroyed=!1,this._callbacks=[],this._resource={pendingResource:e},e.then((e=>{var t;if(this._destroyed)null===(t=this._destroyFn)||void 0===t||t.call(this,e);else{for(const t of this._callbacks)t(e);this._resource.resource=e}})).finally((()=>{this._callbacks=[]}))}destroy(){var e;this._resource.resource&&(null===(e=this._destroyFn)||void 0===e||e.call(this,this._resource.resource)),this._resource={pendingResource:Promise.reject("Resource is destroyed").catch((()=>{}))},this._callbacks=[],this._destroyed=!0}callFunction(e){this._destroyed||(this._resource.resource?e(this._resource.resource):this._callbacks.push(e))}get(){return this._destroyed||!this._resource.resource?null:this._resource.resource}promise(){return this._resource.pendingResource}}}}]);